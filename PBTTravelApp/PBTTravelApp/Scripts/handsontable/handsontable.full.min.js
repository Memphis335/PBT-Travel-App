var Handsontable={extension:{},plugins:{},helper:{}};(function(n,t,i){"use strict";function o(){this.refCounter=0;this.init()}function ui(){function f(){var n=this;n.registerTimeout("enableObserveChanges",function(){n.updateSettings({observeChanges:!0})},0)}function e(n){return function(t,i){return t[1]===i[1]?0:t[1]===null?1:i[1]===null?-1:t[1]<i[1]?n?-1:1:t[1]>i[1]?n?1:-1:0}}function o(n){return function(t,i){if(t[1]===i[1])return 0;if(t[1]===null)return 1;if(i[1]===null)return-1;var r=new Date(t[1]),u=new Date(i[1]);return r<u?n?-1:1:r>u?n?1:-1:0}}function i(n){return typeof n.sortColumn!="undefined"}var n=this;this.init=function(t){var i=this,o=i.getSettings().columnSorting,s,h,e;i.sortingEnabled=!!o;i.sortingEnabled?(i.sortIndex=[],e=r.call(i),typeof e!="undefined"?(s=e.sortColumn,h=e.sortOrder):(s=o.column,h=o.sortOrder),n.sortByColumn.call(i,s,h),i.sort=function(){var t=Array.prototype.slice.call(arguments);return n.sortByColumn.apply(i,t)},typeof i.getSettings().observeChanges=="undefined"&&f.call(i),t=="afterInit"&&(u.call(i),i.addHook("afterCreateRow",n.afterCreateRow),i.addHook("afterRemoveRow",n.afterRemoveRow),i.addHook("afterLoadData",n.init))):(delete i.sort,i.removeHook("afterCreateRow",n.afterCreateRow),i.removeHook("afterRemoveRow",n.afterRemoveRow),i.removeHook("afterLoadData",n.init))};this.setSortingColumn=function(n,t){var i=this;if(typeof n=="undefined"){delete i.sortColumn;delete i.sortOrder;return}i.sortOrder=i.sortColumn===n&&typeof t=="undefined"?!i.sortOrder:typeof t!="undefined"?t:!0;i.sortColumn=n};this.sortByColumn=function(i,r){var u=this;(n.setSortingColumn.call(u,i,r),typeof u.sortColumn!="undefined")&&(u.PluginHooks.run("beforeColumnSort",u.sortColumn,u.sortOrder),n.sort.call(u),u.render(),t.call(u),u.PluginHooks.run("afterColumnSort",u.sortColumn,u.sortOrder))};var t=function(){var n=this,t={};typeof n.sortColumn!="undefined"&&(t.sortColumn=n.sortColumn);typeof n.sortOrder!="undefined"&&(t.sortOrder=n.sortOrder);(t.hasOwnProperty("sortColumn")||t.hasOwnProperty("sortOrder"))&&n.PluginHooks.run("persistentStateSave","columnSorting",t)},r=function(){var t=this,n={};return t.PluginHooks.run("persistentStateLoad","columnSorting",n),n.value},u=function(){function i(){var n=t.view.TBODY.querySelector("tr").querySelectorAll("th");return n.length}function r(n){var r=t.view.wt.wtDom.closest(n,"TH");return t.view.wt.wtDom.index(r)-i()}var t=this;t.rootElement.on("click.handsontable",".columnSorting",function(i){if(t.view.wt.wtDom.hasClass(i.target,"columnSorting")){var u=r(i.target);n.sortByColumn.call(t,u)}})};this.sort=function(){var n=this,i,u,f,r,t;if(typeof n.sortOrder!="undefined"){for(n.sortingEnabled=!1,n.sortIndex.length=0,i=this.colOffset(),t=0,u=this.countRows()-n.getSettings().minSpareRows;t<u;t++)this.sortIndex.push([t,n.getDataAtCell(t,this.sortColumn+i)]);f=n.getCellMeta(0,n.sortColumn);switch(f.type){case"date":r=o;break;default:r=e}for(this.sortIndex.sort(r(n.sortOrder)),t=this.sortIndex.length;t<n.countRows();t++)this.sortIndex.push([t,n.getDataAtCell(t,this.sortColumn+i)]);n.sortingEnabled=!0}};this.translateRow=function(n){var t=this;return t.sortingEnabled&&t.sortIndex&&t.sortIndex.length&&t.sortIndex[n]?t.sortIndex[n][0]:n};this.onBeforeGetSet=function(t){var i=this;t.row=n.translateRow.call(i,t.row)};this.untranslateRow=function(n){var t=this,i;if(t.sortingEnabled&&t.sortIndex&&t.sortIndex.length)for(i=0;i<t.sortIndex.length;i++)if(t.sortIndex[i][0]==n)return i};this.getColHeader=function(n,t){this.getSettings().columnSorting&&this.view.wt.wtDom.addClass(t.querySelector(".colHeader"),"columnSorting")};this.afterCreateRow=function(n,r){var f=this,u;if(i(f)){for(u=0;u<f.sortIndex.length;u++)f.sortIndex[u][0]>=n&&(f.sortIndex[u][0]+=r);for(u=0;u<r;u++)f.sortIndex.splice(n+u,0,[n+u,f.getData()[n+u][f.sortColumn+f.colOffset()]]);t.call(f)}};this.afterRemoveRow=function(r,u){var f=this,o,e;if(i(f)){for(o=n.translateRow.call(f,r),f.sortIndex.splice(r,u),e=0;e<f.sortIndex.length;e++)f.sortIndex[e][0]>o&&(f.sortIndex[e][0]-=u);t.call(f)}};this.afterChangeSort=function(t){var i=this,f=!1,u={},r;if(t){for(r=0;r<t.length;r++)if(t[r][1]==i.sortColumn){f=!0;u.row=n.translateRow.call(i,t[r][0]);u.col=t[r][1];break}f&&setTimeout(function(){n.sort.call(i);i.render();i.selectCell(n.untranslateRow.call(i,u.row),u.col)},0)}}}function fi(){var u,r,i,o,f,e=document.createElement("DIV"),t=e.style;e.className="ghost";t.position="absolute";t.top="25px";t.left=0;t.width="10px";t.height="10px";t.backgroundColor="#CCC";t.opacity=.7;var h=function(){var n=this;n.PluginHooks.run("persistentStateSave","manualColumnPositions",n.manualColumnPositions)},c=function(){var t=this,n={};return t.PluginHooks.run("persistentStateLoad","manualColumnPositions",n),n.value},l=function(){var c=this;c.rootElement.on("mousemove.manualColumnMove",function(n){u&&(t.left=f+n.pageX-o+6+"px",t.display==="none"&&(t.display="block"))});c.rootElement.on("mouseup.manualColumnMove",function(){u&&(r<i&&i--,c.getSettings().rowHeaders&&(r--,i--),c.manualColumnPositions.splice(i,0,c.manualColumnPositions.splice(r,1)[0]),n(".manualColumnMover.active").removeClass("active"),u=!1,c.forceFullRender=!0,c.view.render(),t.display="none",h.call(c),c.PluginHooks.run("afterColumnMove",r,i))});c.rootElement.on("mousedown.manualColumnMove",".manualColumnMover",function(n){var l=n.currentTarget,h=c.view.wt.wtDom.closest(l,"TH"),s;r=c.view.wt.wtDom.index(h)+c.colOffset();i=r;u=!0;o=n.pageX;s=c.$table[0];s.parentNode.appendChild(e);t.width=c.view.wt.wtDom.outerWidth(h)+"px";t.height=c.view.wt.wtDom.outerHeight(s)+"px";f=parseInt(c.view.wt.wtDom.offset(h).left-c.view.wt.wtDom.offset(s).left,10);t.left=f+6+"px"});c.rootElement.on("mouseenter.manualColumnMove","td, th",function(){var n,t,r;u&&(n=c.view.THEAD.querySelector(".manualColumnMover.active"),n&&c.view.wt.wtDom.removeClass(n,"active"),i=c.view.wt.wtDom.index(this)+c.colOffset(),t=c.view.THEAD.querySelectorAll("th"),r=t[i].querySelector(".manualColumnMover"),c.view.wt.wtDom.addClass(r,"active"))});c.addHook("afterDestroy",s)},s=function(){var n=this;n.rootElement.off("mouseup.manualColumnMove");n.rootElement.off("mousemove.manualColumnMove");n.rootElement.off("mousedown.manualColumnMove");n.rootElement.off("mouseenter.manualColumnMove")};this.beforeInit=function(){this.manualColumnPositions=[]};this.init=function(n){var r=this,u=!!this.getSettings().manualColumnMove,t,i;u?(t=this.getSettings().manualColumnMove,i=c.call(r),this.manualColumnPositions=typeof i!="undefined"?i:t instanceof Array?t:[],r.forceFullRender=!0,n=="afterInit"&&(l.call(this),this.manualColumnPositions.length>0&&(this.forceFullRender=!0,this.render()))):(s.call(this),this.manualColumnPositions=[])};this.modifyCol=function(n){return this.getSettings().manualColumnMove?(typeof this.manualColumnPositions[n]=="undefined"&&(this.manualColumnPositions[n]=n),this.manualColumnPositions[n]):n};this.getColHeader=function(n,t){if(this.getSettings().manualColumnMove){var i=document.createElement("DIV");i.className="manualColumnMover";t.firstChild.appendChild(i)}}}function ei(){function b(n){var r,f,e;t=this;o=n;r=this.view.wt.wtTable.getCoords(n)[1];r>=0&&(u=r,f=this.view.wt.wtDom.offset(this.rootElement[0]).left,e=this.view.wt.wtDom.offset(n).left,h=e-f-6,i.style.left=h+parseInt(this.view.wt.wtDom.outerWidth(n),10)+"px",this.rootElement[0].appendChild(i))}function g(){var n=this;e=parseInt(this.view.wt.wtDom.outerWidth(o),10);n.view.wt.wtDom.addClass(i,"active");d.height=n.view.wt.wtDom.outerHeight(n.$table[0])+"px";f=n}var f,o,u,s,t,r,v,e,h,i=document.createElement("DIV"),y=document.createElement("DIV"),c=document.createElement("DIV"),d=c.style,l,p,w,k,a;i.className="manualColumnResizer";y.className="manualColumnResizerHandle";i.appendChild(y);c.className="manualColumnResizerLine";i.appendChild(c);l=n(document);l.mousemove(function(n){f&&(s=e+(n.pageX-v),r=a(u,s),i.style.left=h+s+"px")});l.mouseup(function(){f&&(t.view.wt.wtDom.removeClass(i,"active"),f=!1,r!=e&&(t.forceFullRender=!0,t.view.render(),p.call(t),t.PluginHooks.run("afterColumnResize",u,r)),b.call(t,o))});p=function(){var n=this;n.PluginHooks.run("persistentStateSave","manualColumnWidths",n.manualColumnWidths)};w=function(){var t=this,n={};return t.PluginHooks.run("persistentStateLoad","manualColumnWidths",n),n.value};k=function(){var n=this,t=0,i=null;this.rootElement.on("mouseenter.handsontable","th",function(t){f||b.call(n,t.currentTarget)});this.rootElement.on("mousedown.handsontable",".manualColumnResizer",function(){i==null&&(i=setTimeout(function(){t>=2&&(r=n.determineColumnWidth.call(n,u),a(u,r),n.forceFullRender=!0,n.view.render(),n.PluginHooks.run("afterColumnResize",u,r));t=0;i=null},500));t++});this.rootElement.on("mousedown.handsontable",".manualColumnResizer",function(t){v=t.pageX;g.call(n);r=e})};this.beforeInit=function(){this.manualColumnWidths=[]};this.init=function(n){var t=this,u=!!this.getSettings().manualColumnResize,i,r;u&&(i=this.getSettings().manualColumnResize,r=w.call(t),this.manualColumnWidths=typeof r!="undefined"?r:i instanceof Array?i:[],n=="afterInit"&&(k.call(this),t.forceFullRender=!0,t.render()))};a=function(n,i){return i=Math.max(i,20),n=t.PluginHooks.execute("modifyCol",n),t.manualColumnWidths[n]=i,i};this.getColWidth=function(n,t){this.getSettings().manualColumnResize&&this.manualColumnWidths[n]&&(t.width=this.manualColumnWidths[n])}}function oi(n){var i,r=function(){t.localStorage[n+"__persistentStateKeys"]=JSON.stringify(i)},u=function(){var r=t.localStorage[n+"__persistentStateKeys"],u=typeof r=="string"?JSON.parse(r):void 0;i=u?u:[]},f=function(){i=[];r()};u();this.saveValue=function(u,f){t.localStorage[n+"_"+u]=JSON.stringify(f);i.indexOf(u)==-1&&(i.push(u),r())};this.loadValue=function(i,r){i=typeof i!="undefined"?i:r;var u=t.localStorage[n+"_"+i];if(typeof u!="undefined")return JSON.parse(u)};this.reset=function(i){t.localStorage.removeItem(n+"_"+i)};this.resetAll=function(){for(var r=0;r<i.length;r++)t.localStorage.removeItem(n+"_"+i[r]);f()}}function ft(){this.boundaries=null;this.callback=null}function e(){this.maxOuts=10}function vt(t,i){var r,o,f,e,u;for(this.instance=t,this.settings=i,this.wtDom=this.instance.wtDom,this.main=document.createElement("div"),r=this.main.style,r.position="absolute",r.top=0,r.left=0,o=0;o<5;o++)f=document.createElement("DIV"),f.className="wtBorder "+(i.className||""),r=f.style,r.backgroundColor=i.border.color,r.height=i.border.width+"px",r.width=i.border.width+"px",this.main.appendChild(f);this.top=this.main.childNodes[0];this.left=this.main.childNodes[1];this.bottom=this.main.childNodes[2];this.right=this.main.childNodes[3];this.topStyle=this.top.style;this.leftStyle=this.left.style;this.bottomStyle=this.bottom.style;this.rightStyle=this.right.style;this.corner=this.main.childNodes[4];this.corner.className+=" corner";this.cornerStyle=this.corner.style;this.cornerStyle.width="5px";this.cornerStyle.height="5px";this.cornerStyle.border="2px solid #FFF";this.disappear();t.wtTable.bordersHolder||(t.wtTable.bordersHolder=document.createElement("div"),t.wtTable.bordersHolder.className="htBorders",t.wtTable.hider.appendChild(t.wtTable.bordersHolder));t.wtTable.bordersHolder.appendChild(this.main);e=!1;u=n(document.body);u.on("mousedown.walkontable."+t.guid,function(){e=!0});u.on("mouseup.walkontable."+t.guid,function(){e=!1});n(this.main.childNodes).on("mouseenter",function(i){var r,f,o;if(e&&t.getSetting("hideBorderOnMouseDownOver")){i.preventDefault();i.stopImmediatePropagation();r=this.getBoundingClientRect();f=n(this);f.hide();o=function(n){return n.clientY<Math.floor(r.top)?!0:n.clientY>Math.ceil(r.top+r.height)?!0:n.clientX<Math.floor(r.left)?!0:n.clientX>Math.ceil(r.left+r.width)?!0:void 0};u.on("mousemove.border."+t.guid,function(n){o(n)&&(u.off("mousemove.border."+t.guid),f.show())})}})}function y(){this.offset=0;this.total=0;this.fixedCount=0}function w(n){this.instance=n}function ot(){this.cache=[]}function k(){this.countTH=0}function yt(n,t,i,r){var u,f=0,e;for(w.apply(this,arguments),this.containerSizeFn=t,this.cellSizesSum=0,this.cellSizes=[],this.cellStretch=[],this.cellCount=0,this.remainingSize=0,this.strategy=r;;){if(u=i(f),u===void 0)break;if(this.cellSizesSum>=this.getContainerSize(this.cellSizesSum+u))break;this.cellSizes.push(u);this.cellSizesSum+=u;this.cellCount++;f++}e=this.getContainerSize(this.cellSizesSum);this.remainingSize=this.cellSizesSum-e}function l(n){var s=this,e=[],i,o,t,f;if(this.guid="wt_"+ii(),this.wtDom=new r,n.cloneSource?(this.cloneSource=n.cloneSource,this.cloneOverlay=n.cloneOverlay,this.wtSettings=n.cloneSource.wtSettings,this.wtTable=new u(this,n.table),this.wtScroll=new d(this),this.wtViewport=n.cloneSource.wtViewport):(this.wtSettings=new it(this,n),this.wtTable=new u(this,n.table),this.wtScroll=new d(this),this.wtViewport=new v(this),this.wtScrollbars=new pt(this),this.wtWheel=new si(this),this.wtEvent=new kt(this)),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(i=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;i<o;i++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[i].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(n,t){s.wtDom.fastInnerText(t,e[n])}])}if(this.selections={},t=this.getSetting("selections"),t)for(f in t)t.hasOwnProperty(f)&&(this.selections[f]=new ct(this,t[f]));this.drawn=!1;this.drawInterrupted=!1}function s(t){this.instance=t;this.init();this.clone=this.makeClone("debug");this.clone.wtTable.holder.style.opacity=.4;this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000";var e=this,o,u=0,f=0,i=e.clone.wtTable.holder.parentNode;n(document.body).on("mousemove."+this.instance.guid,function(n){e.instance.wtTable.holder.parentNode&&(n.clientX-u>-5&&n.clientX-u<5&&n.clientY-f>-5&&n.clientY-f<5||(u=n.clientX,f=n.clientY,r.prototype.addClass(i,"wtDebugHidden"),r.prototype.removeClass(i,"wtDebugVisible"),clearTimeout(o),o=setTimeout(function(){r.prototype.removeClass(i,"wtDebugHidden");r.prototype.addClass(i,"wtDebugVisible")},1e3)))})}function r(){}function kt(t){var i=this;this.instance=t;this.wtDom=this.instance.wtDom;var r=[null,null],u=[null,null],e=function(n){var t=i.parentCell(n.target);i.wtDom.hasClass(n.target,"corner")?i.instance.getSetting("onCellCornerMouseDown",n,n.target):t.TD&&t.TD.nodeName==="TD"&&i.instance.hasSetting("onCellMouseDown")&&i.instance.getSetting("onCellMouseDown",n,t.coords,t.TD);n.button!==2&&t.TD&&t.TD.nodeName==="TD"&&(r[0]=t.TD,clearTimeout(u[0]),u[0]=setTimeout(function(){r[0]=null},1e3))},f,o=function(n){if(i.instance.hasSetting("onCellMouseOver")){var r=i.instance.wtTable.TABLE,t=i.wtDom.closest(n.target,["TD","TH"],r);t&&t!==f&&i.wtDom.isChildOf(t,r)&&(f=t,t.nodeName==="TD"&&i.instance.getSetting("onCellMouseOver",n,i.instance.wtTable.getCoords(t),t))}},s=function(n){if(n.button!==2){var t=i.parentCell(n.target);t.TD===r[0]&&t.TD===r[1]?(i.wtDom.hasClass(n.target,"corner")?i.instance.getSetting("onCellCornerDblClick",n,t.coords,t.TD):t.TD&&i.instance.getSetting("onCellDblClick",n,t.coords,t.TD),r[0]=null,r[1]=null):t.TD===r[0]&&(r[1]=t.TD,clearTimeout(u[1]),u[1]=setTimeout(function(){r[1]=null},500))}};n(this.instance.wtTable.holder).on("mousedown",e);n(this.instance.wtTable.TABLE).on("mouseover",o);n(this.instance.wtTable.holder).on("mouseup",s)}function ii(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+n()+n()}function dt(){}function st(n,t,i){w.apply(this,arguments);this.containerSizeFn=t;this.sizeAtIndex=i;this.cellSizesSum=0;this.cellSizes=[];this.cellCount=0;this.remainingSize=-Infinity}function d(n){this.instance=n}function b(){}function h(n){this.instance=n;this.init();this.clone=this.makeClone("corner")}function f(n){this.instance=n;this.type="horizontal";this.cellSize=50;this.init();this.clone=this.makeClone("left")}function c(n){this.instance=n;this.type="vertical";this.cellSize=23;this.init();this.clone=this.makeClone("top")}function pt(n){this.instance=n;n.getSetting("nativeScrollbars")?(n.update("scrollbarWidth",n.wtDom.getScrollbarWidth()),n.update("scrollbarHeight",n.wtDom.getScrollbarWidth()),this.vertical=new c(n),this.horizontal=new f(n),this.corner=new h(n),n.getSetting("debug")&&(this.debug=new s(n)),this.registerListeners()):(this.vertical=new ht(n),this.horizontal=new tt(n))}function ct(n,t){this.instance=n;this.settings=t;this.selected=[];t.border&&(this.border=new vt(n,t))}function it(n,t){var r=this,i;this.instance=n;this.defaults={table:void 0,debug:!1,scrollH:"auto",scrollV:"auto",nativeScrollbars:!1,stretchH:"hybrid",currentRowClassName:null,currentColumnClassName:null,data:void 0,offsetRow:0,offsetColumn:0,fixedColumnsLeft:0,fixedRowsTop:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,width:null,height:null,cellRenderer:function(n,t,i){var u=r.getSetting("data",n,t);r.instance.wtDom.fastInnerText(i,u===void 0||u===null?"":u)},columnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onScrollVertically:null,onScrollHorizontally:null,scrollbarWidth:10,scrollbarHeight:10};this.settings={};for(i in this.defaults)if(this.defaults.hasOwnProperty(i))if(t[i]!==void 0)this.settings[i]=t[i];else if(this.defaults[i]===void 0)throw new Error('A required setting "'+i+'" was not provided');else this.settings[i]=this.defaults[i]}function u(n,t){var i,u,f,r,e;this.instance=n;this.TABLE=t;this.wtDom=this.instance.wtDom;this.wtDom.removeTextNodes(this.TABLE);i=this.TABLE.parentNode;i&&i.nodeType===1&&this.wtDom.hasClass(i,"wtHolder")||(u=document.createElement("DIV"),u.className="wtSpreader",i&&i.insertBefore(u,this.TABLE),u.appendChild(this.TABLE));this.spreader=this.TABLE.parentNode;i=this.spreader.parentNode;i&&i.nodeType===1&&this.wtDom.hasClass(i,"wtHolder")||(f=document.createElement("DIV"),f.className="wtHider",i&&i.insertBefore(f,this.spreader),f.appendChild(this.spreader));this.hider=this.spreader.parentNode;this.hiderStyle=this.hider.style;this.hiderStyle.position="relative";i=this.hider.parentNode;i&&i.nodeType===1&&this.wtDom.hasClass(i,"wtHolder")||(r=document.createElement("DIV"),r.style.position="relative",r.className="wtHolder",i&&i.insertBefore(r,this.hider),r.appendChild(this.hider));this.holder=this.hider.parentNode;this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0];this.TBODY||(this.TBODY=document.createElement("TBODY"),this.TABLE.appendChild(this.TBODY));this.THEAD=this.TABLE.getElementsByTagName("THEAD")[0];this.THEAD||(this.THEAD=document.createElement("THEAD"),this.TABLE.insertBefore(this.THEAD,this.TBODY));this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0];this.COLGROUP||(this.COLGROUP=document.createElement("COLGROUP"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD));this.instance.getSetting("columnHeaders").length&&(this.THEAD.childNodes.length||(e=document.createElement("TR"),this.THEAD.appendChild(e)));this.colgroupChildrenLength=this.COLGROUP.childNodes.length;this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0;this.tbodyChildrenLength=this.TBODY.childNodes.length;this.oldCellCache=new ot;this.currentCellCache=new ot;this.rowFilter=new dt;this.columnFilter=new k;this.verticalRenderReverse=!1}function v(i){if(this.instance=i,this.resetSettings(),this.instance.getSetting("nativeScrollbars")){var r=this;n(t).on("resize",function(){r.clientHeight=r.getWorkspaceHeight()})}}function si(t){if(!t.getSetting("nativeScrollbars"))n(t.wtTable.spreader).on("mousewheel",function(n,i,r,u){(r||u||!i||(u=i),r||u)&&(u>0&&t.getSetting("offsetRow")===0||u<0&&t.wtTable.isLastRowFullyVisible()||r<0&&t.getSetting("offsetColumn")===0||r>0&&t.wtTable.isLastColumnFullyVisible()||(clearTimeout(t.wheelTimeout),t.wheelTimeout=setTimeout(function(){u?t.wtScrollbars.vertical.visible&&t.scrollVertical(-Math.ceil(u)).draw():r&&t.wtScrollbars.horizontal.visible&&t.scrollHorizontal(Math.ceil(r)).draw()},0),n.preventDefault()))})}var lt,wt,ti,p,g,nt,ut,at,et,bt,ri,ht,tt,gt,a,rt,ni;Array.prototype.indexOf||(Array.prototype.indexOf=function(n){var i=this.length>>>0,t=Number(arguments[1])||0;for(t=t<0?Math.ceil(t):Math.floor(t),t<0&&(t+=i);t<i;t++)if(t in this&&this[t]===n)return t;return-1});Array.prototype.filter||(Array.prototype.filter=function(n,t){function e(n){return/NodeList/i.test(n.item)}function o(n){for(var i=[],t=0,r=n.length;t<r;t++)i[t]=n[t];return i}if(typeof this=="undefined"||this===null)throw new TypeError;if(typeof n!="function")throw new TypeError;t=t||this;e(t)&&(t=o(t));for(var f=t.length,u=[],r,i=0;i<f;i+=1)t.hasOwnProperty(i)&&(r=t[i],n.call(t,r,i,t)&&u.push(r));return u});typeof WeakMap=="undefined"&&function(){var r=Object.defineProperty,n,u,i;try{n=!0;r(function(){},"foo",{})}catch(f){n=!1}u=+new Date%1e9;i=function(){this.name="__st"+(Math.random()*1e9>>>0)+(u+++"__");n||(this._wmCache=[])};i.prototype=n?{set:function(n,t){var i=n[this.name];i&&i[0]===n?i[1]=t:r(n,this.name,{value:[n,t],writable:!0})},get:function(n){var t;return(t=n[this.name])&&t[0]===n?t[1]:undefined},"delete":function(n){this.set(n,undefined)}}:{set:function(n,t){if(typeof n!="undefined"&&typeof t!="undefined"){for(var i=0,r=this._wmCache.length;i<r;i++)if(this._wmCache[i].key==n){this._wmCache[i].value=t;return}this._wmCache.push({key:n,value:t})}},get:function(n){if(typeof n!="undefined"){for(var t=0,i=this._wmCache.length;t<i;t++)if(this._wmCache[t].key==n)return this._wmCache[t].value;return}},"delete":function(n){if(typeof n!="undefined")for(var t=0,i=this._wmCache.length;t<i;t++)this._wmCache[t].key==n&&Array.prototype.slice.call(this._wmCache,t,1)}};t.WeakMap=i}();i.activeGuid=null;i.Core=function(r,u){function w(){var n=!1;return{validatorsInQueue:0,addValidatorToQueue:function(){this.validatorsInQueue++;n=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1;this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue==0&&n==!1&&(n=!0,this.onQueueEmpty())}}}function b(t,i,r){function a(){var u;t.length&&(u=f.PluginHooks.execute("beforeChange",t,i),typeof u=="function"?n.when(result).then(function(){r()}):u===!1&&t.splice(0,t.length));typeof u!="function"&&r()}var e=new w,u;for(e.onQueueEmpty=a,u=t.length-1;u>=0;u--)if(t[u]===null)t.splice(u,1);else{var h=t[u][0],c=o.propToCol(t[u][1]),l=f.runHooksAndReturn("modifyCol",c),s=f.getCellMeta(h,l);s.type==="numeric"&&typeof t[u][3]=="string"&&t[u][3].length>0&&/^-?[\d\s]*\.?\d*$/.test(t[u][3])&&(t[u][3]=numeral().unformat(t[u][3]||"0"));f.getCellValidator(s)&&(e.addValidatorToQueue(),f.validateCell(t[u][3],s,function(n,i){return function(r){if(typeof r!="boolean")throw new Error("Validation error: result is not boolean");r===!1&&i.allowInvalid===!1&&(t.splice(n,1),i.valid=!0,--n);e.removeValidatorFormQueue()}}(u,s),i))}e.checkIfQueueIsEmpty()}function k(n,t){var i=n.length-1;if(!(i<0)){for(;0<=i;i--){if(n[i]===null){n.splice(i,1);continue}if(e.settings.minSpareRows)while(n[i][0]>f.countRows()-1)o.createRow();if(f.dataType==="array"&&e.settings.minSpareCols)while(o.propToCol(n[i][1])>f.countCols()-1)o.createCol();o.set(n[i][0],n[i][1],n[i][3])}f.forceFullRender=!0;c.adjustRowsAndCols();s.refreshBorders(null,!0);f.PluginHooks.run("afterChange",n,t||"edit")}}function d(t,i,r){return typeof t=="object"?t:n.isPlainObject(r)?r:[[t,i,r]]}function v(n){var t,u,r;if(n.hasOwnProperty("type")){if(u={},typeof n.type=="object")t=n.type;else if(typeof n.type=="string"&&(t=i.cellTypes[n.type],t===void 0))throw new Error('You declared cell type "'+n.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');for(r in t)t.hasOwnProperty(r)&&!n.hasOwnProperty(r)&&(u[r]=t[r]);return u}}var e,o,c,s,a,l,f=this,h=function(){},y,p,g;i.helper.extend(h.prototype,lt.prototype);i.helper.extend(h.prototype,u);i.helper.extend(h.prototype,v(u));this.rootElement=r;y=n(document.documentElement);p=n(document.body);this.guid="ht_"+i.helper.randomString();this.rootElement[0].id||(this.rootElement[0].id=this.guid);e={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new h,settingsFromDOM:{},selStart:new i.SelectionPoint,selEnd:new i.SelectionPoint,isPopulated:null,scrollable:null,extensions:{},firstRun:!0};c={alter:function(n,t,r,u,h){var l,v,a,y;r=r||1;switch(n){case"insert_row":l=o.createRow(t,r);l&&(e.selStart.exists()&&e.selStart.row()>=t?(e.selStart.row(e.selStart.row()+l),s.transformEnd(l,0)):s.refreshBorders());break;case"insert_col":l=o.createCol(t,r);l&&(i.helper.isArray(f.getSettings().colHeaders)&&(v=[t,0],v.length+=l,Array.prototype.splice.apply(f.getSettings().colHeaders,v)),e.selStart.exists()&&e.selStart.col()>=t?(e.selStart.col(e.selStart.col()+l),s.transformEnd(0,l)):s.refreshBorders());break;case"remove_row":o.removeRow(t,r);e.cellSettings.splice(t,r);c.adjustRowsAndCols();s.refreshBorders();break;case"remove_col":for(o.removeCol(t,r),a=0,y=o.getAll().length;a<y;a++)a in e.cellSettings&&e.cellSettings[a].splice(t,r);i.helper.isArray(f.getSettings().colHeaders)&&(typeof t=="undefined"&&(t=-1),f.getSettings().colHeaders.splice(t,r));e.columnSettings.splice(t,r);c.adjustRowsAndCols();s.refreshBorders();break;default:throw new Error('There is no such action "'+n+'"');}h||c.adjustRowsAndCols()},adjustRowsAndCols:function(){var v,y,l=f.countEmptyRows(!0),n,h,c;if(y=f.countRows(),y<e.settings.minRows)for(v=0;v<e.settings.minRows-y;v++)o.createRow(f.countRows(),1,!0);if(l<e.settings.minSpareRows)for(;l<e.settings.minSpareRows&&f.countRows()<e.settings.maxRows;l++)o.createRow(f.countRows(),1,!0);if(n=f.countEmptyCols(!0),!e.settings.columns&&f.countCols()<e.settings.minCols)for(;f.countCols()<e.settings.minCols;n++)o.createCol(f.countCols(),1,!0);if(!e.settings.columns&&f.dataType==="array"&&n<e.settings.minSpareCols)for(;n<e.settings.minSpareCols&&f.countCols()<e.settings.maxCols;n++)o.createCol(f.countCols(),1,!0);if(e.settings.enterBeginsEditing)for(;(e.settings.minRows||e.settings.minSpareRows)&&f.countRows()>e.settings.minRows&&e.settings.minSpareRows&&l>e.settings.minSpareRows;l--)o.removeRow();if(e.settings.enterBeginsEditing&&!e.settings.columns)for(;(e.settings.minCols||e.settings.minSpareCols)&&f.countCols()>e.settings.minCols&&e.settings.minSpareCols&&n>e.settings.minSpareCols;n--)o.removeCol();if(h=f.countRows(),c=f.countCols(),(h===0||c===0)&&s.deselect(),e.selStart.exists()){var a,t=e.selStart.row(),i=e.selStart.col(),r=e.selEnd.row(),u=e.selEnd.col();t>h-1?(t=h-1,a=!0,r>t&&(r=t)):r>h-1&&(r=h-1,a=!0,t>r&&(t=r));i>c-1?(i=c-1,a=!0,u>i&&(u=i)):u>c-1&&(u=c-1,a=!0,i>u&&(i=u));a&&f.selectCell(t,i,r,u)}},populateFromArray:function(n,t,r,u,o){var s,l,h,a,p=[],c={},v,y,w,b;if(l=t.length,l===0)return!1;switch(o){case"shift_down":for(v=r?r.col-n.col+1:0,y=r?r.row-n.row+1:0,t=i.helper.translateRowsToColumns(t),h=0,a=t.length,w=Math.max(a,v);h<w;h++)if(h<a){for(s=0,l=t[h].length;s<y-l;s++)t[h].push(t[h][s%l]);t[h].unshift(n.col+h,n.row,0);f.spliceCol.apply(f,t[h])}else t[h%a][0]=n.col+h,f.spliceCol.apply(f,t[h%a]);break;case"shift_right":for(v=r?r.col-n.col+1:0,y=r?r.row-n.row+1:0,s=0,l=t.length,b=Math.max(l,y);s<b;s++)if(s<l){for(h=0,a=t[s].length;h<v-a;h++)t[s].push(t[s][h%a]);t[s].unshift(n.row+s,n.col,0);f.spliceRow.apply(f,t[s])}else t[s%l][0]=n.row+s,f.spliceRow.apply(f,t[s%l]);break;case"overwrite":default:for(c.row=n.row,c.col=n.col,s=0;s<l;s++){if(r&&c.row>r.row||!e.settings.minSpareRows&&c.row>f.countRows()-1||c.row>=e.settings.maxRows)break;for(c.col=n.col,a=t[s]?t[s].length:0,h=0;h<a;h++){if(r&&c.col>r.col||!e.settings.minSpareCols&&c.col>f.countCols()-1||c.col>=e.settings.maxCols)break;f.getCellMeta(c.row,c.col).readOnly||p.push([c.row,c.col,t[s][h]]);c.col++;r&&h===a-1&&(h=-1)}c.row++;r&&s===l-1&&(s=-1)}f.setDataAtCell(p,null,null,u||"populateFromArray")}},getCornerCoords:function(t){function i(t,i,r){function u(n){return n[r]}return Array.prototype.map?t.apply(Math,i.map(u)):t.apply(Math,n.map(i,u))}return{TL:{row:i(Math.min,t,"row"),col:i(Math.min,t,"col")},BR:{row:i(Math.max,t,"row"),col:i(Math.max,t,"col")}}},getCellsAtCoords:function(n,t){for(var i=c.getCornerCoords([n,t]),u,e=[],r=i.TL.row;r<=i.BR.row;r++)for(u=i.TL.col;u<=i.BR.col;u++)e.push(f.view.getCellAtCoords({row:r,col:u}));return e}};this.selection=s={inProgress:!1,begin:function(){f.selection.inProgress=!0},finish:function(){var n=f.getSelected();f.PluginHooks.run("afterSelectionEnd",n[0],n[1],n[2],n[3]);f.PluginHooks.run("afterSelectionEndByProp",n[0],f.colToProp(n[1]),n[2],f.colToProp(n[3]));f.selection.inProgress=!1},isInProgress:function(){return f.selection.inProgress},setRangeStart:function(n){e.selStart.coords(n);s.setRangeEnd(n)},setRangeEnd:function(n,t){f.selection.begin();e.selEnd.coords(n);e.settings.multiSelect||e.selStart.coords(n);f.view.wt.selections.current.clear();f.view.wt.selections.current.add(e.selStart.arr());f.view.wt.selections.area.clear();s.isMultiple()&&(f.view.wt.selections.area.add(e.selStart.arr()),f.view.wt.selections.area.add(e.selEnd.arr()));(e.settings.currentRowClassName||e.settings.currentColClassName)&&(f.view.wt.selections.highlight.clear(),f.view.wt.selections.highlight.add(e.selStart.arr()),f.view.wt.selections.highlight.add(e.selEnd.arr()));f.PluginHooks.run("afterSelection",e.selStart.row(),e.selStart.col(),e.selEnd.row(),e.selEnd.col());f.PluginHooks.run("afterSelectionByProp",e.selStart.row(),o.colToProp(e.selStart.col()),e.selEnd.row(),o.colToProp(e.selEnd.col()));t!==!1&&f.view.scrollViewport(n);s.refreshBorders()},refreshBorders:function(n,t){t||a.destroyEditor(n);f.view.render();s.isSelected()&&!t&&a.prepareEditor()},isMultiple:function(){return!(e.selEnd.col()===e.selStart.col()&&e.selEnd.row()===e.selStart.row())},transformStart:function(n,t,i){e.selStart.row()+n>f.countRows()-1?i&&e.settings.minSpareRows>0?f.alter("insert_row",f.countRows()):e.settings.autoWrapCol&&(n=1-f.countRows(),t=e.selStart.col()+t==f.countCols()-1?1-f.countCols():1):e.settings.autoWrapCol&&e.selStart.row()+n<0&&e.selStart.col()+t>=0&&(n=f.countRows()-1,t=e.selStart.col()+t==0?f.countCols()-1:-1);e.selStart.col()+t>f.countCols()-1?i&&e.settings.minSpareCols>0?f.alter("insert_col",f.countCols()):e.settings.autoWrapRow&&(n=e.selStart.row()+n==f.countRows()-1?1-f.countRows():1,t=1-f.countCols()):e.settings.autoWrapRow&&e.selStart.col()+t<0&&e.selStart.row()+n>=0&&(n=e.selStart.row()+n==0?f.countRows()-1:-1,t=f.countCols()-1);var u=f.countRows(),o=f.countCols(),r={row:e.selStart.row()+n,col:e.selStart.col()+t};r.row<0?r.row=0:r.row>0&&r.row>=u&&(r.row=u-1);r.col<0?r.col=0:r.col>0&&r.col>=o&&(r.col=o-1);s.setRangeStart(r)},transformEnd:function(n,t){if(e.selEnd.exists()){var r=f.countRows(),u=f.countCols(),i={row:e.selEnd.row()+n,col:e.selEnd.col()+t};i.row<0?i.row=0:i.row>0&&i.row>=r&&(i.row=r-1);i.col<0?i.col=0:i.col>0&&i.col>=u&&(i.col=u-1);s.setRangeEnd(i)}},isSelected:function(){return e.selEnd.exists()},inInSelection:function(n){if(!s.isSelected())return!1;var t=c.getCornerCoords([e.selStart.coords(),e.selEnd.coords()]);return t.TL.row<=n.row&&t.BR.row>=n.row&&t.TL.col<=n.col&&t.BR.col>=n.col},deselect:function(){s.isSelected()&&(f.selection.inProgress=!1,e.selEnd=new i.SelectionPoint,f.view.wt.selections.current.clear(),f.view.wt.selections.area.clear(),a.destroyEditor(),s.refreshBorders(),f.PluginHooks.run("afterDeselect"))},selectAll:function(){e.settings.multiSelect&&(s.setRangeStart({row:0,col:0}),s.setRangeEnd({row:f.countRows()-1,col:f.countCols()-1},!1))},empty:function(){if(s.isSelected()){for(var i=c.getCornerCoords([e.selStart.coords(),e.selEnd.coords()]),t,r=[],n=i.TL.row;n<=i.BR.row;n++)for(t=i.TL.col;t<=i.BR.col;t++)f.getCellMeta(n,t).readOnly||r.push([n,t,""]);f.setDataAtCell(r)}}};this.autofill=l={handle:null,init:function(){l.handle?l.handle.disabled=!1:l.handle={}},disable:function(){l.handle.disabled=!0},selectAdjacent:function(){var n,i,t,u,r;n=s.isMultiple()?f.view.wt.selections.area.getCorners():f.view.wt.selections.current.getCorners();i=o.getAll();n:for(t=n[2]+1;t<f.countRows();t++){for(r=n[1];r<=n[3];r++)if(i[t][r])break n;!i[t][n[1]-1]&&!i[t][n[3]+1]||(u=t)}u&&(f.view.wt.selections.fill.clear(),f.view.wt.selections.fill.add([n[0],n[1]]),f.view.wt.selections.fill.add([u,n[3]]),l.apply())},apply:function(){var n,t,i,r,u;(l.handle.isDragged=0,n=f.view.wt.selections.fill.getCorners(),n)&&(f.view.wt.selections.fill.clear(),t=s.isMultiple()?f.view.wt.selections.area.getCorners():f.view.wt.selections.current.getCorners(),n[0]===t[0]&&n[1]<t[1]?(i={row:n[0],col:n[1]},r={row:n[2],col:t[1]-1}):n[0]===t[0]&&n[3]>t[3]?(i={row:n[0],col:t[3]+1},r={row:n[2],col:n[3]}):n[0]<t[0]&&n[1]===t[1]?(i={row:n[0],col:n[1]},r={row:t[0]-1,col:n[3]}):n[2]>t[2]&&n[1]===t[1]&&(i={row:t[2]+1,col:n[1]},r={row:n[2],col:n[3]}),i&&(u=SheetClip.parse(o.getText(e.selStart.coords(),e.selEnd.coords())),f.PluginHooks.run("beforeAutofill",i,r,u),c.populateFromArray(i,u,r,"autofill"),s.setRangeStart({row:n[0],col:n[1]}),s.setRangeEnd({row:n[2],col:n[3]})))},showBorder:function(n){n.row=n[0];n.col=n[1];var t=c.getCornerCoords([e.selStart.coords(),e.selEnd.coords()]);if(e.settings.fillHandle!=="horizontal"&&(t.BR.row<n.row||t.TL.row>n.row))n=[n.row,t.BR.col];else if(e.settings.fillHandle!=="vertical")n=[t.BR.row,n.col];else return;f.view.wt.selections.fill.clear();f.view.wt.selections.fill.add([e.selStart.coords().row,e.selStart.coords().col]);f.view.wt.selections.fill.add([e.selEnd.coords().row,e.selEnd.coords().col]);f.view.wt.selections.fill.add(n);f.view.render()}};this.init=function(){f.PluginHooks.run("beforeInit");this.view=new i.TableView(this);a=new i.EditorManager(f,e,s,o);this.updateSettings(e.settings,!0);this.parseSettingsFromDOM();this.forceFullRender=!0;this.view.render();typeof e.firstRun=="object"&&(f.PluginHooks.run("afterChange",e.firstRun[0],e.firstRun[1]),e.firstRun=!1);f.PluginHooks.run("afterInit")};this.validateCell=function(n,t,i,r){var u=f.getCellValidator(t);Object.prototype.toString.call(u)==="[object RegExp]"&&(u=function(n){return function(t,i){i(n.test(t))}}(u));typeof u=="function"?(n=f.PluginHooks.execute("beforeValidate",n,t.row,t.prop,r),setTimeout(function(){u.call(t,n,function(u){t.valid=u;u=f.PluginHooks.execute("afterValidate",u,n,t.row,t.prop,r);i(u)})})):(t.valid=!0,i(!0))};this.setDataAtCell=function(n,t,i,r){for(var f=d(n,t,i),e=[],s,u=0,h=f.length;u<h;u++){if(typeof f[u]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof f[u][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");s=o.colToProp(f[u][1]);e.push([f[u][0],s,o.get(f[u][0],s),f[u][2]])}r||typeof n!="object"||(r=t);b(e,r,function(){k(e,r)})};this.setDataAtRowProp=function(n,t,i,r){for(var f=d(n,t,i),e=[],u=0,s=f.length;u<s;u++)e.push([f[u][0],f[u][1],o.get(f[u][0],f[u][1]),f[u][2]]);r||typeof n!="object"||(r=t);b(e,r,function(){k(e,r)})};this.listen=function(){i.activeGuid=f.guid;document.activeElement&&document.activeElement!==document.body?document.activeElement.blur():document.activeElement||document.body.focus()};this.unlisten=function(){i.activeGuid=null};this.isListening=function(){return i.activeGuid===f.guid};this.destroyEditor=function(n){s.refreshBorders(n)};this.populateFromArray=function(n,t,i,r,u,f,e){if(!(typeof i=="object"&&typeof i[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");return c.populateFromArray({row:n,col:t},i,typeof r=="number"?{row:r,col:u}:null,f,e)};this.spliceCol=function(){return o.spliceCol.apply(o,arguments)};this.spliceRow=function(){return o.spliceRow.apply(o,arguments)};this.getCornerCoords=function(n){return c.getCornerCoords(n)};this.getSelected=function(){if(s.isSelected())return[e.selStart.row(),e.selStart.col(),e.selEnd.row(),e.selEnd.col()]};this.parseSettingsFromDOM=function(){var u=this.rootElement.css("overflow"),n,i;if(u==="scroll"||u==="auto"?(this.rootElement[0].style.overflow="visible",e.settingsFromDOM.overflow=u):(e.settings.width===void 0||e.settings.height===void 0)&&(e.settingsFromDOM.overflow="auto"),e.settingsFromDOM.width=e.settings.width===void 0?this.rootElement.width():void 0,e.settingsFromDOM.height=void 0,e.settings.height===void 0&&(e.settingsFromDOM.overflow==="scroll"||e.settingsFromDOM.overflow==="auto")&&(n=this.rootElement[0].cloneNode(!1),i=this.rootElement[0].parentNode,i)){n.removeAttribute("id");i.appendChild(n);var f=parseInt(n.clientHeight,10),o=parseInt(t.getComputedStyle(n,null).getPropertyValue("paddingTop"),10)||0,s=parseInt(t.getComputedStyle(n,null).getPropertyValue("paddingBottom"),10)||0,r=f-o-s;isNaN(r)&&n.currentStyle&&(r=parseInt(n.currentStyle.height,10));r>0&&(e.settingsFromDOM.height=r);i.removeChild(n)}};this.render=function(){f.view&&(f.forceFullRender=!0,f.parseSettingsFromDOM(),s.refreshBorders(null,!0))};this.loadData=function(n){function a(){e.cellSettings.length=0}var t,r,s,u,l;if(typeof n=="object"&&n!==null)n.push&&n.splice||(n=[n]);else if(n===null)for(n=[],r=0,s=e.settings.startRows;r<s;r++){for(t=[],u=0,l=e.settings.startCols;u<l;u++)t.push(null);n.push(t)}else throw new Error("loadData only accepts array of objects or array of arrays ("+typeof n+" given)");e.isPopulated=!1;h.prototype.data=n;f.dataType=e.settings.dataSchema instanceof Array||n[0]instanceof Array?"array":typeof e.settings.dataSchema=="function"?"function":"object";o=new i.DataMap(f,e,h);a();c.adjustRowsAndCols();f.PluginHooks.run("afterLoadData");e.firstRun?e.firstRun=[null,"loadData"]:(f.PluginHooks.run("afterChange",null,"loadData"),f.render());e.isPopulated=!0};this.getData=function(n,t,i,r){return typeof n=="undefined"?o.getAll():o.getRange({row:n,col:t},{row:i,col:r},o.DESTINATION_RENDERER)};this.getCopyableData=function(n,t,i,r){return o.getCopyableText({row:n,col:t},{row:i,col:r})};this.updateSettings=function(n,t){var r,u,a,y;if(typeof n.rows!="undefined")throw new Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?");if(typeof n.cols!="undefined")throw new Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?");for(r in n)if(r==="data")continue;else f.PluginHooks.hooks[r]!==void 0||f.PluginHooks.legacy[r]!==void 0?(typeof n[r]=="function"||i.helper.isArray(n[r]))&&f.PluginHooks.add(r,n[r]):(!t&&n.hasOwnProperty(r)&&(h.prototype[r]=n[r]),i.extension[r]&&(e.extensions[r]=new i.extension[r](f,n[r])));if(n.data===void 0&&e.settings.data===void 0?f.loadData(null):n.data!==void 0?f.loadData(n.data):n.columns!==void 0&&o.createMap(),u=f.countCols(),e.cellSettings.length=0,u>0)for(r=0;r<u;r++)e.columnSettings[r]=i.helper.columnFactory(h,e.columnsSettingConflicts),a=e.columnSettings[r].prototype,h.prototype.columns&&(y=h.prototype.columns[r],i.helper.extend(a,y),i.helper.extend(a,v(y)));typeof n.fillHandle!="undefined"&&(l.handle&&n.fillHandle===!1?l.disable():l.handle||n.fillHandle===!1||l.init());typeof n.className!="undefined"&&(h.prototype.className&&f.rootElement.removeClass(h.prototype.className),n.className&&f.rootElement.addClass(n.className));t||f.PluginHooks.run("afterUpdateSettings");c.adjustRowsAndCols();f.view&&!e.firstRun&&(f.forceFullRender=!0,s.refreshBorders(null,!0))};this.getValue=function(){var n=f.getSelected();if(h.prototype.getValue){if(typeof h.prototype.getValue=="function")return h.prototype.getValue.call(f);if(n)return f.getData()[n[0]][h.prototype.getValue]}else if(n)return f.getDataAtCell(n[0],n[1])};this.getSettings=function(){return e.settings};this.getSettingsFromDOM=function(){return e.settingsFromDOM};this.clear=function(){s.selectAll();s.empty()};this.alter=function(n,t,i,r,u){c.alter(n,t,i,r,u)};this.getCell=function(n,t){return f.view.getCellAtCoords({row:n,col:t})};this.colToProp=function(n){return o.colToProp(n)};this.propToCol=function(n){return o.propToCol(n)};this.getDataAtCell=function(n,t){return o.get(n,o.colToProp(t))};this.getDataAtRowProp=function(n,t){return o.get(n,t)};this.getDataAtCol=function(n){return[].concat.apply([],o.getRange({row:0,col:n},{row:e.settings.data.length-1,col:n},o.DESTINATION_RENDERER))};this.getDataAtProp=function(n){return[].concat.apply([],o.getRange({row:0,col:o.propToCol(n)},{row:e.settings.data.length-1,col:o.propToCol(n)},o.DESTINATION_RENDERER))};this.getDataAtRow=function(n){return e.settings.data[n]};this.getCellMeta=function(n,t){function c(n){var t={row:n};return f.PluginHooks.execute("beforeGet",t),t.row}function l(n){return i.PluginHooks.execute(f,"modifyCol",n)}var s=o.colToProp(t),r,u;return n=c(n),t=l(t),"undefined"==typeof e.columnSettings[t]&&(e.columnSettings[t]=i.helper.columnFactory(h,e.columnsSettingConflicts)),e.cellSettings[n]||(e.cellSettings[n]=[]),e.cellSettings[n][t]||(e.cellSettings[n][t]=new e.columnSettings[t]),r=e.cellSettings[n][t],r.row=n,r.col=t,r.prop=s,r.instance=f,f.PluginHooks.run("beforeGetCellMeta",n,t,r),i.helper.extend(r,v(r)),r.cells&&(u=r.cells.call(r,n,t,s),u&&(i.helper.extend(r,u),i.helper.extend(r,v(u)))),f.PluginHooks.run("afterGetCellMeta",n,t,r),r};g=i.helper.cellMethodLookupFactory("renderer");this.getCellRenderer=function(n,t){var r=g.call(this,n,t);return i.renderers.getRenderer(r)};this.getCellEditor=i.helper.cellMethodLookupFactory("editor");this.getCellValidator=i.helper.cellMethodLookupFactory("validator");this.validateCells=function(n){var r=new w,t,i;for(r.onQueueEmpty=n,t=f.countRows()-1;t>=0;){for(i=f.countCols()-1;i>=0;)r.addValidatorToQueue(),f.validateCell(f.getDataAtCell(t,i),f.getCellMeta(t,i),function(){r.removeValidatorFormQueue()},"validateCells"),i--;t--}r.checkIfQueueIsEmpty()};this.getRowHeader=function(n){var i,t,r;if(n===void 0){for(i=[],t=0,r=f.countRows();t<r;t++)i.push(f.getRowHeader(t));return i}return Object.prototype.toString.call(e.settings.rowHeaders)==="[object Array]"&&e.settings.rowHeaders[n]!==void 0?e.settings.rowHeaders[n]:typeof e.settings.rowHeaders=="function"?e.settings.rowHeaders(n):e.settings.rowHeaders&&typeof e.settings.rowHeaders!="string"&&typeof e.settings.rowHeaders!="number"?n+1:e.settings.rowHeaders};this.hasRowHeaders=function(){return!!e.settings.rowHeaders};this.hasColHeaders=function(){if(e.settings.colHeaders!==void 0&&e.settings.colHeaders!==null)return!!e.settings.colHeaders;for(var n=0,t=f.countCols();n<t;n++)if(f.getColHeader(n))return!0;return!1};this.getColHeader=function(n){var r,t,u;if(n===void 0){for(r=[],t=0,u=f.countCols();t<u;t++)r.push(f.getColHeader(t));return r}return n=i.PluginHooks.execute(f,"modifyCol",n),e.settings.columns&&e.settings.columns[n]&&e.settings.columns[n].title?e.settings.columns[n].title:Object.prototype.toString.call(e.settings.colHeaders)==="[object Array]"&&e.settings.colHeaders[n]!==void 0?e.settings.colHeaders[n]:typeof e.settings.colHeaders=="function"?e.settings.colHeaders(n):e.settings.colHeaders&&typeof e.settings.colHeaders!="string"&&typeof e.settings.colHeaders!="number"?i.helper.spreadsheetColumnLabel(n):e.settings.colHeaders};this._getColWidthFromSettings=function(n){var i=f.getCellMeta(0,n),t=i.width;if((t===void 0||t===e.settings.width)&&(t=i.colWidths),t!==void 0&&t!==null){switch(typeof t){case"object":t=t[n];break;case"function":t=t(n)}typeof t=="string"&&(t=parseInt(t,10))}return t};this.getColWidth=function(n){n=i.PluginHooks.execute(f,"modifyCol",n);var t={width:f._getColWidthFromSettings(n)};return t.width||(t.width=50),f.PluginHooks.run("afterGetColWidth",n,t),t.width};this.countRows=function(){return e.settings.data.length};this.countCols=function(){return f.dataType==="object"||f.dataType==="function"?e.settings.columns&&e.settings.columns.length?e.settings.columns.length:o.colToPropCache.length:f.dataType==="array"?e.settings.columns&&e.settings.columns.length?e.settings.columns.length:e.settings.data&&e.settings.data[0]&&e.settings.data[0].length?e.settings.data[0].length:0:void 0};this.rowOffset=function(){return f.view.wt.getSetting("offsetRow")};this.colOffset=function(){return f.view.wt.getSetting("offsetColumn")};this.countVisibleRows=function(){return f.view.wt.drawn?f.view.wt.wtTable.rowStrategy.countVisible():-1};this.countVisibleCols=function(){return f.view.wt.drawn?f.view.wt.wtTable.columnStrategy.countVisible():-1};this.countEmptyRows=function(n){for(var t=f.countRows()-1,i=0;t>=0;){if(o.get(t,0),f.isEmptyRow(o.getVars.row))i++;else if(n)break;t--}return i};this.countEmptyCols=function(n){if(f.countRows()<1)return 0;for(var t=f.countCols()-1,i=0;t>=0;){if(f.isEmptyCol(t))i++;else if(n)break;t--}return i};this.isEmptyRow=function(n){return e.settings.isEmptyRow.call(f,n)};this.isEmptyCol=function(n){return e.settings.isEmptyCol.call(f,n)};this.selectCell=function(n,t,i,r,u){return typeof n!="number"||n<0||n>=f.countRows()?!1:typeof t!="number"||t<0||t>=f.countCols()?!1:typeof i!="undefined"&&(typeof i!="number"||i<0||i>=f.countRows()||typeof r!="number"||r<0||r>=f.countCols())?!1:(e.selStart.coords({row:n,col:t}),document.activeElement&&document.activeElement!==document.documentElement&&document.activeElement!==document.body&&document.activeElement.blur(),f.listen(),typeof i=="undefined"?s.setRangeEnd({row:n,col:t},u):s.setRangeEnd({row:i,col:r},u),f.selection.finish(),!0)};this.selectCellByProp=function(){return arguments[1]=o.propToCol(arguments[1]),typeof arguments[3]!="undefined"&&(arguments[3]=o.propToCol(arguments[3])),f.selectCell.apply(f,arguments)};this.deselectCell=function(){s.deselect()};this.destroy=function(){f.clearTimeouts();f.view&&f.view.wt.destroy();f.rootElement.empty();f.rootElement.removeData("handsontable");f.rootElement.off(".handsontable");n(t).off("."+f.guid);y.off("."+f.guid);p.off("."+f.guid);f.PluginHooks.run("afterDestroy")};this.getActiveEditor=function(){return a.getActiveEditor()};this.getInstance=function(){return f.rootElement.data("handsontable")},function(){f.PluginHooks=new i.PluginHookClass;var n=f.PluginHooks.run,t=f.PluginHooks.execute;f.PluginHooks.run=function(t,r,u,e,o,s){n.call(this,f,t,r,u,e,o,s);i.PluginHooks.run(f,t,r,u,e,o,s)};f.PluginHooks.execute=function(n,r,u,e,o,s){var h=i.PluginHooks.execute(f,n,r,u,e,o,s),c=t.call(this,f,n,h,u,e,o,s);return typeof c=="undefined"?h:c};f.addHook=function(){f.PluginHooks.add.apply(f.PluginHooks,arguments)};f.addHookOnce=function(){f.PluginHooks.once.apply(f.PluginHooks,arguments)};f.removeHook=function(){f.PluginHooks.remove.apply(f.PluginHooks,arguments)};f.runHooks=function(){f.PluginHooks.run.apply(f.PluginHooks,arguments)};f.runHooksAndReturn=function(){return f.PluginHooks.execute.apply(f.PluginHooks,arguments)}}();this.timeouts={};this.registerTimeout=function(n,t,i){clearTimeout(this.timeouts[n]);this.timeouts[n]=setTimeout(t,i||0)};this.clearTimeouts=function(){for(var n in this.timeouts)this.timeouts.hasOwnProperty(n)&&clearTimeout(this.timeouts[n])};this.version="0.10.5"};lt=function(){};lt.prototype={data:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:null,colHeaders:null,minRows:0,minCols:0,maxRows:Infinity,maxCols:Infinity,minSpareRows:0,minSpareCols:0,multiSelect:!0,fillHandle:!0,fixedRowsTop:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,copyRowsLimit:1e3,copyColsLimit:1e3,pasteMode:"overwrite",currentRowClassName:void 0,currentColClassName:void 0,stretchH:"hybrid",isEmptyRow:function(n){for(var t,i=0,r=this.countCols();i<r;i++)if(t=this.getDataAtCell(n,i),t!==""&&t!==null&&typeof t!="undefined")return!1;return!0},isEmptyCol:function(n){for(var t,i=0,r=this.countRows();i<r;i++)if(t=this.getDataAtCell(i,n),t!==""&&t!==null&&typeof t!="undefined")return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,invalidCellClassName:"htInvalid",placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",fragmentSelection:!1,readOnly:!1,nativeScrollbars:!1,type:"text",copyable:!0,debug:!1};i.DefaultSettings=lt;n.fn.handsontable=function(n){var r,o,f,s,e,u=this.first(),t=u.data("handsontable");if(typeof n!="string")return e=n||{},t?t.updateSettings(e):(t=new i.Core(u,e),u.data("handsontable",t),t.init()),u;if(f=[],arguments.length>1)for(r=1,o=arguments.length;r<o;r++)f.push(arguments[r]);if(t)if(typeof t[n]!="undefined")s=t[n].apply(t,f);else throw new Error("Handsontable do not provide action: "+n);return s},function(n){function t(){function t(n){return n!==null&&!r(n)&&(typeof n=="string"||typeof n=="number")}function i(n){return n!==null&&(typeof n=="object"||typeof n=="function")}function r(n){return n!==n}var n={arrayMap:[],weakMap:new WeakMap};return{get:function(r){return t(r)?n.arrayMap[r]:i(r)?n.weakMap.get(r):void 0},set:function(r,u){if(t(r))n.arrayMap[r]=u;else if(i(r))n.weakMap.set(r,u);else throw new Error("Invalid key type");},"delete":function(r){t(r)?delete n.arrayMap[r]:i(r)&&n.weakMap["delete"](r)}}}n.MultiMap||(n.MultiMap=t)}(t);i.TableView=function(r){var u=this,c=n(t),o=n(document.documentElement),e,s,h,f;this.instance=r;this.settings=r.getSettings();this.settingsFromDOM=r.getSettingsFromDOM();r.rootElement.data("originalStyle",r.rootElement[0].getAttribute("style"));r.rootElement.addClass("handsontable");e=document.createElement("TABLE");e.className="htCore";this.THEAD=document.createElement("THEAD");e.appendChild(this.THEAD);this.TBODY=document.createElement("TBODY");e.appendChild(this.TBODY);r.$table=n(e);r.rootElement.prepend(r.$table);r.rootElement.on("mousedown.handsontable",function(n){u.isTextSelectionAllowed(n.target)||(h(),n.preventDefault(),t.focus())});o.on("keyup."+r.guid,function(n){r.selection.isInProgress()&&!n.shiftKey&&r.selection.finish()});o.on("mouseup."+r.guid,function(n){r.selection.isInProgress()&&n.which===1&&r.selection.finish();s=!1;r.autofill.handle&&r.autofill.handle.isDragged&&(r.autofill.handle.isDragged>1&&r.autofill.apply(),r.autofill.handle.isDragged=0);i.helper.isOutsideInput(document.activeElement)&&r.unlisten()});o.on("mousedown."+r.guid,function(n){var t=n.target;if(t!==u.wt.wtTable.spreader)while(t!==document.documentElement){if(t===null)return;if(t===r.rootElement[0]||t.nodeName==="HANDSONTABLE-TABLE")return;t=t.parentNode}u.settings.outsideClickDeselects?r.deselectCell():r.destroyEditor()});r.rootElement.on("mousedown.handsontable",".dragdealer",function(){r.destroyEditor()});r.$table.on("selectstart",function(n){u.settings.fragmentSelection||n.preventDefault()});h=function(){t.getSelection?t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges():document.selection&&document.selection.empty()};f={debug:function(){return u.settings.debug},table:e,stretchH:this.settings.stretchH,data:r.getDataAtCell,totalRows:r.countRows,totalColumns:r.countCols,nativeScrollbars:this.settings.nativeScrollbars,offsetRow:0,offsetColumn:0,width:this.getWidth(),height:this.getHeight(),fixedColumnsLeft:function(){return u.settings.fixedColumnsLeft},fixedRowsTop:function(){return u.settings.fixedRowsTop},rowHeaders:function(){return r.hasRowHeaders()?[function(n,t){u.appendRowHeader(n,t)}]:[]},columnHeaders:function(){return r.hasColHeaders()?[function(n,t){u.appendColHeader(n,t)}]:[]},columnWidth:r.getColWidth,cellRenderer:function(n,t,i){var r=u.instance.colToProp(t),f=u.instance.getCellMeta(n,t),o=u.instance.getCellRenderer(f),e=u.instance.getDataAtRowProp(n,r);o(u.instance,i,n,t,r,e,f);u.instance.PluginHooks.run("afterRenderer",i,n,t,r,e,f)},selections:{current:{className:"current",border:{width:2,color:"#5292F7",style:"solid",cornerVisible:function(){return u.settings.fillHandle&&!u.isCellEdited()&&!r.selection.isMultiple()}}},area:{className:"area",border:{width:1,color:"#89AFF9",style:"solid",cornerVisible:function(){return u.settings.fillHandle&&!u.isCellEdited()&&r.selection.isMultiple()}}},highlight:{highlightRowClassName:u.settings.currentRowClassName,highlightColumnClassName:u.settings.currentColClassName},fill:{className:"fill",border:{width:1,color:"red",style:"solid"}}},hideBorderOnMouseDownOver:function(){return u.settings.fragmentSelection},onCellMouseDown:function(n,t,i){r.listen();s=!0;var u={row:t[0],col:t[1]};n.button===2&&r.selection.inInSelection(u)||(n.shiftKey?r.selection.setRangeEnd(u):r.selection.setRangeStart(u));r.PluginHooks.run("afterOnCellMouseDown",n,t,i)},onCellMouseOver:function(n,t,i){var u={row:t[0],col:t[1]};s?r.selection.setRangeEnd(u):r.autofill.handle&&r.autofill.handle.isDragged&&(r.autofill.handle.isDragged++,r.autofill.showBorder(t));r.PluginHooks.run("afterOnCellMouseOver",n,t,i)},onCellCornerMouseDown:function(n){r.autofill.handle.isDragged=1;n.preventDefault();r.PluginHooks.run("afterOnCellCornerMouseDown",n)},onCellCornerDblClick:function(){r.autofill.selectAdjacent()},beforeDraw:function(n){u.beforeRender(n)},onDraw:function(n){u.onDraw(n)},onScrollVertically:function(){r.runHooks("afterScrollVertically")},onScrollHorizontally:function(){r.runHooks("afterScrollHorizontally")}};r.PluginHooks.run("beforeInitWalkontable",f);this.wt=new l(f);c.on("resize."+r.guid,function(){r.registerTimeout("resizeTimeout",function(){r.parseSettingsFromDOM();var n=u.getWidth(),t=u.getHeight();(f.width!==n||f.height!==t)&&(r.forceFullRender=!0,u.render(),f.width=n,f.height=t)},60)});n(u.wt.wtTable.spreader).on("mousedown.handsontable, contextmenu.handsontable",function(n){n.target===u.wt.wtTable.spreader&&n.which===3&&n.stopPropagation()});o.on("click."+r.guid,function(){u.settings.observeDOMVisibility&&u.wt.drawInterrupted&&(u.instance.forceFullRender=!0,u.render())})};i.TableView.prototype.isTextSelectionAllowed=function(n){return i.helper.isInput(n)?!0:this.settings.fragmentSelection&&this.wt.wtDom.isChildOf(n,this.TBODY)?!0:!1};i.TableView.prototype.isCellEdited=function(){var n=this.instance.getActiveEditor();return n&&n.isOpened()};i.TableView.prototype.getWidth=function(){var n=this.settings.width!==void 0?this.settings.width:this.settingsFromDOM.width;return typeof n=="function"?n():n};i.TableView.prototype.getHeight=function(){var n=this.settings.height!==void 0?this.settings.height:this.settingsFromDOM.height;return typeof n=="function"?n():n};i.TableView.prototype.beforeRender=function(n){n&&(this.instance.PluginHooks.run("beforeRender",this.instance.forceFullRender),this.wt.update("width",this.getWidth()),this.wt.update("height",this.getHeight()))};i.TableView.prototype.onDraw=function(n){n&&this.instance.PluginHooks.run("afterRender",this.instance.forceFullRender)};i.TableView.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender);this.instance.forceFullRender=!1;this.instance.rootElement.triggerHandler("render.handsontable")};i.TableView.prototype.getCellAtCoords=function(n){var t=this.wt.wtTable.getCell([n.row,n.col]);return t<0?null:t};i.TableView.prototype.scrollViewport=function(n){this.wt.scrollViewport([n.row,n.col])};i.TableView.prototype.appendRowHeader=function(n,t){if(n>-1)this.wt.wtDom.fastInnerHTML(t,this.instance.getRowHeader(n));else{var i=document.createElement("DIV");i.className="relative";this.wt.wtDom.fastInnerText(i," ");this.wt.wtDom.empty(t);t.appendChild(i)}};i.TableView.prototype.appendColHeader=function(n,t){var i=document.createElement("DIV"),r=document.createElement("SPAN");i.className="relative";r.className="colHeader";this.wt.wtDom.fastInnerHTML(r,this.instance.getColHeader(n));i.appendChild(r);this.wt.wtDom.empty(t);t.appendChild(i);this.instance.PluginHooks.run("afterGetColHeader",n,t)};i.TableView.prototype.maximumVisibleElementWidth=function(n){var t=this.wt.wtViewport.getWorkspaceWidth();return this.settings.nativeScrollbars?t:t-n};i.TableView.prototype.maximumVisibleElementHeight=function(n){var t=this.wt.wtViewport.getWorkspaceHeight();return this.settings.nativeScrollbars?t:t-n},function(n){function r(n){var i,t;t={};i=n;this.getInstance=function(n){return n.guid in t||(t[n.guid]=new i(n)),t[n.guid]}}var i={},t=new WeakMap;n.editors={registerEditor:function(n,u){var f=new r(u);typeof n=="string"&&(i[n]=f);t.set(u,f)},getEditor:function(n,r){var u;if(typeof n=="function")t.get(n)||this.registerEditor(null,n),u=t.get(n);else if(typeof n=="string")u=i[n];else throw Error('Only strings and functions can be passed as "editor" parameter ');if(!u)throw Error('No editor registered under name "'+n+'"');return u.getInstance(r)}}}(i),function(t){t.EditorManager=function(i,r,u){var f=this,s=n(document),o=t.helper.keyCode,e,h=function(){function h(s){var h,c,p;if(i.isListening()&&(r.settings.beforeOnKeyDown&&r.settings.beforeOnKeyDown.call(i,s),i.PluginHooks.run("beforeKeyDown",s),!s.isImmediatePropagationStopped()&&(r.lastKeyCode=s.keyCode,u.isSelected()))){if(h=(s.ctrlKey||s.metaKey)&&!s.altKey,!e.isWaiting()&&!t.helper.isMetaKey(s.keyCode)&&!h&&!f.isEditorOpened()){f.openEditor("");s.stopPropagation();return}c=s.shiftKey?u.setRangeEnd:u.setRangeStart;switch(s.keyCode){case o.A:if(h){u.selectAll();s.preventDefault();s.stopPropagation();break}case o.ARROW_UP:f.isEditorOpened()&&!e.isWaiting()&&f.closeEditorAndSaveChanges(h);l(s.shiftKey);s.preventDefault();s.stopPropagation();break;case o.ARROW_DOWN:f.isEditorOpened()&&!e.isWaiting()&&f.closeEditorAndSaveChanges(h);a(s.shiftKey);s.preventDefault();s.stopPropagation();break;case o.ARROW_RIGHT:f.isEditorOpened()&&!e.isWaiting()&&f.closeEditorAndSaveChanges(h);v(s.shiftKey);s.preventDefault();s.stopPropagation();break;case o.ARROW_LEFT:f.isEditorOpened()&&!e.isWaiting()&&f.closeEditorAndSaveChanges(h);y(s.shiftKey);s.preventDefault();s.stopPropagation();break;case o.TAB:p=typeof r.settings.tabMoves=="function"?r.settings.tabMoves(s):r.settings.tabMoves;s.shiftKey?u.transformStart(-p.row,-p.col):u.transformStart(p.row,p.col,!0);s.preventDefault();s.stopPropagation();break;case o.BACKSPACE:case o.DELETE:u.empty(s);f.prepareEditor();s.preventDefault();break;case o.F2:f.openEditor();s.preventDefault();break;case o.ENTER:f.isEditorOpened()?(e.state!==t.EditorState.WAITING&&f.closeEditorAndSaveChanges(h),n(s.shiftKey)):i.getSettings().enterBeginsEditing?f.openEditor():n(s.shiftKey);s.preventDefault();s.stopImmediatePropagation();break;case o.ESCAPE:f.isEditorOpened()&&f.closeEditorAndRestoreOriginalValue(h);s.preventDefault();break;case o.HOME:s.ctrlKey||s.metaKey?c({row:0,col:r.selStart.col()}):c({row:r.selStart.row(),col:0});s.preventDefault();s.stopPropagation();break;case o.END:s.ctrlKey||s.metaKey?c({row:i.countRows()-1,col:r.selStart.col()}):c({row:r.selStart.row(),col:i.countCols()-1});s.preventDefault();s.stopPropagation();break;case o.PAGE_UP:u.transformStart(-i.countVisibleRows(),0);i.view.wt.scrollVertical(-i.countVisibleRows());i.view.render();s.preventDefault();s.stopPropagation();break;case o.PAGE_DOWN:u.transformStart(i.countVisibleRows(),0);i.view.wt.scrollVertical(i.countVisibleRows());i.view.render();s.preventDefault();s.stopPropagation()}}}function c(){f.openEditor()}function n(n){var t=typeof r.settings.enterMoves=="function"?r.settings.enterMoves(event):r.settings.enterMoves;n?u.transformStart(-t.row,-t.col):u.transformStart(t.row,t.col,!0)}function l(n){n?u.transformEnd(-1,0):u.transformStart(-1,0)}function a(n){n?u.transformEnd(1,0):u.transformStart(1,0)}function v(n){n?u.transformEnd(0,1):u.transformStart(0,1)}function y(n){n?u.transformEnd(0,-1):u.transformStart(0,-1)}s.on("keydown.handsontable."+i.guid,h);i.view.wt.update("onCellDblClick",c);i.addHook("afterDestroy",function(){s.off("keydown.handsontable."+i.guid)})};this.destroyEditor=function(n){this.closeEditor(n)};this.getActiveEditor=function(){return e};this.prepareEditor=function(){if(e&&e.isWaiting()){this.closeEditor(!1,!1,function(n){n&&f.prepareEditor()});return}var u=r.selStart.row(),n=r.selStart.col(),s=i.colToProp(n),h=i.getCell(u,n),c=i.getDataAtCell(u,n),o=i.getCellMeta(u,n),l=i.getCellEditor(o);e=t.editors.getEditor(l,i);e.prepare(u,n,s,h,c,o)};this.isEditorOpened=function(){return e.isOpened()};this.openEditor=function(n){e.cellProperties.readOnly||e.beginEditing(n)};this.closeEditor=function(n,t,i){e?e.finishEditing(n,t,i):i&&i(!1)};this.closeEditorAndSaveChanges=function(n){return this.closeEditor(!1,n)};this.closeEditorAndRestoreOriginalValue=function(n){return this.closeEditor(!0,n)};h()}}(i),function(n){var t={};n.renderers={registerRenderer:function(n,i){t[n]=i},getRenderer:function(n){if(typeof n=="function")return n;if(typeof n!="string")throw Error('Only strings and functions can be passed as "renderer" parameter ');if(!(n in t))throw Error('No editor registered under name "'+n+'"');return t[n]}}}(i);i.Dom=new r;i.helper.isPrintableChar=function(n){return n==32||n>=48&&n<=57||n>=96&&n<=111||n>=186&&n<=192||n>=219&&n<=222||n>=226||n>=65&&n<=90};i.helper.isMetaKey=function(n){var t=i.helper.keyCode,r=[t.ARROW_DOWN,t.ARROW_UP,t.ARROW_LEFT,t.ARROW_RIGHT,t.HOME,t.END,t.DELETE,t.BACKSPACE,t.F1,t.F2,t.F3,t.F4,t.F5,t.F6,t.F7,t.F8,t.F9,t.F10,t.F11,t.F12,t.TAB,t.PAGE_DOWN,t.PAGE_UP,t.ENTER,t.ESCAPE,t.SHIFT,t.CAPS_LOCK,t.ALT];return r.indexOf(n)!=-1};i.helper.isCtrlKey=function(n){var t=i.helper.keyCode;return[t.CONTROL_LEFT,224,t.COMMAND_LEFT,t.COMMAND_RIGHT].indexOf(n)!=-1};i.helper.stringify=function(n){switch(typeof n){case"string":case"number":return n+"";case"object":return n===null?"":n.toString();case"undefined":return"";default:return n.toString()}};i.helper.spreadsheetColumnLabel=function(n){for(var t=n+1,i="",r;t>0;)r=(t-1)%26,i=String.fromCharCode(65+r)+i,t=parseInt((t-r)/26,10);return i};i.helper.isNumeric=function(n){var t=typeof n;return t=="number"?!isNaN(n)&&isFinite(n):t=="string"?n.length?n.length==1?/\d/.test(n):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(n):!1:t=="object"?!!n&&typeof n.valueOf()=="number"&&!(n instanceof Date):!1};i.helper.isArray=function(n){return Object.prototype.toString.call(n).match(/array/i)!==null};i.helper.isDescendant=function(n,t){for(var i=t.parentNode;i!=null;){if(i==n)return!0;i=i.parentNode}return!1};i.helper.randomString=function(){return ii()};i.helper.inherit=function(n,t){return t.prototype.constructor=t,n.prototype=new t,n.prototype.constructor=n,n};i.helper.extend=function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};i.helper.getPrototypeOf=function(n){var i,r,t;return typeof n.__proto__=="object"?i=n.__proto__:(t=n.constructor,typeof n.constructor=="function"&&(r=t,delete n.constructor&&(t=n.constructor,n.constructor=r)),i=t?t.prototype:null),i};i.helper.columnFactory=function(n,t){function r(){}i.helper.inherit(r,n);for(var u=0,f=t.length;u<f;u++)r.prototype[t[u]]=void 0;return r};i.helper.translateRowsToColumns=function(n){for(var t,f,r=[],e=0,i=0,u=n.length;i<u;i++)for(t=0,f=n[i].length;t<f;t++)t==e&&(r.push([]),e++),r[t].push(n[i][t]);return r};i.helper.to2dArray=function(n){for(var t=0,i=n.length;t<i;)n[t]=[n[t]],t++};i.helper.extendArray=function(n,t){for(var i=0,r=t.length;i<r;)n.push(t[i]),i++};i.helper.isInput=function(n){return["INPUT","SELECT","TEXTAREA"].indexOf(n.nodeName)>-1};i.helper.isOutsideInput=function(n){return i.helper.isInput(n)&&n.className.indexOf("handsontableInput")==-1};i.helper.keyCode={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86};i.helper.isObject=function(n){return Object.prototype.toString.call(n)=="[object Object]"};i.helper.isArray=function(n){return Array.isArray?Array.isArray(n):Object.prototype.toString.call(n)=="[object Array]"};i.helper.pivot=function(n){var i=[],u,f,r,t;if(!n||n.length==0||!n[0]||n[0].length==0)return i;for(u=n.length,f=n[0].length,r=0;r<u;r++)for(t=0;t<f;t++)i[t]||(i[t]=[]),i[t][r]=n[r][t];return i};i.helper.proxy=function(n,t){return function(){return n.apply(t,arguments)}};i.helper.cellMethodLookupFactory=function(n,t){function r(n){var t=i.cellTypes[n];if(typeof t=="undefined")throw new Error('You declared cell type "'+n+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');return t}return t=typeof t=="undefined"?!0:t,function(u,f){return function e(u){if(u){if(u.hasOwnProperty(n)&&u[n])return u[n];if(u.hasOwnProperty("type")&&u.type){var f;if(typeof u.type!="string")throw new Error("Cell type must be a string ");if(f=r(u.type),f.hasOwnProperty(n))return f[n];if(t)return}}else return;return e(i.helper.getPrototypeOf(u))}(typeof u=="number"?this.getCellMeta(u,f):u)}};i.helper.toString=function(n){return""+n};i.SelectionPoint=function(){this._row=null;this._col=null};i.SelectionPoint.prototype.exists=function(){return this._row!==null};i.SelectionPoint.prototype.row=function(n){return n!==void 0&&(this._row=n),this._row};i.SelectionPoint.prototype.col=function(n){return n!==void 0&&(this._col=n),this._col};i.SelectionPoint.prototype.coords=function(n){return n!==void 0&&(this._row=n.row,this._col=n.col),{row:this._row,col:this._col}};i.SelectionPoint.prototype.arr=function(n){return n!==void 0&&(this._row=n[0],this._col=n[1]),[this._row,this._col]},function(t){t.DataMap=function(n,t,i){this.instance=n;this.priv=t;this.GridSettings=i;this.dataSource=this.instance.getSettings().data;this.duckSchema=this.dataSource[0]?this.recursiveDuckSchema(this.dataSource[0]):{};this.createMap();this.getVars={};this.setVars={}};t.DataMap.prototype.DESTINATION_RENDERER=1;t.DataMap.prototype.DESTINATION_CLIPBOARD_GENERATOR=2;t.DataMap.prototype.recursiveDuckSchema=function(t){var r,i;if(n.isPlainObject(t)){r={};for(i in t)t.hasOwnProperty(i)&&(r[i]=n.isPlainObject(t[i])?this.recursiveDuckSchema(t[i]):null)}else r=[];return r};t.DataMap.prototype.recursiveDuckColumns=function(t,i,r){var f,u;if(typeof i=="undefined"&&(i=0,r=""),n.isPlainObject(t))for(u in t)t.hasOwnProperty(u)&&(t[u]===null?(f=r+u,this.colToPropCache.push(f),this.propToColCache.set(f,i),i++):i=this.recursiveDuckColumns(t[u],i,u+"."));return i};t.DataMap.prototype.createMap=function(){var n,i,r,t;if(typeof this.getSchema()=="undefined")throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`");if(r=this.getSchema(),this.colToPropCache=[],this.propToColCache=new MultiMap,t=this.instance.getSettings().columns,t)for(n=0,i=t.length;n<i;n++)typeof t[n].data!="undefined"&&(this.colToPropCache[n]=t[n].data,this.propToColCache.set(t[n].data,n));else this.recursiveDuckColumns(r)};t.DataMap.prototype.colToProp=function(n){return n=t.PluginHooks.execute(this.instance,"modifyCol",n),this.colToPropCache&&typeof this.colToPropCache[n]!="undefined"?this.colToPropCache[n]:n};t.DataMap.prototype.propToCol=function(n){var i;return i=typeof this.propToColCache.get(n)!="undefined"?this.propToColCache.get(n):n,t.PluginHooks.execute(this.instance,"modifyCol",i)};t.DataMap.prototype.getSchema=function(){var n=this.instance.getSettings().dataSchema;return n?typeof n=="function"?n():n:this.duckSchema};t.DataMap.prototype.createRow=function(t,i,r){var u,h=this.instance.countCols(),f=0,o,s,e;for(i||(i=1),(typeof t!="number"||t>=this.instance.countRows())&&(t=this.instance.countRows()),o=t,s=this.instance.getSettings().maxRows;f<i&&this.instance.countRows()<s;){if(this.instance.dataType==="array")for(u=[],e=0;e<h;e++)u.push(null);else u=this.instance.dataType==="function"?this.instance.getSettings().dataSchema(t):n.extend(!0,{},this.getSchema());t===this.instance.countRows()?this.dataSource.push(u):this.dataSource.splice(t,0,u);f++;o++}return this.instance.PluginHooks.run("afterCreateRow",t,f,r),this.instance.forceFullRender=!0,f};t.DataMap.prototype.createCol=function(n,i,r){var c,u;if(this.instance.dataType==="object"||this.instance.getSettings().columns)throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var h=this.instance.countRows(),f=this.dataSource,s,e=0,o;for(i||(i=1),o=n,c=this.instance.getSettings().maxCols;e<i&&this.instance.countCols()<c;){if(s=t.helper.columnFactory(this.GridSettings,this.priv.columnsSettingConflicts),typeof n!="number"||n>=this.instance.countCols()){for(u=0;u<h;u++)typeof f[u]=="undefined"&&(f[u]=[]),f[u].push(null);this.priv.columnSettings.push(s)}else{for(u=0;u<h;u++)f[u].splice(o,0,null);this.priv.columnSettings.splice(o,0,s)}e++;o++}return this.instance.PluginHooks.run("afterCreateCol",n,e,r),this.instance.forceFullRender=!0,e};t.DataMap.prototype.removeRow=function(n,t){var r,u,i,f;(t||(t=1),typeof n!="number"&&(n=-t),n=(this.instance.countRows()+n)%this.instance.countRows(),r=this.physicalRowsToLogical(n,t),u=this.instance.PluginHooks.execute("beforeRemoveRow",n,t),u!==!1)&&(i=this.dataSource,f=i.filter(function(n,t){return r.indexOf(t)==-1}),i.length=0,Array.prototype.push.apply(i,f),this.instance.PluginHooks.run("afterRemoveRow",n,t),this.instance.forceFullRender=!0)};t.DataMap.prototype.removeCol=function(n,t){var r,u,i,f;if(this.instance.dataType==="object"||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");if(t||(t=1),typeof n!="number"&&(n=-t),n=(this.instance.countCols()+n)%this.instance.countCols(),r=this.instance.PluginHooks.execute("beforeRemoveCol",n,t),r!==!1){for(u=this.dataSource,i=0,f=this.instance.countRows();i<f;i++)u[i].splice(n,t);this.priv.columnSettings.splice(n,t);this.instance.PluginHooks.run("afterRemoveCol",n,t);this.instance.forceFullRender=!0}};t.DataMap.prototype.spliceCol=function(n,i,r){var u=4<=arguments.length?[].slice.call(arguments,3):[],e=this.instance.getDataAtCol(n),o=e.slice(i,i+r),s=e.slice(i+r),f;for(t.helper.extendArray(u,s),f=0;f<r;)u.push(null),f++;return t.helper.to2dArray(u),this.instance.populateFromArray(i,n,u,null,null,"spliceCol"),o};t.DataMap.prototype.spliceRow=function(n,i,r){var u=4<=arguments.length?[].slice.call(arguments,3):[],e=this.instance.getDataAtRow(n),o=e.slice(i,i+r),s=e.slice(i+r),f;for(t.helper.extendArray(u,s),f=0;f<r;)u.push(null),f++;return this.instance.populateFromArray(n,i,[u],null,null,"spliceRow"),o};t.DataMap.prototype.get=function(n,t){var u,i,r,f;if(this.getVars.row=n,this.getVars.prop=t,this.instance.PluginHooks.run("beforeGet",this.getVars),typeof this.getVars.prop=="string"&&this.getVars.prop.indexOf(".")>-1){if(u=this.getVars.prop.split("."),i=this.dataSource[this.getVars.row],!i)return null;for(r=0,f=u.length;r<f;r++)if(i=i[u[r]],typeof i=="undefined")return null;return i}return typeof this.getVars.prop=="function"?this.getVars.prop(this.dataSource.slice(this.getVars.row,this.getVars.row+1)[0]):this.dataSource[this.getVars.row]?this.dataSource[this.getVars.row][this.getVars.prop]:null};var i=t.helper.cellMethodLookupFactory("copyable",!1);t.DataMap.prototype.getCopyable=function(n,t){return i.call(this.instance,n,this.propToCol(t))?this.get(n,t):""};t.DataMap.prototype.set=function(n,t,i,r){var f,e,u,o;if(this.setVars.row=n,this.setVars.prop=t,this.setVars.value=i,this.instance.PluginHooks.run("beforeSet",this.setVars,r||"datamapGet"),typeof this.setVars.prop=="string"&&this.setVars.prop.indexOf(".")>-1){for(f=this.setVars.prop.split("."),e=this.dataSource[this.setVars.row],u=0,o=f.length-1;u<o;u++)e=e[f[u]];e[f[u]]=this.setVars.value}else typeof this.setVars.prop=="function"?this.setVars.prop(this.dataSource.slice(this.setVars.row,this.setVars.row+1)[0],this.setVars.value):this.dataSource[this.setVars.row][this.setVars.prop]=this.setVars.value};t.DataMap.prototype.physicalRowsToLogical=function(n,t){for(var i=this.instance.countRows(),r=(i+n)%i,u=[],f=t;r<i&&f;)this.get(r,0),u.push(this.getVars.row),f--,r++;return u};t.DataMap.prototype.clear=function(){for(var t,n=0;n<this.instance.countRows();n++)for(t=0;t<this.instance.countCols();t++)this.set(n,this.colToProp(t),"")};t.DataMap.prototype.getAll=function(){return this.dataSource};t.DataMap.prototype.getRange=function(n,t,i){var r,e,u,o,s=[],f,h=i===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;for(e=Math.max(n.row,t.row),o=Math.max(n.col,t.col),r=Math.min(n.row,t.row);r<=e;r++){for(f=[],u=Math.min(n.col,t.col);u<=o;u++)f.push(h.call(this,r,this.colToProp(u)));s.push(f)}return s};t.DataMap.prototype.getText=function(n,t){return SheetClip.stringify(this.getRange(n,t,this.DESTINATION_RENDERER))};t.DataMap.prototype.getCopyableText=function(n,t){return SheetClip.stringify(this.getRange(n,t,this.DESTINATION_CLIPBOARD_GENERATOR))}}(i),function(n){n.renderers.cellDecorator=function(n,t,i,r,u,f,e){e.readOnly&&n.view.wt.wtDom.addClass(t,e.readOnlyCellClassName);e.valid===!1&&e.invalidCellClassName&&n.view.wt.wtDom.addClass(t,e.invalidCellClassName);!f&&e.placeholder&&n.view.wt.wtDom.addClass(t,e.placeholderCellClassName)}}(i),function(n){var t=function(t,i,r,u,f,e,o){var h,s;n.renderers.cellDecorator.apply(this,arguments);!e&&o.placeholder&&(e=o.placeholder);h=n.helper.stringify(e);o.rendererTemplate?(t.view.wt.wtDom.empty(i),s=document.createElement("TEMPLATE"),s.setAttribute("bind","{{}}"),s.innerHTML=o.rendererTemplate,HTMLTemplateElement.decorate(s),s.model=t.getDataAtRow(r),i.appendChild(s)):t.view.wt.wtDom.fastInnerText(i,h)};n.renderers.TextRenderer=t;n.renderers.registerRenderer("text",t)}(i),function(n){var r=document.createElement("DIV"),t,u,i;r.className="htAutocompleteWrapper";t=document.createElement("DIV");t.className="htAutocompleteArrow";t.appendChild(document.createTextNode("▼"));u=function(t,i){i.innerHTML=t.innerHTML;n.Dom.empty(t);t.appendChild(i)};i=function(i,u,f,e,o,s,h){var l=r.cloneNode(!0),c=t.cloneNode(!0);if(n.renderers.TextRenderer(i,u,f,e,o,s,h),u.appendChild(c),n.Dom.addClass(u,"htAutocomplete"),u.firstChild||u.appendChild(document.createTextNode(" ")),!i.acArrowListener){i.acArrowListener=function(){i.view.wt.getSetting("onCellDblClick")};i.rootElement.on("mousedown.htAutocompleteArrow",".htAutocompleteArrow",i.acArrowListener);i.addHookOnce("afterDestroy",function(){this.rootElement.off("mousedown.htAutocompleteArrow")})}};n.AutocompleteRenderer=i;n.renderers.AutocompleteRenderer=i;n.renderers.registerRenderer("autocomplete",i)}(i),function(t){var i=document.createElement("INPUT"),r;i.className="htCheckboxRendererInput";i.type="checkbox";i.setAttribute("autocomplete","off");r=function(r,u,f,e,o,s,h){var c,l;if(typeof h.checkedTemplate=="undefined"&&(h.checkedTemplate=!0),typeof h.uncheckedTemplate=="undefined"&&(h.uncheckedTemplate=!1),r.view.wt.wtDom.empty(u),c=i.cloneNode(!1),s===h.checkedTemplate||s===t.helper.stringify(h.checkedTemplate)?(c.checked=!0,u.appendChild(c)):s===h.uncheckedTemplate||s===t.helper.stringify(h.uncheckedTemplate)?u.appendChild(c):s===null?(c.className+=" noValue",u.appendChild(c)):r.view.wt.wtDom.fastInnerText(u,"#bad value#"),l=n(c),h.readOnly)l.on("click",function(n){n.preventDefault()});else{l.on("mousedown",function(n){n.stopPropagation()});l.on("mouseup",function(n){n.stopPropagation()});l.on("change",function(){this.checked?r.setDataAtRowProp(f,o,h.checkedTemplate):r.setDataAtRowProp(f,o,h.uncheckedTemplate)})}r.CheckboxRenderer&&r.CheckboxRenderer.beforeKeyDownHookBound||(r.CheckboxRenderer={beforeKeyDownHookBound:!0},r.addHook("beforeKeyDown",function(i){var o,s,e,a;if(i.keyCode==t.helper.keyCode.SPACE){var u=r.getSelected(),c,f,l,v={row:Math.min(u[0],u[2]),col:Math.min(u[1],u[3])},h={row:Math.max(u[0],u[2]),col:Math.max(u[1],u[3])};for(o=v.row;o<=h.row;o++)for(s=h.col;s<=h.col;s++)if(c=r.getCell(o,s),l=r.getCellMeta(o,s),f=c.querySelectorAll("input[type=checkbox]"),f.length>0&&!l.readOnly)for(i.isImmediatePropagationStopped()||(i.stopImmediatePropagation(),i.preventDefault()),e=0,a=f.length;e<a;e++)f[e].checked=!f[e].checked,n(f[e]).trigger("change")}}))};t.CheckboxRenderer=r;t.renderers.CheckboxRenderer=r;t.renderers.registerRenderer("checkbox",r)}(i),function(n){var t=function(t,i,r,u,f,e,o){n.helper.isNumeric(e)&&(typeof o.language!="undefined"&&numeral.language(o.language),e=numeral(e).format(o.format||"0"),t.view.wt.wtDom.addClass(i,"htNumeric"));n.renderers.TextRenderer(t,i,r,u,f,e,o)};n.NumericRenderer=t;n.renderers.NumericRenderer=t;n.renderers.registerRenderer("numeric",t)}(i),function(n){var t=function(n,t,r,u,f,e,o){i.renderers.TextRenderer.apply(this,arguments);e=t.innerHTML;for(var c=o.hashLength||e.length,h=o.hashSymbol||"*",s="";s.split(h).length-1<c;s+=h);n.view.wt.wtDom.fastInnerHTML(t,s)};n.PasswordRenderer=t;n.renderers.PasswordRenderer=t;n.renderers.registerRenderer("password",t)}(i),function(n){function t(t,i,r,u,f,e){n.renderers.cellDecorator.apply(this,arguments);n.Dom.fastInnerHTML(i,e)}n.renderers.registerRenderer("html",t);n.renderers.HtmlRenderer=t}(i),function(n){function t(t){this.instance=t;this.state=n.EditorState.VIRGIN;this._opened=!1;this._closeCallback=null;this.init()}n.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"};t.prototype._fireCallbacks=function(n){this._closeCallback&&(this._closeCallback(n),this._closeCallback=null)};t.prototype.init=function(){};t.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented");};t.prototype.setValue=function(){throw Error("Editor setValue() method unimplemented");};t.prototype.open=function(){throw Error("Editor open() method unimplemented");};t.prototype.close=function(){throw Error("Editor close() method unimplemented");};t.prototype.prepare=function(t,i,r,u,f,e){this.TD=u;this.row=t;this.col=i;this.prop=r;this.originalValue=f;this.cellProperties=e;this.state=n.EditorState.VIRGIN};t.prototype.extend=function(){function t(){n.apply(this,arguments)}function i(n,t){function i(){}return i.prototype=t.prototype,n.prototype=new i,n.prototype.constructor=n,n}var n=this.constructor;return i(t,n)};t.prototype.saveValue=function(n,t){if(t){var i=this.instance.getSelected();this.instance.populateFromArray(i[0],i[1],n,i[2],i[3],"edit")}else this.instance.populateFromArray(this.row,this.col,n,null,null,"edit")};t.prototype.beginEditing=function(t){this.state==n.EditorState.VIRGIN&&(this.instance.view.scrollViewport({row:this.row,col:this.col}),this.instance.view.render(),this.state=n.EditorState.EDITING,t=typeof t=="string"?t:this.originalValue,this.setValue(n.helper.stringify(t)),this.open(),this._opened=!0,this.focus(),this.instance.view.render())};t.prototype.finishEditing=function(t,i,r){var f,e,u;if(r&&(f=this._closeCallback,this._closeCallback=function(n){f&&f(n);r(n)}),!this.isWaiting()){if(this.state==n.EditorState.VIRGIN){u=this;setTimeout(function(){u._fireCallbacks(!0)});return}if(this.state==n.EditorState.EDITING){if(t){this.cancelChanges();return}e=[[String.prototype.trim.call(this.getValue())]];this.state=n.EditorState.WAITING;this.saveValue(e,i);this.instance.getCellValidator(this.cellProperties)?(u=this,this.instance.addHookOnce("afterValidate",function(t){u.state=n.EditorState.FINISHED;u.discardEditor(t)})):(this.state=n.EditorState.FINISHED,this.discardEditor(!0))}}};t.prototype.cancelChanges=function(){this.state=n.EditorState.FINISHED;this.discardEditor()};t.prototype.discardEditor=function(t){this.state===n.EditorState.FINISHED&&(t===!1&&this.cellProperties.allowInvalid!==!0?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=n.EditorState.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this.state=n.EditorState.VIRGIN,this._fireCallbacks(!0)))};t.prototype.isOpened=function(){return this._opened};t.prototype.isWaiting=function(){return this.state===n.EditorState.WAITING};n.editors.BaseEditor=t}(i),function(t){var i=t.editors.BaseEditor.prototype.extend(),u;i.prototype.init=function(){this.createElements();this.bindEvents()};i.prototype.getValue=function(){return this.TEXTAREA.value};i.prototype.setValue=function(n){this.TEXTAREA.value=n};u=function(n){var o=this,i=o.getActiveEditor(),r=t.helper.keyCode,f=(n.ctrlKey||n.metaKey)&&!n.altKey,u,e;if(n.target===i.TEXTAREA&&!n.isImmediatePropagationStopped()){if(n.keyCode===17||n.keyCode===224||n.keyCode===91||n.keyCode===93){n.stopImmediatePropagation();return}switch(n.keyCode){case r.ARROW_RIGHT:i.wtDom.getCaretPosition(i.TEXTAREA)!==i.TEXTAREA.value.length&&n.stopImmediatePropagation();break;case r.ARROW_LEFT:i.wtDom.getCaretPosition(i.TEXTAREA)!==0&&n.stopImmediatePropagation();break;case r.ENTER:u=i.instance.getSelected();e=!(u[0]===u[2]&&u[1]===u[3]);(f&&!e||n.altKey)&&(i.isOpened()?(i.setValue(i.getValue()+"\n"),i.focus()):i.beginEditing(i.originalValue+"\n"),n.stopImmediatePropagation());n.preventDefault();break;case r.A:case r.X:case r.C:case r.V:if(f){n.stopImmediatePropagation();break}case r.BACKSPACE:case r.DELETE:case r.HOME:case r.END:n.stopImmediatePropagation()}}};i.prototype.open=function(){this.refreshDimensions();this.instance.addHook("beforeKeyDown",u)};i.prototype.close=function(){this.textareaParentStyle.display="none";document.activeElement===this.TEXTAREA&&this.instance.listen();this.instance.removeHook("beforeKeyDown",u)};i.prototype.focus=function(){this.TEXTAREA.focus();this.wtDom.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)};i.prototype.createElements=function(){this.$body=n(document.body);this.wtDom=new r;this.TEXTAREA=document.createElement("TEXTAREA");this.$textarea=n(this.TEXTAREA);this.wtDom.addClass(this.TEXTAREA,"handsontableInput");this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;this.TEXTAREA_PARENT=document.createElement("DIV");this.wtDom.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder");this.textareaParentStyle=this.TEXTAREA_PARENT.style;this.textareaParentStyle.top=0;this.textareaParentStyle.left=0;this.textareaParentStyle.display="none";this.TEXTAREA_PARENT.appendChild(this.TEXTAREA);this.instance.rootElement[0].appendChild(this.TEXTAREA_PARENT);var i=this;t.PluginHooks.add("afterRender",function(){i.instance.registerTimeout("refresh_editor_dimensions",function(){i.refreshDimensions()},0)})};i.prototype.refreshDimensions=function(){if(this.state===t.EditorState.EDITING&&(this.TD=this.instance.getCell(this.row,this.col),this.TD)){var i=n(this.TD),f=this.wtDom.offset(this.TD),e=this.wtDom.offset(this.instance.rootElement[0]),v=this.instance.rootElement.scrollTop(),y=this.instance.rootElement.scrollLeft(),r=f.top-e.top+v-1,u=f.left-e.left+y-1,o=this.instance.getSettings(),s=o.rowHeaders===!1?0:1,p=o.colHeaders===!1?0:1;r<0&&(r=0);u<0&&(u=0);s>0&&parseInt(i.css("border-top-width"),10)>0&&(r+=1);p>0&&parseInt(i.css("border-left-width"),10)>0&&(u+=1);this.textareaParentStyle.top=r+"px";this.textareaParentStyle.left=u+"px";var h=i.width(),c=this.instance.view.maximumVisibleElementWidth(u)-10,l=i.outerHeight()-4,a=this.instance.view.maximumVisibleElementHeight(r)-5;parseInt(i.css("border-top-width"),10)>0&&(l-=1);parseInt(i.css("border-left-width"),10)>0&&s>0&&(h-=1);this.$textarea.autoResize({minHeight:Math.min(l,a),maxHeight:a,minWidth:Math.min(h,c),maxWidth:c,animate:!1,extraSpace:0});this.textareaParentStyle.display="block"}};i.prototype.bindEvents=function(){this.$textarea.on("cut.editor",function(n){n.stopPropagation()});this.$textarea.on("paste.editor",function(n){n.stopPropagation()})};t.editors.TextEditor=i;t.editors.registerEditor("text",t.editors.TextEditor)}(i),function(t){var i=t.editors.BaseEditor.prototype.extend();i.prototype.beginEditing=function(){var t=this.TD.querySelector('input[type="checkbox"]');t&&n(t).trigger("click")};i.prototype.finishEditing=function(){};i.prototype.init=function(){};i.prototype.open=function(){};i.prototype.close=function(){};i.prototype.getValue=function(){};i.prototype.setValue=function(){};i.prototype.focus=function(){};t.editors.CheckboxEditor=i;t.editors.registerEditor("checkbox",i)}(i),function(t){var i=t.editors.TextEditor.prototype.extend();i.prototype.init=function(){if(!n.datepicker)throw new Error("jQuery UI Datepicker dependency not found. Did you forget to include jquery-ui.custom.js or its substitute?");t.editors.TextEditor.prototype.init.apply(this,arguments);this.isCellEdited=!1;var i=this;this.instance.addHook("afterDestroy",function(){i.destroyElements()})};i.prototype.createElements=function(){t.editors.TextEditor.prototype.createElements.apply(this,arguments);this.datePicker=document.createElement("DIV");this.instance.view.wt.wtDom.addClass(this.datePicker,"htDatepickerHolder");this.datePickerStyle=this.datePicker.style;this.datePickerStyle.position="absolute";this.datePickerStyle.top=0;this.datePickerStyle.left=0;this.datePickerStyle.zIndex=99;document.body.appendChild(this.datePicker);this.$datePicker=n(this.datePicker);var i=this,r={dateFormat:"yy-mm-dd",showButtonPanel:!1,changeMonth:!1,changeYear:!1,onSelect:function(n){i.setValue(n);i.finishEditing(!1)}};this.$datePicker.datepicker(r);this.$datePicker.on("mousedown",function(n){n.stopPropagation()});this.hideDatepicker()};i.prototype.destroyElements=function(){this.$datePicker.datepicker("destroy");this.$datePicker.remove()};i.prototype.open=function(){t.editors.TextEditor.prototype.open.call(this);this.showDatepicker()};i.prototype.finishEditing=function(){this.hideDatepicker();t.editors.TextEditor.prototype.finishEditing.apply(this,arguments)};i.prototype.showDatepicker=function(){var i=n(this.TD),r=i.offset(),t;this.datePickerStyle.top=r.top+i.height()+"px";this.datePickerStyle.left=r.left+"px";t={defaultDate:this.originalValue||void 0};n.extend(t,this.cellProperties);this.$datePicker.datepicker("option",t);this.originalValue&&this.$datePicker.datepicker("setDate",this.originalValue);this.datePickerStyle.display="block"};i.prototype.hideDatepicker=function(){this.datePickerStyle.display="none"};t.editors.DateEditor=i;t.editors.registerEditor("date",i)}(i),function(t){var i=t.editors.TextEditor.prototype.extend(),r;i.prototype.createElements=function(){t.editors.TextEditor.prototype.createElements.apply(this,arguments);var i=document.createElement("DIV");i.className="handsontableEditor";this.TEXTAREA_PARENT.appendChild(i);this.$htContainer=n(i);this.$htContainer.handsontable()};i.prototype.prepare=function(i,r,u,f,e,o){t.editors.TextEditor.prototype.prepare.apply(this,arguments);var s=this,h={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,cells:function(){return{readOnly:!0}},fillHandle:!1,afterOnCellMouseDown:function(){var n=this.getValue();n!==void 0&&s.setValue(n);s.instance.destroyEditor()},beforeOnKeyDown:function(n){var i=this,r,u;switch(n.keyCode){case t.helper.keyCode.ESCAPE:s.instance.destroyEditor(!0);n.stopImmediatePropagation();n.preventDefault();break;case t.helper.keyCode.ENTER:r=i.getSelected();u=this.getDataAtCell(r[0],r[1]);u!==void 0&&s.setValue(u);s.instance.destroyEditor();break;case t.helper.keyCode.ARROW_UP:i.getSelected()&&i.getSelected()[0]==0&&!s.cellProperties.strict&&(i.deselectCell(),s.instance.listen(),s.focus(),n.preventDefault(),n.stopImmediatePropagation())}}};this.cellProperties.handsontable&&(h=n.extend(h,o.handsontable));this.$htContainer.handsontable("destroy");this.$htContainer.handsontable(h)};r=function(n){var u,i,r,f;n.isImmediatePropagationStopped()||(u=this.getActiveEditor(),i=u.$htContainer.handsontable("getInstance"),n.keyCode==t.helper.keyCode.ARROW_DOWN&&(i.getSelected()?(r=i.getSelected()[0],f=r<i.countRows()-1?r+1:r,i.selectCell(f,0)):i.selectCell(0,0),n.preventDefault(),n.stopImmediatePropagation()))};i.prototype.open=function(){this.instance.addHook("beforeKeyDown",r);t.editors.TextEditor.prototype.open.apply(this,arguments);this.$htContainer.handsontable("render");this.cellProperties.strict?(this.$htContainer.handsontable("selectCell",0,0),this.$textarea[0].style.visibility="hidden"):(this.$htContainer.handsontable("deselectCell"),this.$textarea[0].style.visibility="visible");this.wtDom.setCaretPosition(this.$textarea[0],0,this.$textarea[0].value.length)};i.prototype.close=function(){this.instance.removeHook("beforeKeyDown",r);this.instance.listen();t.editors.TextEditor.prototype.close.apply(this,arguments)};i.prototype.focus=function(){this.instance.listen();t.editors.TextEditor.prototype.focus.apply(this,arguments)};i.prototype.beginEditing=function(){var n=this.instance.getSettings().onBeginEditing;n&&n()===!1||t.editors.TextEditor.prototype.beginEditing.apply(this,arguments)};i.prototype.finishEditing=function(){if(this.$htContainer.handsontable("isListening")&&this.instance.listen(),this.$htContainer.handsontable("getSelected")){var n=this.$htContainer.handsontable("getInstance").getValue();n!==void 0&&this.setValue(n)}return t.editors.TextEditor.prototype.finishEditing.apply(this,arguments)};t.editors.HandsontableEditor=i;t.editors.registerEditor("handsontable",i)}(i),function(n){var t=n.editors.HandsontableEditor.prototype.extend(),i;t.prototype.init=function(){n.editors.HandsontableEditor.prototype.init.apply(this,arguments);this.query=null;this.choices=[]};t.prototype.createElements=function(){n.editors.HandsontableEditor.prototype.createElements.apply(this,arguments);this.$htContainer.addClass("autocompleteEditor")};t.prototype.bindEvents=function(){var t=this;this.$textarea.on("keydown.autocompleteEditor",function(i){n.helper.isMetaKey(i.keyCode)&&[n.helper.keyCode.BACKSPACE,n.helper.keyCode.DELETE].indexOf(i.keyCode)==-1?i.keyCode==n.helper.keyCode.ENTER&&t.cellProperties.strict!==!0&&t.$htContainer.handsontable("deselectCell"):setTimeout(function(){t.queryChoices(t.$textarea.val())})});this.$htContainer.on("mouseleave",function(){t.cellProperties.strict===!0&&t.highlightBestMatchingChoice()});this.$htContainer.on("mouseenter",function(){t.$htContainer.handsontable("deselectCell")});n.editors.HandsontableEditor.prototype.bindEvents.apply(this,arguments)};t.prototype.open=function(){n.editors.HandsontableEditor.prototype.open.apply(this,arguments);this.$textarea[0].style.visibility="visible";this.focus();var t=this.$htContainer.handsontable("getInstance"),r=this;t.updateSettings({colWidths:[this.wtDom.outerWidth(this.TEXTAREA)-2],afterRenderer:function(n,t,i,u,f){var s=this.getCellMeta(t,i).filteringCaseSensitive===!0,o=s?f.indexOf(this.query):f.toLowerCase().indexOf(r.query.toLowerCase()),e;o!=-1&&(e=f.substr(o,r.query.length),n.innerHTML=f.replace(e,"<strong>"+e+"<\/strong>"))}});i=function(t){var i=this;t.keyCode==n.helper.keyCode.ARROW_UP&&i.getSelected()&&i.getSelected()[0]==0&&(parent.cellProperties.strict||i.deselectCell(),parent.instance.listen(),parent.focus(),t.preventDefault(),t.stopImmediatePropagation())};t.addHook("beforeKeyDown",i);this.queryChoices(this.TEXTAREA.value)};t.prototype.close=function(){this.$htContainer.handsontable("getInstance").removeHook("beforeKeyDown",i);n.editors.HandsontableEditor.prototype.close.apply(this,arguments)};t.prototype.queryChoices=function(t){var r,i,u,f;this.query=t;typeof this.cellProperties.source=="function"?(r=this,this.cellProperties.source(t,function(n){r.updateChoicesList(n)})):n.helper.isArray(this.cellProperties.source)?(t&&this.cellProperties.filter!==!1?(u=this.cellProperties.filteringCaseSensitive===!0,f=t.toLowerCase(),i=this.cellProperties.source.filter(function(n){return u?n.indexOf(t)!=-1:n.toLowerCase().indexOf(f)!=-1})):i=this.cellProperties.source,this.updateChoicesList(i)):this.updateChoicesList([])};t.prototype.updateChoicesList=function(t){this.choices=t;this.$htContainer.handsontable("loadData",n.helper.pivot([t]));this.cellProperties.strict===!0&&this.highlightBestMatchingChoice();this.focus()};t.prototype.highlightBestMatchingChoice=function(){var n=this.findBestMatchingChoice();typeof n=="undefined"&&this.cellProperties.allowInvalid===!1&&(n=0);typeof n=="undefined"?this.$htContainer.handsontable("deselectCell"):this.$htContainer.handsontable("selectCell",n,0)};t.prototype.findBestMatchingChoice=function(){for(var n={},f=this.getValue().length,i,t,u,r=0,e=this.choices.length;r<e;r++)(i=this.choices[r],t=f>0?i.indexOf(this.getValue()):i===this.getValue()?0:-1,t!=-1)&&(u=i.length-t-f,(typeof n.indexOfValue=="undefined"||n.indexOfValue>t||n.indexOfValue==t&&n.charsLeft>u)&&(n.indexOfValue=t,n.charsLeft=u,n.index=r));return n.index};n.editors.AutocompleteEditor=t;n.editors.registerEditor("autocomplete",t)}(i),function(t){var i=t.editors.TextEditor.prototype.extend(),u=new r;i.prototype.createElements=function(){t.editors.TextEditor.prototype.createElements.apply(this,arguments);this.TEXTAREA=document.createElement("input");this.TEXTAREA.setAttribute("type","password");this.TEXTAREA.className="handsontableInput";this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;this.$textarea=n(this.TEXTAREA);u.empty(this.TEXTAREA_PARENT);this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)};t.editors.PasswordEditor=i;t.editors.registerEditor("password",i)}(i),function(n){var t=n.editors.BaseEditor.prototype.extend(),i;t.prototype.init=function(){this.select=document.createElement("SELECT");n.Dom.addClass(this.select,"htSelectEditor");this.select.style.display="none";this.instance.rootElement[0].appendChild(this.select)};t.prototype.prepare=function(){var t,i,r,u;n.editors.BaseEditor.prototype.prepare.apply(this,arguments);t=this.cellProperties.selectOptions;i=typeof t=="function"?this.prepareOptions(t(this.row,this.col,this.prop)):this.prepareOptions(t);n.Dom.empty(this.select);for(r in i)i.hasOwnProperty(r)&&(u=document.createElement("OPTION"),u.value=r,n.Dom.fastInnerHTML(u,i[r]),this.select.appendChild(u))};t.prototype.prepareOptions=function(t){var r={},i,u;if(n.helper.isArray(t))for(i=0,u=t.length;i<u;i++)r[t[i]]=t[i];else typeof t=="object"&&(r=t);return r};t.prototype.getValue=function(){return this.select.value};t.prototype.setValue=function(n){this.select.value=n};i=function(t){var f=this,u=f.getActiveEditor(),i,r;switch(t.keyCode){case n.helper.keyCode.ARROW_UP:i=u.select.find("option:selected").prev();i.length==1&&i.prop("selected",!0);t.stopImmediatePropagation();t.preventDefault();break;case n.helper.keyCode.ARROW_DOWN:r=u.select.find("option:selected").next();r.length==1&&r.prop("selected",!0);t.stopImmediatePropagation();t.preventDefault()}};t.prototype.open=function(){var u=n.Dom.outerWidth(this.TD),f=n.Dom.outerHeight(this.TD),t=n.Dom.offset(this.instance.rootElement[0]),r=n.Dom.offset(this.TD);this.select.style.height=f+"px";this.select.style.minWidth=u+"px";this.select.style.top=r.top-t.top+"px";this.select.style.left=r.left-t.left-2+"px";this.select.style.display="";this.instance.addHook("beforeKeyDown",i)};t.prototype.close=function(){this.select.style.display="none";this.instance.removeHook("beforeKeyDown",i)};t.prototype.focus=function(){this.select.focus()};n.editors.SelectEditor=t;n.editors.registerEditor("select",t)}(i),function(n){var t=n.editors.AutocompleteEditor.prototype.extend();t.prototype.prepare=function(){n.editors.AutocompleteEditor.prototype.prepare.apply(this,arguments);this.cellProperties.filter=!1;this.cellProperties.strict=!0};n.editors.DropdownEditor=t;n.editors.registerEditor("dropdown",t)}(i);i.NumericValidator=function(n,t){n===null&&(n="");t(/^-?\d*\.?\d*$/.test(n))};wt=function(n,t){var i=n,r=typeof i=="string"?i.toLowerCase():null;return function(n){for(var f=!1,u=0,e=n.length;u<e;u++)if(i===n[u]){f=!0;break}else if(r===n[u].toLowerCase()){f=!0;break}t(f)}};i.AutocompleteValidator=function(n,t){this.strict&&this.source?typeof this.source=="function"?this.source(n,wt(n,t)):wt(n,t)(this.source):t(!0)};i.AutocompleteCell={editor:i.editors.AutocompleteEditor,renderer:i.renderers.AutocompleteRenderer,validator:i.AutocompleteValidator};i.CheckboxCell={editor:i.editors.CheckboxEditor,renderer:i.renderers.CheckboxRenderer};i.TextCell={editor:i.editors.TextEditor,renderer:i.renderers.TextRenderer};i.NumericCell={editor:i.editors.TextEditor,renderer:i.renderers.NumericRenderer,validator:i.NumericValidator,dataType:"number"};i.DateCell={editor:i.editors.DateEditor,renderer:i.renderers.AutocompleteRenderer};i.HandsontableCell={editor:i.editors.HandsontableEditor,renderer:i.renderers.AutocompleteRenderer};i.PasswordCell={editor:i.editors.PasswordEditor,renderer:i.renderers.PasswordRenderer,copyable:!1};i.DropdownCell={editor:i.editors.DropdownEditor,renderer:i.renderers.AutocompleteRenderer,validator:i.AutocompleteValidator};i.cellTypes={text:i.TextCell,date:i.DateCell,numeric:i.NumericCell,checkbox:i.CheckboxCell,autocomplete:i.AutocompleteCell,handsontable:i.HandsontableCell,password:i.PasswordCell,dropdown:i.DropdownCell};i.cellLookup={validator:{numeric:i.NumericValidator,autocomplete:i.AutocompleteValidator}},function(n){function t(r){return this.filter(t.resizableFilterSelector).each(function(){new i(n(this),r)}),this}function i(i,r){this.clones||(this.config=n.extend({},t.defaults,r),this.el=i,this.nodeName=i[0].nodeName.toLowerCase(),this.previousScrollTop=null,r.maxWidth==="original"&&(r.maxWidth=i.width()),r.minWidth==="original"&&(r.minWidth=i.width()),r.maxHeight==="original"&&(r.maxHeight=i.height()),r.minHeight==="original"&&(r.minHeight=i.height()),this.nodeName==="textarea"&&i.css({resize:"none",overflowY:"none"}),i.data("AutoResizer",this),this.createClone(),this.injectClone(),this.bind())}t.defaults={onResize:function(){},animate:{duration:200,complete:function(){}},extraSpace:50,minHeight:"original",maxHeight:500,minWidth:"original",maxWidth:500};t.cloneCSSProperties=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","padding"];t.cloneCSSValues={position:"absolute",top:-9999,left:-9999,opacity:0,overflow:"hidden",overflowX:"hidden",overflowY:"hidden",border:"1px solid black",padding:"0.49em"};t.resizableFilterSelector="textarea,input:not(input[type]),input[type=text],input[type=password]";t.AutoResizer=i;n.fn.autoResize=t;i.prototype={bind:function(){var t=n.proxy(function(){return this.check(),!0},this);this.unbind();this.el.bind("keyup.autoResize",t).bind("change.autoResize",t);this.check(null,!0)},unbind:function(){this.el.unbind(".autoResize")},createClone:function(){var r=this.el,u=this,i=this.config;this.clones=n();(i.minHeight!=="original"||i.maxHeight!=="original")&&(this.hClone=r.clone().height("auto"),this.clones=this.clones.add(this.hClone));(i.minWidth!=="original"||i.maxWidth!=="original")&&(this.wClone=n("<div/>").width("auto").css({whiteSpace:"nowrap",float:"left"}),this.clones=this.clones.add(this.wClone));n.each(t.cloneCSSProperties,function(n,t){u.clones.css(t,r.css(t))});this.clones.removeAttr("name").removeAttr("id").attr("tabIndex",-1).css(t.cloneCSSValues).css("overflowY","scroll")},check:function(n,t){var i=this.config,o=this.wClone,e=this.hClone,r=this.el,s=r.val(),f;if(o){o.text(s);var h=o.outerWidth(),u=h+i.extraSpace>=i.minWidth?h+i.extraSpace:i.minWidth,c=r.width();u=Math.min(u,i.maxWidth);(u<c&&u>=i.minWidth||u>=i.minWidth&&u<=i.maxWidth)&&(i.onResize.call(r),r.scrollLeft(0),i.animate&&!t?r.stop(1,1).animate({width:u},i.animate):r.width(u))}if(e){if(u&&e.width(u),e.height(0).val(s).scrollTop(1e4),f=e[0].scrollTop+i.extraSpace,this.previousScrollTop===f)return;this.previousScrollTop=f;f>=i.maxHeight&&(f=i.maxHeight);f<i.minHeight&&(f=i.minHeight);f==i.maxHeight&&u==i.maxWidth?r.css("overflowY","scroll"):r.css("overflowY","hidden");i.onResize.call(r);i.animate&&!t?r.stop(1,1).animate({height:f},i.animate):r.height(f)}},destroy:function(){this.unbind();this.el.removeData("AutoResizer");this.clones.remove();delete this.el;delete this.hClone;delete this.wClone;delete this.clones},injectClone:function(){(t.cloneContainer||(t.cloneContainer=n("<arclones/>").appendTo("body"))).empty().append(this.clones)}}}(jQuery),function(n){function t(n){return n.split('"').length-1}n.SheetClip={parse:function(n){var r,c,i,u=[],f=0,e,h,o,s;for(i=n.split("\n"),i.length>1&&i[i.length-1]===""&&i.pop(),r=0,c=i.length;r<c;r+=1){for(i[r]=i[r].split("\t"),e=0,h=i[r].length;e<h;e+=1)u[f]||(u[f]=[]),o&&e===0?(s=u[f].length-1,u[f][s]=u[f][s]+"\n"+i[r][0],o&&t(i[r][0])&1&&(o=!1,u[f][s]=u[f][s].substring(0,u[f][s].length-1).replace(/""/g,'"'))):e===h-1&&i[r][e].indexOf('"')===0?(u[f].push(i[r][e].substring(1).replace(/""/g,'"')),o=!0):(u[f].push(i[r][e].replace(/""/g,'"')),o=!1);o||(f+=1)}return u},stringify:function(n){for(var r,e,u="",t,i=0,f=n.length;i<f;i+=1){for(r=0,e=n[i].length;r<e;r+=1)r>0&&(u+="\t"),t=n[i][r],u+=typeof t=="string"?t.indexOf("\n")>-1?'"'+t.replace(/"/g,'""')+'"':t:t===null||t===void 0?"":t;u+="\n"}return u}}}(t);ti=function(){var n;return{getInstance:function(){return n?n.hasBeenDestroyed()&&n.init():n=new o,n.refCounter++,n}}}();o.prototype.init=function(){var t=this,n,i;if(this.copyCallbacks=[],this.cutCallbacks=[],this.pasteCallbacks=[],this.listenerElement=document.documentElement,i=document.body,document.getElementById("CopyPasteDiv"))this.elDiv=document.getElementById("CopyPasteDiv"),this.elTextarea=this.elDiv.firstChild;else if(this.elDiv=document.createElement("DIV"),this.elDiv.id="CopyPasteDiv",n=this.elDiv.style,n.position="fixed",n.top="-10000px",n.left="-10000px",i.appendChild(this.elDiv),this.elTextarea=document.createElement("TEXTAREA"),this.elTextarea.className="copyPaste",n=this.elTextarea.style,n.width="10000px",n.height="10000px",n.overflow="hidden",this.elDiv.appendChild(this.elTextarea),typeof n.opacity!="undefined")n.opacity=0;else/*@cc_on@if(@_jscript)typeof n.filter=="string"&&(n.filter="alpha(opacity=0)");@end@*/this.keydownListener=function(n){var i=!1;if(n.metaKey?i=!0:n.ctrlKey&&navigator.userAgent.indexOf("Mac")===-1&&(i=!0),i){if(document.activeElement!==t.elTextarea&&(t.getSelectionText()!=""||["INPUT","SELECT","TEXTAREA"].indexOf(document.activeElement.nodeName)!=-1))return;t.selectNodeText(t.elTextarea);setTimeout(function(){t.selectNodeText(t.elTextarea)},0)}i&&(n.keyCode===67||n.keyCode===86||n.keyCode===88)&&(n.keyCode===88?setTimeout(function(){t.triggerCut(n)},0):n.keyCode===86&&setTimeout(function(){t.triggerPaste(n)},0))};this._bindEvent(this.listenerElement,"keydown",this.keydownListener)};o.prototype.selectNodeText=function(n){n.select()};o.prototype.getSelectionText=function(){var n="";return t.getSelection?n=t.getSelection().toString():document.selection&&document.selection.type!="Control"&&(n=document.selection.createRange().text),n};o.prototype.copyable=function(n){if(typeof n!="string"&&n.toString===void 0)throw new Error("copyable requires string parameter");this.elTextarea.value=n};o.prototype.onCut=function(n){this.cutCallbacks.push(n)};o.prototype.onPaste=function(n){this.pasteCallbacks.push(n)};o.prototype.removeCallback=function(n){for(var t=0,i=this.copyCallbacks.length;t<i;t++)if(this.copyCallbacks[t]===n)return this.copyCallbacks.splice(t,1),!0;for(t=0,i=this.cutCallbacks.length;t<i;t++)if(this.cutCallbacks[t]===n)return this.cutCallbacks.splice(t,1),!0;for(t=0,i=this.pasteCallbacks.length;t<i;t++)if(this.pasteCallbacks[t]===n)return this.pasteCallbacks.splice(t,1),!0;return!1};o.prototype.triggerCut=function(n){var t=this;t.cutCallbacks&&setTimeout(function(){for(var i=0,r=t.cutCallbacks.length;i<r;i++)t.cutCallbacks[i](n)},50)};o.prototype.triggerPaste=function(n,t){var i=this;i.pasteCallbacks&&setTimeout(function(){for(var u=(t||i.elTextarea.value).replace(/\n$/,""),r=0,f=i.pasteCallbacks.length;r<f;r++)i.pasteCallbacks[r](u,n)},50)};o.prototype.destroy=function(){this.hasBeenDestroyed()||--this.refCounter!=0||(this.elDiv&&this.elDiv.parentNode&&this.elDiv.parentNode.removeChild(this.elDiv),this._unbindEvent(this.listenerElement,"keydown",this.keydownListener))};o.prototype.hasBeenDestroyed=function(){return!this.refCounter};o.prototype._bindEvent=function(){return t.jQuery?function(t,i,r){n(t).on(i+".copypaste",r)}:function(n,t,i){n.addEventListener(t,i,!1)}}();o.prototype._unbindEvent=function(){return t.jQuery?function(t,i,r){n(t).off(i+".copypaste",r)}:function(n,t,i){n.removeEventListener(t,i,!1)}}(),function(n){function i(n){return n.indexOf("/")===-1&&n.indexOf("~")===-1?n:n.replace(/~/g,"~0").replace(/\//g,"~1")}function l(n,t){var u;for(var r in n)if(n.hasOwnProperty(r)){if(n[r]===t)return i(r)+"/";if(typeof n[r]=="object"&&(u=l(n[r],t),u!=""))return i(r)+"/"+u}return""}function k(n,t){if(n===t)return"/";var i=l(n,t);if(i==="")throw new Error("Object not found in root");return"/"+i}function y(n){for(var t=0,i=r.length;t<i;t++)if(r[t].obj===n)return r[t]}function d(n,t){for(var i=0,r=n.observers.length;i<r;i++)if(n.observers[i].callback===t)return n.observers[i].observer}function g(n,t){for(var i=0,r=n.observers.length;i<r;i++)if(n.observers[i].observer===t){n.observers.splice(i,1);return}}function nt(n,t){s(t);Object.observe?o(t,n):clearTimeout(t.next);var i=y(n);g(i,t)}function tt(n,i){var f=[],tt=n,u,h=y(n);if(h?u=d(h,i):(h=new a(n),r.push(h)),u)return u;if(Object.observe)u=function(t){var r,h,s;for(o(u,n),e(u,n),r=0,h=t.length;r<h;){if(!(t[r].name==="length"&&c(t[r].object))&&!(t[r].name==="__Jasmine_been_here_before__")){s=t[r].type;switch(s){case"new":s="add";break;case"deleted":s="delete";break;case"updated":s="update"}b[s].call(t[r],f,k(tt,t[r].object))}r++}f&&i&&i(f);u.patches=f;f=[]};else if(u={},h.value=JSON.parse(JSON.stringify(n)),i){u.callback=i;u.next=null;var w=this.intervals||[100,1e3,1e4,6e4],l=0,nt=function(){s(u)},p=function(){clearTimeout(u.next);u.next=setTimeout(function(){nt();l=0;u.next=setTimeout(g,w[l++])},0)},g=function(){nt();l==w.length&&(l=w.length-1);u.next=setTimeout(g,w[l++])};typeof t!="undefined"&&(t.addEventListener?(t.addEventListener("mousedown",p),t.addEventListener("mouseup",p),t.addEventListener("keydown",p)):(t.attachEvent("onmousedown",p),t.attachEvent("onmouseup",p),t.attachEvent("onkeydown",p)));u.next=setTimeout(g,w[l++])}return u.patches=f,u.object=n,h.observers.push(new v(i,u)),e(u,n)}function e(n,t){var r,i;if(Object.observe){Object.observe(t,n);for(r in t)t.hasOwnProperty(r)&&(i=t[r],i&&typeof i=="object"&&e(n,i))}return n}function o(n,t){var r,i;if(Object.observe){Object.unobserve(t,n);for(r in t)t.hasOwnProperty(r)&&(i=t[r],i&&typeof i=="object"&&o(n,i))}return n}function s(n){var u,t,f,i;if(Object.observe)Object.deliverChangeRecords(n);else{for(t=0,f=r.length;t<f;t++)if(r[t].obj===n.object){u=r[t];break}p(u.value,n.object,n.patches,"")}return i=n.patches,i.length>0&&(n.patches=[],n.callback&&n.callback(i)),i}function p(n,t,r,u){for(var s,o,f,c=h(t),l=h(n),v=!1,a=!1,e=l.length-1;e>=0;e--)f=l[e],s=n[f],t.hasOwnProperty(f)?(o=t[f],s instanceof Object?p(s,o,r,u+"/"+i(f)):s!=o&&(v=!0,r.push({op:"replace",path:u+"/"+i(f),value:o}),n[f]=o)):(r.push({op:"remove",path:u+"/"+i(f)}),delete n[f],a=!0);if(a||c.length!=l.length)for(e=0;e<c.length;e++)f=c[e],n.hasOwnProperty(f)||(r.push({op:"add",path:u+"/"+i(f),value:t[f]}),n[f]=JSON.parse(JSON.stringify(t[f])))}function u(n,t){for(var o=!1,s=0,v=t.length,r,l,e;s<v;){r=t[s];for(var h=r.path.split("/"),i=n,u=1,a=h.length;;)if(c(i)){if(l=parseInt(h[u],10),u++,u>=a){o=w[r.op].call(r,i,l,n);break}i=i[l]}else{if(e=h[u],e.indexOf("~")!=-1&&(e=e.replace(/~1/g,"/").replace(/~0/g,"~")),u++,u>=a){o=f[r.op].call(r,i,e,n);break}i=i[e]}s++}return o}var f={add:function(n,t){return n[t]=this.value,!0},remove:function(n,t){return delete n[t],!0},replace:function(n,t){return n[t]=this.value,!0},move:function(n,t,i){var r={op:"_get",path:this.from};return u(i,[r]),u(i,[{op:"remove",path:this.from}]),u(i,[{op:"add",path:this.path,value:r.value}]),!0},copy:function(n,t,i){var r={op:"_get",path:this.from};return u(i,[r]),u(i,[{op:"add",path:this.path,value:r.value}]),!0},test:function(n,t){return JSON.stringify(n[t])===JSON.stringify(this.value)},_get:function(n,t){this.value=n[t]}},w={add:function(n,t){return n.splice(t,0,this.value),!0},remove:function(n,t){return n.splice(t,1),!0},replace:function(n,t){return n[t]=this.value,!0},move:f.move,copy:f.copy,test:f.test,_get:f._get},b={add:function(n,t){var r={op:"add",path:t+i(this.name),value:this.object[this.name]};n.push(r)},"delete":function(n,t){var r={op:"remove",path:t+i(this.name)};n.push(r)},update:function(n,t){var r={op:"replace",path:t+i(this.name),value:this.object[this.name]};n.push(r)}},r=[],a,v,h,c;n.intervals;a=function(){function n(n){this.observers=[];this.obj=n}return n}();v=function(){function n(n,t){this.callback=n;this.observer=t}return n}();n.unobserve=nt;n.observe=tt;n.generate=s;h=Object.keys?Object.keys:function(n){var t=[];for(var i in n)n.hasOwnProperty(i)&&t.push(i);return t};c=Array.isArray?Array.isArray:function(n){return n.push&&typeof n.length=="number"};n.apply=u}(p||(p={}));typeof exports!="undefined"&&(exports.apply=p.apply,exports.observe=p.observe,exports.unobserve=p.unobserve,exports.generate=p.generate);i.PluginHookClass=function(){function t(){this.hooks=r();this.legacy=n}var r=function(){return{beforeInitWalkontable:[],beforeInit:[],beforeRender:[],beforeChange:[],beforeRemoveCol:[],beforeRemoveRow:[],beforeValidate:[],beforeGet:[],beforeSet:[],beforeGetCellMeta:[],beforeAutofill:[],beforeKeyDown:[],beforeColumnSort:[],afterInit:[],afterLoadData:[],afterUpdateSettings:[],afterRender:[],afterRenderer:[],afterChange:[],afterValidate:[],afterGetCellMeta:[],afterGetColHeader:[],afterGetColWidth:[],afterDestroy:[],afterRemoveRow:[],afterCreateRow:[],afterRemoveCol:[],afterCreateCol:[],afterColumnResize:[],afterColumnMove:[],afterColumnSort:[],afterDeselect:[],afterSelection:[],afterSelectionByProp:[],afterSelectionEnd:[],afterSelectionEndByProp:[],afterCopyLimit:[],afterOnCellMouseDown:[],afterOnCellMouseOver:[],afterOnCellCornerMouseDown:[],afterScrollVertically:[],afterScrollHorizontally:[],modifyCol:[]}},n={onBeforeChange:"beforeChange",onChange:"afterChange",onCreateRow:"afterCreateRow",onCreateCol:"afterCreateCol",onSelection:"afterSelection",onCopyLimit:"afterCopyLimit",onSelectionEnd:"afterSelectionEnd",onSelectionByProp:"afterSelectionByProp",onSelectionEndByProp:"afterSelectionEndByProp"};return t.prototype.add=function(t,r){if(i.helper.isArray(r))for(var u=0,f=r.length;u<f;u++)this.add(t,r[u]);else t in n&&(t=n[t]),typeof this.hooks[t]=="undefined"&&(this.hooks[t]=[]),this.hooks[t].indexOf(r)==-1&&this.hooks[t].push(r);return this},t.prototype.once=function(n,t){if(i.helper.isArray(t))for(var r=0,u=t.length;r<u;r++)t[r].runOnce=!0,this.add(n,t[r]);else t.runOnce=!0,this.add(n,t)},t.prototype.remove=function(t,i){var u=!1,r,f;if(t in n&&(t=n[t]),typeof this.hooks[t]!="undefined")for(r=0,f=this.hooks[t].length;r<f;r++)if(this.hooks[t][r]==i){delete this.hooks[t][r].runOnce;this.hooks[t].splice(r,1);u=!0;break}return u},t.prototype.run=function(t,i,r,u,f,e,o){var h,s,c;if(i in n&&(i=n[i]),typeof this.hooks[i]!="undefined")for(h=Array.prototype.slice.call(this.hooks[i]),s=0,c=h.length;s<c;s++)h[s].call(t,r,u,f,e,o),h[s].runOnce&&this.remove(i,h[s])},t.prototype.execute=function(t,i,r,u,f,e,o){var c,h,s,l;if(i in n&&(i=n[i]),typeof this.hooks[i]!="undefined")for(h=Array.prototype.slice.call(this.hooks[i]),s=0,l=h.length;s<l;s++)if(c=h[s].call(t,r,u,f,e,o),c!==void 0&&(r=c),h[s].runOnce&&this.remove(i,h[s]),c===!1)return!1;return r},t}();i.PluginHooks=new i.PluginHookClass,function(n){function i(){function u(n){var i=document,t=this;t.table=i.createElement("table");t.theadTh=i.createElement("th");t.table.appendChild(i.createElement("thead")).appendChild(i.createElement("tr")).appendChild(t.theadTh);t.tableStyle=t.table.style;t.tableStyle.tableLayout="auto";t.tableStyle.width="auto";t.tbody=i.createElement("tbody");t.table.appendChild(t.tbody);t.container=i.createElement("div");t.container.className=n.rootElement[0].className+" hidden";t.containerStyle=t.container.style;t.container.appendChild(t.table)}var i=this,r=5;this.beforeInit=function(){var n=this;n.autoColumnWidths=[];n.getSettings().autoColumnSize!==!1?n.autoColumnSizeTmp||(n.autoColumnSizeTmp={table:null,tableStyle:null,theadTh:null,tbody:null,container:null,containerStyle:null,determineBeforeNextRender:!0},n.addHook("beforeRender",t.determineIfChanged),n.addHook("afterGetColWidth",t.getColWidth),n.addHook("afterDestroy",t.afterDestroy),n.determineColumnWidth=i.determineColumnWidth):n.autoColumnSizeTmp&&(n.removeHook("beforeRender",t.determineIfChanged),n.removeHook("afterGetColWidth",t.getColWidth),n.removeHook("afterDestroy",t.afterDestroy),delete n.determineColumnWidth,i.afterDestroy.call(n))};this.determineIfChanged=function(n){n&&t.determineColumnsWidth.apply(this,arguments)};this.determineColumnWidth=function(t){var i=this,f=i.autoColumnSizeTmp,s,y,o,p,h,c,d,a,l,w,v,b;f.container||u.call(f,i);f.container.className=i.rootElement[0].className+" htAutoColumnSize";f.table.className=i.$table[0].className;var tt=i.countRows(),e={},k=0;for(s=0;s<tt;s++)y=n.helper.stringify(i.getDataAtCell(s,t)),o=y.length,o>k&&(k=o),e[o]||(e[o]={needed:r,strings:[]}),e[o].needed&&(e[o].strings.push({value:y,row:s}),e[o].needed--);p=i.getSettings();p.colHeaders&&i.view.appendColHeader(t,f.theadTh);i.view.wt.wtDom.empty(f.tbody);for(h in e)if(e.hasOwnProperty(h))for(c=0,d=e[h].strings.length;c<d;c++){a=e[h].strings[c].row;l=i.getCellMeta(a,t);l.col=t;l.row=a;var it=i.getCellRenderer(l),g=document.createElement("tr"),nt=document.createElement("td");it(i,nt,a,t,i.colToProp(t),e[h].strings[c].value,l);s++;g.appendChild(nt);f.tbody.appendChild(g)}return w=i.rootElement[0].parentNode,w.appendChild(f.container),v=i.view.wt.wtDom.outerWidth(f.table),w.removeChild(f.container),p.nativeScrollbars||(b=i.view.wt.wtViewport.getViewportWidth()-2,v>b&&(v=b)),v};this.determineColumnsWidth=function(){var t=this,r=this.getSettings(),u,n;if(r.autoColumnSize||!r.colWidths)for(u=this.countCols(),n=0;n<u;n++)t._getColWidthFromSettings(n)||(this.autoColumnWidths[n]=i.determineColumnWidth.call(t,n))};this.getColWidth=function(n,t){this.autoColumnWidths[n]&&this.autoColumnWidths[n]>t.width&&(t.width=this.autoColumnWidths[n])};this.afterDestroy=function(){var n=this;n.autoColumnSizeTmp&&n.autoColumnSizeTmp.container&&n.autoColumnSizeTmp.container.parentNode&&n.autoColumnSizeTmp.container.parentNode.removeChild(n.autoColumnSizeTmp.container);n.autoColumnSizeTmp=null}}var t=new i;n.PluginHooks.add("beforeInit",t.beforeInit);n.PluginHooks.add("afterUpdateSettings",t.beforeInit)}(i);g=new ui;i.PluginHooks.add("afterInit",function(){g.init.call(this,"afterInit")});i.PluginHooks.add("afterUpdateSettings",function(){g.init.call(this,"afterUpdateSettings")});i.PluginHooks.add("beforeGet",g.onBeforeGetSet);i.PluginHooks.add("beforeSet",g.onBeforeGetSet);i.PluginHooks.add("afterGetColHeader",g.getColHeader),function(t){function i(r,u){function e(){var i=n("body > .htContextMenu")[0];return i||(i=document.createElement("DIV"),t.Dom.addClass(i,"htContextMenu"),document.getElementsByTagName("body")[0].appendChild(i)),i}this.instance=r;var f=this;this.menu=e();this.enabled=!0;this.bindMouseEvents();this.bindTableEvents();this.instance.addHook("afterDestroy",function(){f.destroy()});this.defaultOptions={items:{row_above:{name:"Insert row above",callback:function(n,t){this.alter("insert_row",t.start.row())},disabled:function(){return this.countRows()>=this.getSettings().maxRows}},row_below:{name:"Insert row below",callback:function(n,t){this.alter("insert_row",t.end.row()+1)},disabled:function(){return this.countRows()>=this.getSettings().maxRows}},hsep1:i.SEPARATOR,col_left:{name:"Insert column on the left",callback:function(n,t){this.alter("insert_col",t.start.col())},disabled:function(){return this.countCols()>=this.getSettings().maxCols}},col_right:{name:"Insert column on the right",callback:function(n,t){this.alter("insert_col",t.end.col()+1)},disabled:function(){return this.countCols()>=this.getSettings().maxCols}},hsep2:i.SEPARATOR,remove_row:{name:"Remove row",callback:function(n,t){var i=t.end.row()-t.start.row()+1;this.alter("remove_row",t.start.row(),i)}},remove_col:{name:"Remove column",callback:function(n,t){var i=t.end.col()-t.start.col()+1;this.alter("remove_col",t.start.col(),i)}},hsep3:i.SEPARATOR,undo:{name:"Undo",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}},redo:{name:"Redo",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}}}};this.options={};t.helper.extend(this.options,this.defaultOptions);this.updateOptions(u)}function r(){var n=this,r=n.getSettings().contextMenu,u=t.helper.isObject(r)?r:{};r?(n.contextMenu||(n.contextMenu=new i(n,u)),n.contextMenu.enable(),t.helper.isArray(r)&&n.contextMenu.filterItems(r)):n.contextMenu&&(n.contextMenu.destroy(),delete n.contextMenu)}i.prototype.bindMouseEvents=function(){function r(r){if(r.preventDefault(),r.target.nodeName=="TD"||t.Dom.hasClass(r.target,"current")&&t.Dom.hasClass(r.target,"wtBorder")){this.show(r.pageY,r.pageX);n(document).on("mousedown.htContextMenu",t.helper.proxy(i.prototype.close,this))}}this.instance.rootElement.on("contextmenu.htContextMenu",t.helper.proxy(r,this))};i.prototype.bindTableEvents=function(){var n=this;this._afterScrollCallback=function(){n.close()};this.instance.addHook("afterScrollVertically",this._afterScrollCallback);this.instance.addHook("afterScrollHorizontally",this._afterScrollCallback)};i.prototype.unbindTableEvents=function(){var n=this;this._afterScrollCallback&&(this.instance.removeHook("afterScrollVertically",this._afterScrollCallback),this.instance.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)};i.prototype.performAction=function(){var r=n(this.menu).handsontable("getInstance"),e=r.getSelected()[0],t=r.getData()[e],u,f;t.disabled!==!0&&(typeof t.disabled!="function"||t.disabled.call(this.instance)!==!0)&&typeof t.callback=="function"&&(u=this.instance.getSelected(),f=i.utils.normalizeSelection(u),t.callback.call(this.instance,t.key,f))};i.prototype.unbindMouseEvents=function(){this.instance.rootElement.off("contextmenu.htContextMenu");n(document).off("mousedown.htContextMenu")};i.prototype.show=function(r,u){this.menu.style.display="block";n(this.menu).off("mousedown.htContextMenu").on("mousedown.htContextMenu",t.helper.proxy(this.performAction,this));n(this.menu).handsontable({data:i.utils.convertItemsToArray(this.getItems()),colHeaders:!1,colWidths:[160],readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:t.helper.proxy(this.renderer,this)}],beforeKeyDown:t.helper.proxy(this.onBeforeKeyDown,this)});this.bindTableEvents();this.setMenuPosition(r,u);n(this.menu).handsontable("listen")};i.prototype.close=function(){this.hide();n(document).off("mousedown.htContextMenu");this.unbindTableEvents();this.instance.listen()};i.prototype.hide=function(){this.menu.style.display="none";n(this.menu).handsontable("destroy")};i.prototype.renderer=function(r,u,f,e,o,s){function a(n){return new RegExp(i.SEPARATOR,"i").test(n.name)}function v(n){return n.disabled===!0||typeof n.disabled=="function"&&n.disabled.call(c.instance)===!0}var c=this,l=r.getData()[f],h=document.createElement("DIV");if(t.Dom.empty(u),u.appendChild(h),a(l)?t.Dom.addClass(u,"htSeparator"):t.Dom.fastInnerText(h,s),v(l,c.instance)){t.Dom.addClass(u,"htDisabled");n(h).on("mouseenter",function(){r.deselectCell()})}else{t.Dom.removeClass(u,"htDisabled");n(h).on("mouseenter",function(){r.selectCell(f,e)})}};i.prototype.onBeforeKeyDown=function(r){function h(n){var t=n.getCell(0,0);i.utils.isSeparator(t)||i.utils.isDisabled(t)?o(0,0,n):n.selectCell(0,0)}function c(n){var t=n.countRows()-1,r=n.getCell(t,0);i.utils.isSeparator(r)||i.utils.isDisabled(r)?s(t,0,n):n.selectCell(t,0)}function o(n,t,r){var u=n+1,f=u<r.countRows()?r.getCell(u,t):null;f&&(i.utils.isSeparator(f)||i.utils.isDisabled(f)?o(u,t,r):r.selectCell(u,t))}function s(n,t,r){var u=n-1,f=u>=0?r.getCell(u,t):null;f&&(i.utils.isSeparator(f)||i.utils.isDisabled(f)?s(u,t,r):r.selectCell(u,t))}var e=this,u=n(e.menu).handsontable("getInstance"),f=u.getSelected();switch(r.keyCode){case t.helper.keyCode.ESCAPE:e.close();r.preventDefault();r.stopImmediatePropagation();break;case t.helper.keyCode.ENTER:u.getSelected()&&(e.performAction(),e.close());break;case t.helper.keyCode.ARROW_DOWN:f?o(f[0],f[1],u):h(u);r.preventDefault();r.stopImmediatePropagation();break;case t.helper.keyCode.ARROW_UP:f?s(f[0],f[1],u):c(u);r.preventDefault();r.stopImmediatePropagation()}};i.prototype.getItems=function(){function r(n){typeof n=="string"?this.name=n:t.helper.extend(this,n)}var i={},n;r.prototype=this.options;for(n in this.options.items)this.options.items.hasOwnProperty(n)&&(!this.itemsFilter||this.itemsFilter.indexOf(n)!=-1)&&(i[n]=new r(this.options.items[n]));return i};i.prototype.updateOptions=function(n){var i,r;if(n=n||{},n.items)for(i in n.items)r={},n.items.hasOwnProperty(i)&&this.defaultOptions.items.hasOwnProperty(i)&&t.helper.isObject(n.items[i])&&(t.helper.extend(r,this.defaultOptions.items[i]),t.helper.extend(r,n.items[i]),n.items[i]=r);t.helper.extend(this.options,n)};i.prototype.setMenuPosition=function(n,t){var i={top:n,topRelative:n-document.documentElement.scrollTop,left:t,leftRelative:t-document.documentElement.scrollLeft};this.menuFitsBelowCursor(i)?this.positionMenuBelowCursor(i):this.positionMenuAboveCursor(i);this.menuFitsOnRightOfCursor(i)?this.positionMenuOnRightOfCursor(i):this.positionMenuOnLeftOfCursor(i)};i.prototype.menuFitsBelowCursor=function(n){return n.topRelative+this.menu.offsetHeight<=document.documentElement.scrollTop+document.documentElement.clientHeight};i.prototype.menuFitsOnRightOfCursor=function(n){return n.leftRelative+this.menu.offsetWidth<=document.documentElement.scrollLeft+document.documentElement.clientWidth};i.prototype.positionMenuBelowCursor=function(n){this.menu.style.top=n.top+"px"};i.prototype.positionMenuAboveCursor=function(n){this.menu.style.top=n.top-this.menu.offsetHeight+"px"};i.prototype.positionMenuOnRightOfCursor=function(n){this.menu.style.left=n.left+"px"};i.prototype.positionMenuOnLeftOfCursor=function(n){this.menu.style.left=n.left-this.menu.offsetWidth+"px"};i.utils={};i.utils.convertItemsToArray=function(n){var r=[],i;for(var t in n)if(n.hasOwnProperty(t)){if(typeof n[t]=="string")i={name:n[t]};else if(n[t].visible!==!1)i=n[t];else continue;i.key=t;r.push(i)}return r};i.utils.normalizeSelection=function(n){var i={start:new t.SelectionPoint,end:new t.SelectionPoint};return i.start.row(Math.min(n[0],n[2])),i.start.col(Math.min(n[1],n[3])),i.end.row(Math.max(n[0],n[2])),i.end.col(Math.max(n[1],n[3])),i};i.utils.isSeparator=function(n){return t.Dom.hasClass(n,"htSeparator")};i.utils.isDisabled=function(n){return t.Dom.hasClass(n,"htDisabled")};i.prototype.enable=function(){this.enabled||(this.enabled=!0,this.bindMouseEvents())};i.prototype.disable=function(){this.enabled&&(this.enabled=!1,this.close(),this.unbindMouseEvents(),this.unbindTableEvents())};i.prototype.destroy=function(){this.close();this.unbindMouseEvents();this.unbindTableEvents();this.isMenuEnabledByOtherHotInstance()||this.removeMenu()};i.prototype.isMenuEnabledByOtherHotInstance=function(){for(var i,r=n(".handsontable"),u=!1,t=0,f=r.length;t<f;t++)if(i=n(r[t]).handsontable("getInstance"),i&&i.getSettings().contextMenu){u=!0;break}return u};i.prototype.removeMenu=function(){this.menu.parentNode&&this.menu.parentNode.removeChild(this.menu)};i.prototype.filterItems=function(n){this.itemsFilter=n};i.SEPARATOR="---------";t.PluginHooks.add("afterInit",r);t.PluginHooks.add("afterUpdateSettings",r);t.ContextMenu=i}(i);i.PluginHooks.add("beforeGetCellMeta",function(n,t,i){if(i.isWritable=!i.readOnly,i.autoComplete)throw new Error("Support for legacy autocomplete syntax was removed in Handsontable 0.10.0. Please remove the property named 'autoComplete' from your config. For replacement instructions, see wiki page https://github.com/warpech/jquery-handsontable/wiki/Migration-guide-to-0.10.x");});nt=new fi;i.PluginHooks.add("beforeInit",nt.beforeInit);i.PluginHooks.add("afterInit",function(){nt.init.call(this,"afterInit")});i.PluginHooks.add("afterUpdateSettings",function(){nt.init.call(this,"afterUpdateSettings")});i.PluginHooks.add("afterGetColHeader",nt.getColHeader);i.PluginHooks.add("modifyCol",nt.modifyCol);ut=new ei;i.PluginHooks.add("beforeInit",ut.beforeInit);i.PluginHooks.add("afterInit",function(){ut.init.call(this,"afterInit")});i.PluginHooks.add("afterUpdateSettings",function(){ut.init.call(this,"afterUpdateSettings")});i.PluginHooks.add("afterGetColWidth",ut.getColWidth),function(){function r(){var n=this,i=n.getSettings().observeChanges;i?(n.observer&&t.call(n),u.call(n),o.call(n)):i||t.call(n)}function u(){var n=this;n.observeChangesActive=!0;n.pauseObservingChanges=function(){n.observeChangesActive=!1};n.resumeObservingChanges=function(){n.observeChangesActive=!0};n.observedData=n.getData();n.observer=p.observe(n.observedData,function(t){n.observeChangesActive&&(f.call(n,t),n.render());n.runHooks("afterChangesObserved")})}function f(n){function s(n){var t;return t=c(n),h(t)}function h(n){var t=[];return n.filter(function(n){var i=e(n.path);if(["add","remove"].indexOf(n.op)!=-1&&!isNaN(i.col)){if(t.indexOf(i.col)!=-1)return!1;t.push(i.col)}return!0})}function c(n){return n.filter(function(n){return!/[/]length/ig.test(n.path)})}function e(n){var t=n.match(/^\/(\d+)\/?(.*)?$/);return{row:parseInt(t[1],10),col:/^\d*$/.test(t[2])?parseInt(t[2],10):t[2]}}for(var r,t,i=this,f=s(n),u=0,o=f.length;u<o;u++){r=f[u];t=e(r.path);switch(r.op){case"add":isNaN(t.col)?i.runHooks("afterCreateRow",t.row):i.runHooks("afterCreateCol",t.col);break;case"remove":isNaN(t.col)?i.runHooks("afterRemoveRow",t.row,1):i.runHooks("afterRemoveCol",t.col,1);break;case"replace":i.runHooks("afterChange",[t.row,t.col,null,r.value],"external")}}}function t(){var n=this;n.observer&&(e.call(n),s.call(n))}function e(){var n=this;p.unobserve(n.observedData,n.observer);delete n.observeChangesActive;delete n.pauseObservingChanges;delete n.resumeObservingChanges}function o(){var i=this;i.addHook("afterDestroy",t);i.addHook("afterCreateRow",n);i.addHook("afterRemoveRow",n);i.addHook("afterCreateCol",n);i.addHook("afterRemoveCol",n);i.addHook("afterChange",function(t,i){i!="loadData"&&n.call(this)})}function s(){var i=this;i.removeHook("afterDestroy",t);i.removeHook("afterCreateRow",n);i.removeHook("afterRemoveRow",n);i.removeHook("afterCreateCol",n);i.removeHook("afterRemoveCol",n);i.removeHook("afterChange",n)}function n(){var n=this;n.pauseObservingChanges();n.addHookOnce("afterChangesObserved",function(){n.resumeObservingChanges()})}i.PluginHooks.add("afterLoadData",r);i.PluginHooks.add("afterUpdateSettings",r)}(),function(n){function r(){function u(){var i=this;for(var n in t)t.hasOwnProperty(n)&&!r.call(i,n)&&i.PluginHooks.add(n,t[n])}function f(){var i=this;for(var n in t)t.hasOwnProperty(n)&&r.call(i,n)&&i.PluginHooks.remove(n,t[n])}function r(n){var t=this;return t.PluginHooks.hooks.hasOwnProperty(n)}var i=this,t;this.init=function(){var t=this,r=t.getSettings().persistentState;if(i.enabled=!!r,!i.enabled){f.call(t);return}t.storage||(t.storage=new n(t.rootElement[0].id));t.resetState=i.resetValue;u.call(t)};this.saveValue=function(n,t){var i=this;i.storage.saveValue(n,t)};this.loadValue=function(n,t){var i=this;t.value=i.storage.loadValue(n)};this.resetValue=function(n){var t=this;typeof n!="undefined"?t.storage.reset(n):t.storage.resetAll()};t={persistentStateSave:i.saveValue,persistentStateLoad:i.loadValue,persistentStateReset:i.resetValue}}var t=new r;i.PluginHooks.add("beforeInit",t.init);i.PluginHooks.add("afterUpdateSettings",t.init)}(oi),function(t){t.UndoRedo=function(n){var i=this;this.instance=n;this.doneActions=[];this.undoneActions=[];this.ignoreNewActions=!1;n.addHook("afterChange",function(n){if(n){var r=new t.UndoRedo.ChangeAction(n);i.done(r)}});n.addHook("afterCreateRow",function(n,r,u){if(!u){var f=new t.UndoRedo.CreateRowAction(n,r);i.done(f)}});n.addHook("beforeRemoveRow",function(n,r){var u=i.instance.getData(),f,e;n=(u.length+n)%u.length;f=u.slice(n,n+r);e=new t.UndoRedo.RemoveRowAction(n,f);i.done(e)});n.addHook("afterCreateCol",function(n,r,u){if(!u){var f=new t.UndoRedo.CreateColumnAction(n,r);i.done(f)}});n.addHook("beforeRemoveCol",function(r,u){var o=i.instance.getData(),e,f,s,h,c;for(r=(i.instance.countCols()+r)%i.instance.countCols(),e=[],f=0,s=o.length;f<s;f++)e[f]=o[f].slice(r,r+u);t.helper.isArray(n.getSettings().colHeaders)&&(h=n.getSettings().colHeaders.slice(r,r+e.length));c=new t.UndoRedo.RemoveColumnAction(r,e,h);i.done(c)})};t.UndoRedo.prototype.done=function(n){this.ignoreNewActions||(this.doneActions.push(n),this.undoneActions.length=0)};t.UndoRedo.prototype.undo=function(){var n,t;this.isUndoAvailable()&&(n=this.doneActions.pop(),this.ignoreNewActions=!0,t=this,n.undo(this.instance,function(){t.ignoreNewActions=!1;t.undoneActions.push(n)}))};t.UndoRedo.prototype.redo=function(){var n,t;this.isRedoAvailable()&&(n=this.undoneActions.pop(),this.ignoreNewActions=!0,t=this,n.redo(this.instance,function(){t.ignoreNewActions=!1;t.doneActions.push(n)}))};t.UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0};t.UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};t.UndoRedo.prototype.clear=function(){this.doneActions.length=0;this.undoneActions.length=0};t.UndoRedo.Action=function(){};t.UndoRedo.Action.prototype.undo=function(){};t.UndoRedo.Action.prototype.redo=function(){};t.UndoRedo.ChangeAction=function(n){this.changes=n};t.helper.inherit(t.UndoRedo.ChangeAction,t.UndoRedo.Action);t.UndoRedo.ChangeAction.prototype.undo=function(t,i){for(var r=n.extend(!0,[],this.changes),u=0,f=r.length;u<f;u++)r[u].splice(3,1);t.addHookOnce("afterChange",i);t.setDataAtRowProp(r,null,null,"undo")};t.UndoRedo.ChangeAction.prototype.redo=function(t,i){for(var r=n.extend(!0,[],this.changes),u=0,f=r.length;u<f;u++)r[u].splice(2,1);t.addHookOnce("afterChange",i);t.setDataAtRowProp(r,null,null,"redo")};t.UndoRedo.CreateRowAction=function(n,t){this.index=n;this.amount=t};t.helper.inherit(t.UndoRedo.CreateRowAction,t.UndoRedo.Action);t.UndoRedo.CreateRowAction.prototype.undo=function(n,t){n.addHookOnce("afterRemoveRow",t);n.alter("remove_row",this.index,this.amount)};t.UndoRedo.CreateRowAction.prototype.redo=function(n,t){n.addHookOnce("afterCreateRow",t);n.alter("insert_row",this.index+1,this.amount)};t.UndoRedo.RemoveRowAction=function(n,t){this.index=n;this.data=t};t.helper.inherit(t.UndoRedo.RemoveRowAction,t.UndoRedo.Action);t.UndoRedo.RemoveRowAction.prototype.undo=function(n,t){var i=[this.index,0];Array.prototype.push.apply(i,this.data);Array.prototype.splice.apply(n.getData(),i);n.addHookOnce("afterRender",t);n.render()};t.UndoRedo.RemoveRowAction.prototype.redo=function(n,t){n.addHookOnce("afterRemoveRow",t);n.alter("remove_row",this.index,this.data.length)};t.UndoRedo.CreateColumnAction=function(n,t){this.index=n;this.amount=t};t.helper.inherit(t.UndoRedo.CreateColumnAction,t.UndoRedo.Action);t.UndoRedo.CreateColumnAction.prototype.undo=function(n,t){n.addHookOnce("afterRemoveCol",t);n.alter("remove_col",this.index,this.amount)};t.UndoRedo.CreateColumnAction.prototype.redo=function(n,t){n.addHookOnce("afterCreateCol",t);n.alter("insert_col",this.index+1,this.amount)};t.UndoRedo.RemoveColumnAction=function(n,t,i){this.index=n;this.data=t;this.amount=this.data[0].length;this.headers=i};t.helper.inherit(t.UndoRedo.RemoveColumnAction,t.UndoRedo.Action);t.UndoRedo.RemoveColumnAction.prototype.undo=function(n,t){for(var u,i,r=0,f=n.getData().length;r<f;r++)u=n.getDataAtRow(r),i=[this.index,0],Array.prototype.push.apply(i,this.data[r]),Array.prototype.splice.apply(u,i);typeof this.headers!="undefined"&&(i=[this.index,0],Array.prototype.push.apply(i,this.headers),Array.prototype.splice.apply(n.getSettings().colHeaders,i));n.addHookOnce("afterRender",t);n.render()};t.UndoRedo.RemoveColumnAction.prototype.redo=function(n,t){n.addHookOnce("afterRemoveCol",t);n.alter("remove_col",this.index,this.amount)}}(i),function(n){function t(){var t=this,e=typeof t.getSettings().undo=="undefined"||t.getSettings().undo;e?t.undoRedo||(t.undoRedo=new n.UndoRedo(t),u(t),t.addHook("beforeKeyDown",i),t.addHook("afterChange",r)):t.undoRedo&&(delete t.undoRedo,f(t),t.removeHook("beforeKeyDown",i),t.removeHook("afterChange",r))}function i(n){var t=this,i=(n.ctrlKey||n.metaKey)&&!n.altKey;i&&(n.keyCode===89||n.shiftKey&&n.keyCode===90?(t.undoRedo.redo(),n.stopImmediatePropagation()):n.keyCode===90&&(t.undoRedo.undo(),n.stopImmediatePropagation()))}function r(n,t){var i=this;if(t=="loadData")return i.undoRedo.clear()}function u(n){n.undo=function(){return n.undoRedo.undo()};n.redo=function(){return n.undoRedo.redo()};n.isUndoAvailable=function(){return n.undoRedo.isUndoAvailable()};n.isRedoAvailable=function(){return n.undoRedo.isRedoAvailable()};n.clearUndo=function(){return n.undoRedo.clear()}}function f(n){delete n.undo;delete n.redo;delete n.isUndoAvailable;delete n.isRedoAvailable;delete n.clearUndo}n.PluginHooks.add("afterInit",t);n.PluginHooks.add("afterUpdateSettings",t)}(i);ft.prototype.setBoundaries=function(n){this.boundaries=n};ft.prototype.setCallback=function(n){this.callback=n};ft.prototype.check=function(n,t){var i=0,r=0;t<this.boundaries.top?r=t-this.boundaries.top:t>this.boundaries.bottom&&(r=t-this.boundaries.bottom);n<this.boundaries.left?i=n-this.boundaries.left:n>this.boundaries.right&&(i=n-this.boundaries.right);this.callback(i,r)};at=!1;typeof i!="undefined"&&(bt=function(n){var i=n.view.wt.wtScrollbars.vertical.scrollHandler;(et=new ft,i!==t)&&(i?et.setBoundaries(i.getBoundingClientRect()):et.setBoundaries(n.$table[0].getBoundingClientRect()),et.setCallback(function(t,r){t<0?i?i.scrollLeft-=50:n.view.wt.scrollHorizontal(-1).draw():t>0&&(i?i.scrollLeft+=50:n.view.wt.scrollHorizontal(1).draw());r<0?i?i.scrollTop-=20:n.view.wt.scrollVertical(-1).draw():r>0&&(i?i.scrollTop+=20:n.view.wt.scrollVertical(1).draw())}),at=!0)},i.PluginHooks.add("afterInit",function(){n(document).on("mouseup."+this.guid,function(){at=!1});n(document).on("mousemove."+this.guid,function(n){at&&et.check(n.clientX,n.clientY)})}),i.PluginHooks.add("destroy",function(){n(document).off("."+this.guid)}),i.PluginHooks.add("afterOnCellMouseDown",function(){bt(this)}),i.PluginHooks.add("afterOnCellCornerMouseDown",function(){bt(this)}),i.plugins.DragToScroll=ft),function(n,t,i){function u(r){function f(){r.isListening()&&r.selection.empty()}function e(n){if(r.isListening()&&r.selection.isSelected()){var s=n.replace(/^[\r\n]*/g,"").replace(/[\r\n]*$/g,""),o=i.parse(s),u=r.getSelected(),t=r.getCornerCoords([{row:u[0],col:u[1]},{row:u[2],col:u[3]}]),f=t.TL,e={row:Math.max(t.BR.row,o.length-1+t.TL.row),col:Math.max(t.BR.col,o[0].length-1+t.TL.col)};r.PluginHooks.once("afterChange",function(n){n&&n.length&&this.selectCell(f.row,f.col,e.row,e.col)});r.populateFromArray(f.row,f.col,o,e.row,e.col,"paste",r.getSettings().pasteMode)}}function o(t){if(n.helper.isCtrlKey(t.keyCode)&&r.getSelected()){u.setCopyableText();t.stopImmediatePropagation();return}var i=(t.ctrlKey||t.metaKey)&&!t.altKey;t.keyCode==n.helper.keyCode.A&&i&&setTimeout(n.helper.proxy(u.setCopyableText,u))}this.copyPasteInstance=t.getInstance();this.copyPasteInstance.onCut(f);this.copyPasteInstance.onPaste(e);var u=this;r.addHook("beforeKeyDown",o);this.destroy=function(){this.copyPasteInstance.removeCallback(f);this.copyPasteInstance.removeCallback(e);this.copyPasteInstance.destroy();r.removeHook("beforeKeyDown",o)};r.addHook("afterDestroy",n.helper.proxy(this.destroy,this));this.triggerPaste=n.helper.proxy(this.copyPasteInstance.triggerPaste,this.copyPasteInstance);this.triggerCut=n.helper.proxy(this.copyPasteInstance.triggerCut,this.copyPasteInstance);this.setCopyableText=function(){var n=r.getSelected(),e=r.getSettings(),o=e.copyRowsLimit,s=e.copyColsLimit,t=Math.min(n[0],n[2]),i=Math.min(n[1],n[3]),u=Math.max(n[0],n[2]),f=Math.max(n[1],n[3]),h=Math.min(u,t+o-1),c=Math.min(f,i+s-1);r.copyPaste.copyPasteInstance.copyable(r.getCopyableData(t,i,h,c));(u!==h||f!==c)&&r.PluginHooks.run("afterCopyLimit",u-t+1,f-i+1,o,s)}}function r(){var n=this,t=n.getSettings().copyPaste!==!1;t&&!n.copyPaste?n.copyPaste=new u(n):!t&&n.copyPaste&&(n.copyPaste.destroy(),delete n.copyPaste)}n.PluginHooks.add("afterInit",r);n.PluginHooks.add("afterUpdateSettings",r)}(i,ti,SheetClip),function(n){function t(){var t=this,i=!!t.getSettings().search;i?t.search=new n.Search(t):delete t.search}n.Search=function(t){this.query=function(i,r,u){var v=t.countRows(),y=t.countCols(),s=[],f,e,a;for(r||(r=n.Search.global.getDefaultCallback()),u||(u=n.Search.global.getDefaultQueryMethod()),f=0;f<v;f++)for(e=0;e<y;e++){var o=t.getDataAtCell(f,e),h=t.getCellMeta(f,e),c=h.search.callback||r,p=h.search.queryMethod||u,l=p(i,o);l&&(a={row:f,col:e,data:o},s.push(a));c&&c(t,f,e,o,l)}return s}};n.Search.DEFAULT_CALLBACK=function(n,t,i,r,u){n.getCellMeta(t,i).isSearchResult=u};n.Search.DEFAULT_QUERY_METHOD=function(n,t){return typeof n=="undefined"||n==null||!n.toLowerCase||n.length==0?!1:t.toString().toLowerCase().indexOf(n.toLowerCase())!=-1};n.Search.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult";n.Search.global=function(){var t=n.Search.DEFAULT_CALLBACK,i=n.Search.DEFAULT_QUERY_METHOD,r=n.Search.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function(){return t},setDefaultCallback:function(n){t=n},getDefaultQueryMethod:function(){return i},setDefaultQueryMethod:function(n){i=n},getDefaultSearchResultClass:function(){return r},setDefaultSearchResultClass:function(n){r=n}}}();n.SearchCellDecorator=function(t,i,r,u,f,e,o){var s=typeof o.search=="object"&&o.search.searchResultClass||n.Search.global.getDefaultSearchResultClass();o.isSearchResult?n.Dom.addClass(i,s):n.Dom.removeClass(i,s)};var i=n.renderers.cellDecorator;n.renderers.cellDecorator=function(){i.apply(this,arguments);n.SearchCellDecorator.apply(this,arguments)};n.PluginHooks.add("afterInit",t);n.PluginHooks.add("afterUpdateSettings",t)}(i);e.prototype.init=function(){this.TABLE=this.instance.wtTable.TABLE;this.fixed=this.instance.wtTable.hider;this.fixedContainer=this.instance.wtTable.holder;this.fixed.style.position="absolute";this.fixed.style.left="0";this.scrollHandler=this.getScrollableElement(this.TABLE);this.$scrollHandler=n(this.scrollHandler)};e.prototype.makeClone=function(n){var t=document.createElement("DIV"),i;return t.className="ht_clone_"+n+" handsontable",t.style.position="fixed",t.style.overflow="hidden",i=document.createElement("TABLE"),i.className=this.instance.wtTable.TABLE.className,t.appendChild(i),this.instance.wtTable.holder.parentNode.appendChild(t),new l({cloneSource:this.instance,cloneOverlay:this,table:i})};e.prototype.getScrollableElement=function(n){for(var i=n.parentNode;i&&i.style;){if(i.style.overflow!=="visible"&&i.style.overflow!==""||this instanceof f&&i.style.overflowX!=="visible"&&i.style.overflowX!=="")return i;i=i.parentNode}return t};e.prototype.prepare=function(){};e.prototype.onScroll=function(n){this.windowScrollPosition=this.getScrollPosition();this.readSettings();n&&(this.windowScrollPosition=n);this.resetFixedPosition()};e.prototype.availableSize=function(){return this.windowScrollPosition>this.tableParentOffset?this.instance.wtTable.getLastVisibleRow()===this.total-1?this.instance.wtDom.outerHeight(this.TABLE):this.windowSize:this.windowSize-this.tableParentOffset};e.prototype.refresh=function(n){var t=this.getLastCell();this.measureBefore=this.sumCellSizes(0,this.offset);this.measureAfter=t===-1?0:this.sumCellSizes(t,this.total-t);this.applyToDOM();this.clone&&this.clone.draw(n)};e.prototype.destroy=function(){this.$scrollHandler.off("."+this.instance.guid);n(t).off("."+this.instance.guid);n(document).off("."+this.instance.guid)};vt.prototype.appear=function(n){var w,h,c,l,b,k,e,d,o,g,u,f,ut,ft;if(!this.disabled){var r=this.instance,a,v,nt,tt,it=!1,rt=!1,y=!1,p=!1,t,s,i;for(r.wtTable.isRowInViewport(n[0])||(it=!0),r.wtTable.isRowInViewport(n[2])||(y=!0),s=r.wtTable.rowStrategy.countVisible(),t=0;t<s;t++)if(i=r.wtTable.rowFilter.visibleToSource(t),i>=n[0]&&i<=n[2]){a=i;break}for(t=s-1;t>=0;t--)if(i=r.wtTable.rowFilter.visibleToSource(t),i>=n[0]&&i<=n[2]){nt=i;break}if(it&&y)rt=!0,p=!0;else{for(r.wtTable.isColumnInViewport(n[1])||(rt=!0),r.wtTable.isColumnInViewport(n[3])||(p=!0),s=r.wtTable.columnStrategy.countVisible(),t=0;t<s;t++)if(i=r.wtTable.columnFilter.visibleToSource(t),i>=n[1]&&i<=n[3]){v=i;break}for(t=s-1;t>=0;t--)if(i=r.wtTable.columnFilter.visibleToSource(t),i>=n[1]&&i<=n[3]){tt=i;break}}if(a!==void 0&&v!==void 0)w=a!==nt||v!==tt,h=r.wtTable.getCell([a,v]),c=w?r.wtTable.getCell([nt,tt]):h,l=this.wtDom.offset(h),b=w?this.wtDom.offset(c):l,k=this.wtDom.offset(r.wtTable.TABLE),d=l.top,u=b.top+this.wtDom.outerHeight(c)-d,g=l.left,f=b.left+this.wtDom.outerWidth(c)-g,e=d-k.top-1,o=g-k.left-1,ut=this.wtDom.getComputedStyle(h),parseInt(ut.borderTopWidth,10)>0&&(e+=1,u=u>0?u-1:0),parseInt(ut.borderLeftWidth,10)>0&&(o+=1,f=f>0?f-1:0);else{this.disappear();return}it?this.topStyle.display="none":(this.topStyle.top=e+"px",this.topStyle.left=o+"px",this.topStyle.width=f+"px",this.topStyle.display="block");rt?this.leftStyle.display="none":(this.leftStyle.top=e+"px",this.leftStyle.left=o+"px",this.leftStyle.height=u+"px",this.leftStyle.display="block");ft=Math.floor(this.settings.border.width/2);y?this.bottomStyle.display="none":(this.bottomStyle.top=e+u-ft+"px",this.bottomStyle.left=o+"px",this.bottomStyle.width=f+"px",this.bottomStyle.display="block");p?this.rightStyle.display="none":(this.rightStyle.top=e+"px",this.rightStyle.left=o+f-ft+"px",this.rightStyle.height=u+1+"px",this.rightStyle.display="block");y||p||!this.hasSetting(this.settings.border.cornerVisible)?this.cornerStyle.display="none":(this.cornerStyle.top=e+u-4+"px",this.cornerStyle.left=o+f-4+"px",this.cornerStyle.display="block")}};vt.prototype.disappear=function(){this.topStyle.display="none";this.leftStyle.display="none";this.bottomStyle.display="none";this.rightStyle.display="none";this.cornerStyle.display="none"};vt.prototype.hasSetting=function(n){return typeof n=="function"?n():!!n};y.prototype.source=function(n){return n};y.prototype.offsetted=function(n){return n+this.offset};y.prototype.unOffsetted=function(n){return n-this.offset};y.prototype.fixed=function(n){return n<this.fixedCount?n-this.offset:n};y.prototype.unFixed=function(n){return n<this.fixedCount?n+this.offset:n};y.prototype.visibleToSource=function(n){return this.source(this.offsetted(this.fixed(n)))};y.prototype.sourceToVisible=function(n){return this.source(this.unOffsetted(this.unFixed(n)))};w.prototype.getSize=function(n){return this.cellSizes[n]};w.prototype.getContainerSize=function(n){return typeof this.containerSizeFn=="function"?this.containerSizeFn(n):this.containerSizeFn};w.prototype.countVisible=function(){return this.cellCount};w.prototype.isLastIncomplete=function(){if(this.instance.getSetting("nativeScrollbars")){var n=this.instance.cloneFrom?this.instance.cloneFrom.wtScrollbars.vertical:this.instance.wtScrollbars.vertical;return this.remainingSize>n.sumCellSizes(n.offset,n.offset+n.curOuts+1)}return this.remainingSize>0};ot.prototype.add=function(n,t,i){this.cache[n]||(this.cache[n]=[]);this.cache[n][t]||(this.cache[n][t]=[]);this.cache[n][t][i]=!0};ot.prototype.test=function(n,t,i){return this.cache[n]&&this.cache[n][t]&&this.cache[n][t][i]};k.prototype=new y;k.prototype.readSettings=function(n){this.offset=n.wtSettings.settings.offsetColumn;this.total=n.getSetting("totalColumns");this.fixedCount=n.getSetting("fixedColumnsLeft");this.countTH=n.getSetting("rowHeaders").length};k.prototype.offsettedTH=function(n){return n-this.countTH};k.prototype.unOffsettedTH=function(n){return n+this.countTH};k.prototype.visibleRowHeadedColumnToSourceColumn=function(n){return this.visibleToSource(this.offsettedTH(n))};k.prototype.sourceColumnToVisibleRowHeadedColumn=function(n){return this.unOffsettedTH(this.sourceToVisible(n))};yt.prototype=new w;yt.prototype.getSize=function(n){return this.cellSizes[n]+(this.cellStretch[n]||0)};yt.prototype.stretch=function(){var t=this.getContainerSize(this.cellSizesSum),n=0,r,i;if(this.remainingSize=this.cellSizesSum-t,this.cellStretch.length=0,this.strategy==="all"){if(this.remainingSize<0){for(r=t/this.cellSizesSum;n<this.cellCount-1;)i=Math.floor(r*this.cellSizes[n]),this.remainingSize+=i-this.cellSizes[n],this.cellStretch[n]=i-this.cellSizes[n],n++;this.cellStretch[this.cellCount-1]=-this.remainingSize;this.remainingSize=0}}else this.strategy==="last"&&this.remainingSize<0&&t!==Infinity&&(this.cellStretch[this.cellCount-1]=-this.remainingSize,this.remainingSize=0)};l.prototype.draw=function(n){if(this.drawInterrupted=!1,!n&&!this.wtDom.isVisible(this.wtTable.TABLE)){this.drawInterrupted=!0;return}return this.getSetting("beforeDraw",!n),n=n&&this.getSetting("offsetRow")===this.lastOffsetRow&&this.getSetting("offsetColumn")===this.lastOffsetColumn,this.drawn&&(this.scrollVertical(0),this.scrollHorizontal(0)),this.lastOffsetRow=this.getSetting("offsetRow"),this.lastOffsetColumn=this.getSetting("offsetColumn"),this.wtTable.draw(n),this.cloneSource||this.getSetting("onDraw",!n),this};l.prototype.update=function(n,t){return this.wtSettings.update(n,t)};l.prototype.scrollVertical=function(n){var t=this.wtScroll.scrollVertical(n);return this.getSetting("onScrollVertically"),t};l.prototype.scrollHorizontal=function(n){var t=this.wtScroll.scrollHorizontal(n);return this.getSetting("onScrollHorizontally"),t};l.prototype.scrollViewport=function(n){return this.wtScroll.scrollViewport(n),this};l.prototype.getViewport=function(){return[this.wtTable.rowFilter.visibleToSource(0),this.wtTable.columnFilter.visibleToSource(0),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]};l.prototype.getSetting=function(n,t,i,r){return this.wtSettings.getSetting(n,t,i,r)};l.prototype.hasSetting=function(n){return this.wtSettings.has(n)};l.prototype.destroy=function(){n(document.body).off("."+this.guid);this.wtScrollbars.destroy();clearTimeout(this.wheelTimeout);this.wtEvent&&this.wtEvent.destroy()};s.prototype=new e;s.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var n=this.clone.wtTable.holder.parentNode,t=this.instance.wtTable.holder.getBoundingClientRect();n.style.top=Math.ceil(t.top,10)+"px";n.style.left=Math.ceil(t.left,10)+"px"}};s.prototype.prepare=function(){};s.prototype.refresh=function(n){this.clone&&this.clone.draw(n)};s.prototype.getScrollPosition=function(){};s.prototype.getLastCell=function(){};s.prototype.applyToDOM=function(){};s.prototype.scrollTo=function(){};s.prototype.readWindowSize=function(){};s.prototype.readSettings=function(){};r.prototype.closest=function(n,t,i){while(n!=null&&n!==i){if(n.nodeType===1&&t.indexOf(n.nodeName)>-1)return n;n=n.parentNode}return null};r.prototype.isChildOf=function(n,t){for(var i=n.parentNode;i!=null;){if(i==t)return!0;i=i.parentNode}return!1};r.prototype.index=function(n){for(var t=0;n=n.previousSibling;)++t;return t};document.documentElement.classList?(r.prototype.hasClass=function(n,t){return n.classList.contains(t)},r.prototype.addClass=function(n,t){n.classList.add(t)},r.prototype.removeClass=function(n,t){n.classList.remove(t)}):(r.prototype.hasClass=function(n,t){return n.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},r.prototype.addClass=function(n,t){this.hasClass(n,t)||(n.className+=" "+t)},r.prototype.removeClass=function(n,t){if(this.hasClass(n,t)){var i=new RegExp("(\\s|^)"+t+"(\\s|$)");n.className=n.className.replace(i," ").trim()}});r.prototype.removeTextNodes=function(n,t){var r,i;if(n.nodeType===3)t.removeChild(n);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(n.nodeName)>-1)for(r=n.childNodes,i=r.length-1;i>=0;i--)this.removeTextNodes(r[i],n)};r.prototype.empty=function(n){for(var t;t=n.lastChild;)n.removeChild(t)};r.prototype.HTML_CHARACTERS=/(<(.*)>|&(.*);)/;r.prototype.fastInnerHTML=function(n,t){this.HTML_CHARACTERS.test(t)?n.innerHTML=t:this.fastInnerText(n,t)};r.prototype.fastInnerText=document.createTextNode("test").textContent?function(n,t){var i=n.firstChild;i&&i.nodeType===3&&i.nextSibling===null?i.textContent=t:(this.empty(n),n.appendChild(document.createTextNode(t)))}:function(n,t){var i=n.firstChild;i&&i.nodeType===3&&i.nextSibling===null?i.data=t:(this.empty(n),n.appendChild(document.createTextNode(t)))};r.prototype.isVisible=function(n){for(var t=n;t!==document.documentElement;){if(t===null)return!1;if(t.nodeType===11)if(t.host){if(t.host.impl)return r.prototype.isVisible(t.host.impl);if(t.host)return r.prototype.isVisible(t.host);throw new Error("Lost in Web Components world");}else return!1;else if(t.style.display==="none")return!1;t=t.parentNode}return!0};r.prototype.offset=function(n){var i;if(this.hasCaptionProblem()&&n.firstChild&&n.firstChild.nodeName==="CAPTION")return i=n.getBoundingClientRect(),{top:i.top+(t.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),left:i.left+(t.pageXOffset||document.documentElement.scrollLeft)-(document.documentElement.clientLeft||0)};for(var r=n.offsetLeft,u=n.offsetTop,f=n;n=n.offsetParent;){if(n===document.body)break;r+=n.offsetLeft;u+=n.offsetTop;f=n}return f&&f.style.position==="fixed"&&(r+=t.pageXOffset||document.documentElement.scrollLeft,u+=t.pageYOffset||document.documentElement.scrollTop),{left:r,top:u}};r.prototype.getComputedStyle=function(n){return n.currentStyle||document.defaultView.getComputedStyle(n)};r.prototype.outerWidth=function(n){return n.offsetWidth};r.prototype.outerHeight=function(n){return this.hasCaptionProblem()&&n.firstChild&&n.firstChild.nodeName==="CAPTION"?n.offsetHeight+n.firstChild.offsetHeight:n.offsetHeight},function(){function i(){var t=document.createElement("TABLE"),i,r;t.style.borderSpacing=0;t.style.borderWidth=0;t.style.padding=0;i=document.createElement("TBODY");t.appendChild(i);i.appendChild(document.createElement("TR"));i.firstChild.appendChild(document.createElement("TD"));i.firstChild.firstChild.innerHTML="<tr><td>t<br>t<\/td><\/tr>";r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c";r.style.padding=0;r.style.margin=0;t.insertBefore(r,i);document.body.appendChild(t);n=t.offsetHeight<2*t.lastChild.offsetHeight;document.body.removeChild(t)}function u(){var t=document.createElement("p"),n,r,i;return t.style.width="100%",t.style.height="200px",n=document.createElement("div"),n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.visibility="hidden",n.style.width="200px",n.style.height="150px",n.style.overflow="hidden",n.appendChild(t),(document.body||document.documentElement).appendChild(n),r=t.offsetWidth,n.style.overflow="scroll",i=t.offsetWidth,r==i&&(i=n.clientWidth),(document.body||document.documentElement).removeChild(n),r-i}var n,t;r.prototype.hasCaptionProblem=function(){return n===void 0&&i(),n};r.prototype.getCaretPosition=function(n){var i,t,r;return n.selectionStart?n.selectionStart:document.selection?(n.focus(),i=document.selection.createRange(),i==null)?0:(t=n.createTextRange(),r=t.duplicate(),t.moveToBookmark(i.getBookmark()),r.setEndPoint("EndToStart",t),r.text.length):0};r.prototype.setCaretPosition=function(n,t,i){if(i===void 0&&(i=t),n.setSelectionRange)n.focus(),n.setSelectionRange(t,i);else if(n.createTextRange){var r=n.createTextRange();r.collapse(!0);r.moveEnd("character",i);r.moveStart("character",t);r.select()}};r.prototype.getScrollbarWidth=function(){return t===void 0&&(t=u()),t}}();kt.prototype.parentCell=function(n){var t={},r=this.instance.wtTable.TABLE,i=this.wtDom.closest(n,["TD","TH"],r);return i&&this.wtDom.isChildOf(i,r)?(t.coords=this.instance.wtTable.getCoords(i),t.TD=i):this.wtDom.hasClass(n,"wtBorder")&&this.wtDom.hasClass(n,"current")&&(t.coords=this.instance.selections.current.selected[0],t.TD=this.instance.wtTable.getCell(t.coords)),t};kt.prototype.destroy=function(){clearTimeout(this.dblClickTimeout0);clearTimeout(this.dblClickTimeout1)};t.requestAnimFrame=function(){return t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(n){return t.setTimeout(n,1e3/60)}}();t.cancelRequestAnimFrame=function(){return t.cancelAnimationFrame||t.webkitCancelRequestAnimationFrame||t.mozCancelRequestAnimationFrame||t.oCancelRequestAnimationFrame||t.msCancelRequestAnimationFrame||clearTimeout}();t.getComputedStyle||function(){var n,i={getPropertyValue:function(t){return t=="float"&&(t="styleFloat"),n.currentStyle[t.toUpperCase()]||null}};t.getComputedStyle=function(t){return n=t,i}}();String.prototype.trim||(ri=/^\s+|\s+$/g,String.prototype.trim=function(){return this.replace(ri,"")});dt.prototype=new y;dt.prototype.readSettings=function(n){this.offset=n.cloneOverlay instanceof s?0:n.wtSettings.settings.offsetRow;this.total=n.getSetting("totalRows");this.fixedCount=n.getSetting("fixedRowsTop")};st.prototype=new w;st.prototype.add=function(n,t,i){var r,u;return!this.isLastIncomplete()&&this.remainingSize!=0?(r=this.sizeAtIndex(n,t),r===void 0)?!1:(u=this.getContainerSize(this.cellSizesSum+r),i?this.cellSizes.unshift(r):this.cellSizes.push(r),this.cellSizesSum+=r,this.cellCount++,this.remainingSize=this.cellSizesSum-u,i&&this.isLastIncomplete())?!1:!0:!1};st.prototype.remove=function(){var n=this.cellSizes.pop();this.cellSizesSum-=n;this.cellCount--;this.remainingSize-=n};st.prototype.removeOutstanding=function(){while(this.cellCount>0&&this.cellSizes[this.cellCount-1]<this.remainingSize)this.remove()};d.prototype.scrollVertical=function(n){if(!this.instance.drawn)throw new Error("scrollVertical can only be called after table was drawn to DOM");var t=this.instance,r,i=t.getSetting("offsetRow"),u=t.getSetting("fixedRowsTop"),f=t.getSetting("totalRows"),e=t.wtViewport.getViewportHeight();return r=f>0?this.scrollLogicVertical(n,i,f,u,e,function(n){return n-i<u&&n-i>=0?t.getSetting("rowHeight",n-i):t.getSetting("rowHeight",n)},function(n){t.wtTable.verticalRenderReverse=n}):0,r!==i&&this.instance.wtScrollbars.vertical.scrollTo(r),t};d.prototype.scrollHorizontal=function(n){if(!this.instance.drawn)throw new Error("scrollHorizontal can only be called after table was drawn to DOM");var t=this.instance,r,i=t.getSetting("offsetColumn"),u=t.getSetting("fixedColumnsLeft"),f=t.getSetting("totalColumns"),e=t.wtViewport.getViewportWidth();return r=f>0?this.scrollLogicHorizontal(n,i,f,u,e,function(n){return n-i<u&&n-i>=0?t.getSetting("columnWidth",n-i):t.getSetting("columnWidth",n)}):0,r!==i&&this.instance.wtScrollbars.horizontal.scrollTo(r),t};d.prototype.scrollLogicVertical=function(n,t,i,r,u,f,e){var o=t+n;return o>=i-r&&(o=i-r-1,e(!0)),o<0&&(o=0),o};d.prototype.scrollLogicHorizontal=function(n,t,i,r,u,f){var e=t+n,o=0,s;if(e>r){for(e>=i-r&&(e=i-r-1),s=e;o<u&&s<i;)o+=f(s),s++;if(o<u)while(e>0)if(o+=f(e-1),o<u)e--;else break}else e<0&&(e=0);return e};d.prototype.scrollViewport=function(n){var e,f,a,u,w,v;if(this.instance.drawn){var o=this.instance.getSetting("offsetRow"),tt=this.instance.getSetting("offsetColumn"),b=this.instance.wtTable.getLastVisibleRow(),g=this.instance.getSetting("totalRows"),nt=this.instance.getSetting("totalColumns"),s=this.instance.getSetting("fixedRowsTop"),h=this.instance.getSetting("fixedColumnsLeft");if(this.instance.getSetting("nativeScrollbars")&&(e=this.instance.wtTable.getCell(n),typeof e=="object")){var i=r.prototype.offset(e),y=r.prototype.outerWidth(e),p=r.prototype.outerHeight(e),k=this.instance.wtScrollbars.horizontal.getScrollPosition(),d=this.instance.wtScrollbars.vertical.getScrollPosition(),c=r.prototype.outerWidth(this.instance.wtScrollbars.horizontal.scrollHandler),l=r.prototype.outerHeight(this.instance.wtScrollbars.vertical.scrollHandler);this.instance.wtScrollbars.horizontal.scrollHandler!==t&&(i.left=i.left-r.prototype.offset(this.instance.wtScrollbars.horizontal.scrollHandler).left);this.instance.wtScrollbars.vertical.scrollHandler!==t&&(i.top=i.top-r.prototype.offset(this.instance.wtScrollbars.vertical.scrollHandler).top);c-=20;l-=20;y<c&&(i.left<k?this.instance.wtScrollbars.horizontal.setScrollPosition(i.left):i.left+y>k+c&&this.instance.wtScrollbars.horizontal.setScrollPosition(i.left-c+y));p<l&&(i.top<d?this.instance.wtScrollbars.vertical.setScrollPosition(i.top):i.top+p>d+l&&this.instance.wtScrollbars.vertical.setScrollPosition(i.top-l+p));return}if(n[0]<0||n[0]>g-1)throw new Error("row "+n[0]+" does not exist");else if(n[1]<0||n[1]>nt-1)throw new Error("column "+n[1]+" does not exist");if(n[0]>b?(this.scrollVertical(n[0]-s-o),this.instance.wtTable.verticalRenderReverse=!0):n[0]===b&&this.instance.wtTable.rowStrategy.isLastIncomplete()?(this.scrollVertical(n[0]-s-o),this.instance.wtTable.verticalRenderReverse=!0):n[0]-s<o?this.scrollVertical(n[0]-s-o):this.scrollVertical(0),this.instance.wtTable.isColumnBeforeViewport(n[1]))this.instance.wtScrollbars.horizontal.scrollTo(n[1]-h);else if(this.instance.wtTable.isColumnAfterViewport(n[1])||this.instance.wtTable.getLastVisibleColumn()===n[1]&&!this.instance.wtTable.isLastColumnFullyVisible()){for(f=0,a=0;a<h;a++)f+=this.instance.getSetting("columnWidth",a);if(u=n[1],f+=this.instance.getSetting("columnWidth",u),w=this.instance.wtViewport.getViewportWidth(),f<w)for(v=this.instance.getSetting("columnWidth",u-1);f+v<=w&&u>=h;)u--,f+=v,v=this.instance.getSetting("columnWidth",u-1);this.instance.wtScrollbars.horizontal.scrollTo(u-h)}return this.instance}};b.prototype.init=function(){var t=this,r,i,u;this.$table=n(this.instance.wtTable.TABLE);this.slider=document.createElement("DIV");this.sliderStyle=this.slider.style;this.sliderStyle.position="absolute";this.sliderStyle.top="0";this.sliderStyle.left="0";this.sliderStyle.display="none";this.slider.className="dragdealer "+this.type;this.handle=document.createElement("DIV");this.handleStyle=this.handle.style;this.handle.className="handle";this.slider.appendChild(this.handle);this.container=this.instance.wtTable.holder;this.container.appendChild(this.slider);r=!0;this.dragTimeout=null;u=function(){t.onScroll(i)};this.dragdealer=new ni(this.slider,{vertical:this.type==="vertical",horizontal:this.type==="horizontal",slide:!1,speed:100,animationCallback:function(n,f){if(r){r=!1;return}t.skipRefresh=!0;i=t.type==="vertical"?f:n;t.dragTimeout===null&&(t.dragTimeout=setInterval(u,100),u())},callback:function(n,r){t.skipRefresh=!1;clearInterval(t.dragTimeout);t.dragTimeout=null;i=t.type==="vertical"?r:n;t.onScroll(i)}});this.skipRefresh=!1};b.prototype.onScroll=function(n){if(this.instance.drawn&&(this.readSettings(),this.total>this.visibleCount)){var t=Math.round(this.handlePosition*this.total/this.sliderSize);n===1?this.type==="vertical"?this.instance.scrollVertical(Infinity).draw():this.instance.scrollHorizontal(Infinity).draw():t!==this.offset?this.type==="vertical"?this.instance.scrollVertical(t-this.offset).draw():this.instance.scrollHorizontal(t-this.offset).draw():this.refresh()}};b.prototype.getHandleSizeRatio=function(n,t){return!t||n>t||n==t?1:1/t};b.prototype.prepare=function(){if(!this.skipRefresh){var n=this.getHandleSizeRatio(this.visibleCount,this.total);this.visible=(n===1||isNaN(n))&&this.scrollMode==="auto"||this.scrollMode==="none"?!1:!0}};b.prototype.refresh=function(){if(!this.skipRefresh){if(!this.visible){this.sliderStyle.display="none";return}var f,n,t,i,e=this.visibleCount,r=this.instance.wtViewport.getWorkspaceWidth(),u=this.instance.wtViewport.getWorkspaceHeight();r===Infinity&&(r=this.instance.wtViewport.getWorkspaceActualWidth());u===Infinity&&(u=this.instance.wtViewport.getWorkspaceActualHeight());this.type==="vertical"?(this.instance.wtTable.rowStrategy.isLastIncomplete()&&e--,n=u-2,this.sliderStyle.top=this.instance.wtDom.offset(this.$table[0]).top-this.instance.wtDom.offset(this.container).top+"px",this.sliderStyle.left=r-1+"px",this.sliderStyle.height=Math.max(n,0)+"px"):(n=r-2,this.sliderStyle.left=this.instance.wtDom.offset(this.$table[0]).left-this.instance.wtDom.offset(this.container).left+"px",this.sliderStyle.top=u-1+"px",this.sliderStyle.width=Math.max(n,0)+"px");f=this.getHandleSizeRatio(e,this.total);t=Math.round(n*f);t<10&&(t=15);i=Math.floor(n*(this.offset/this.total));t+i>n&&(i=n-t);this.type==="vertical"?(this.handleStyle.height=t+"px",this.handleStyle.top=i+"px"):(this.handleStyle.width=t+"px",this.handleStyle.left=i+"px");this.sliderStyle.display="block"}};b.prototype.destroy=function(){clearInterval(this.dragdealer.interval)};ht=function(n){this.instance=n;this.type="vertical";this.init()};ht.prototype=new b;ht.prototype.scrollTo=function(n){this.instance.update("offsetRow",n)};ht.prototype.readSettings=function(){this.scrollMode=this.instance.getSetting("scrollV");this.offset=this.instance.getSetting("offsetRow");this.total=this.instance.getSetting("totalRows");this.visibleCount=this.instance.wtTable.rowStrategy.countVisible();this.visibleCount>1&&this.instance.wtTable.rowStrategy.isLastIncomplete()&&this.visibleCount--;this.handlePosition=parseInt(this.handleStyle.top,10);this.sliderSize=parseInt(this.sliderStyle.height,10);this.fixedCount=this.instance.getSetting("fixedRowsTop")};tt=function(n){this.instance=n;this.type="horizontal";this.init()};tt.prototype=new b;tt.prototype.scrollTo=function(n){this.instance.update("offsetColumn",n)};tt.prototype.readSettings=function(){this.scrollMode=this.instance.getSetting("scrollH");this.offset=this.instance.getSetting("offsetColumn");this.total=this.instance.getSetting("totalColumns");this.visibleCount=this.instance.wtTable.columnStrategy.countVisible();this.visibleCount>1&&this.instance.wtTable.columnStrategy.isLastIncomplete()&&this.visibleCount--;this.handlePosition=parseInt(this.handleStyle.left,10);this.sliderSize=parseInt(this.sliderStyle.width,10);this.fixedCount=this.instance.getSetting("fixedColumnsLeft")};tt.prototype.getHandleSizeRatio=function(n,t){return!t||n>t||n==t?1:n/t};h.prototype=new e;h.prototype.resetFixedPosition=function(){var i,n,u,e,f,o;this.instance.wtTable.holder.parentNode&&(i=this.clone.wtTable.holder.parentNode,this.scrollHandler===t?(n=this.instance.wtTable.hider.getBoundingClientRect(),u=Math.ceil(n.top,10),e=Math.ceil(n.bottom,10),i.style.top=u<0&&e>0?"0":u+"px",f=Math.ceil(n.left,10),o=Math.ceil(n.right,10),i.style.left=f<0&&o>0?"0":f+"px"):(n=this.scrollHandler.getBoundingClientRect(),i.style.top=Math.ceil(n.top,10)+"px",i.style.left=Math.ceil(n.left,10)+"px"),i.style.width=r.prototype.outerWidth(this.clone.wtTable.TABLE)+4+"px",i.style.height=r.prototype.outerHeight(this.clone.wtTable.TABLE)+4+"px")};h.prototype.prepare=function(){};h.prototype.refresh=function(n){this.measureBefore=0;this.measureAfter=0;this.clone&&this.clone.draw(n)};h.prototype.getScrollPosition=function(){};h.prototype.getLastCell=function(){};h.prototype.applyToDOM=function(){};h.prototype.scrollTo=function(){};h.prototype.readWindowSize=function(){};h.prototype.readSettings=function(){};f.prototype=new e;f.prototype.resetFixedPosition=function(){var i,n,r,u;this.instance.wtTable.holder.parentNode&&(i=this.clone.wtTable.holder.parentNode,this.scrollHandler===t?(n=this.instance.wtTable.hider.getBoundingClientRect(),r=Math.ceil(n.left,10),u=Math.ceil(n.right,10),i.style.left=r<0&&u>0?"0":r+"px"):(n=this.scrollHandler.getBoundingClientRect(),i.style.top=Math.ceil(n.top,10)+"px",i.style.left=Math.ceil(n.left,10)+"px"))};f.prototype.react=function(){var n,i;this.instance.wtTable.holder.parentNode&&(n=this.clone.wtTable.holder.parentNode,this.instance.wtScrollbars.vertical.scrollHandler===t?(i=this.instance.wtTable.hider.getBoundingClientRect(),n.style.top=Math.ceil(i.top,10)+"px",n.style.height=r.prototype.outerHeight(this.clone.wtTable.TABLE)+"px"):(this.clone.wtTable.holder.style.top=-(this.instance.wtScrollbars.vertical.windowScrollPosition-this.instance.wtScrollbars.vertical.measureBefore)+"px",n.style.height=this.instance.wtViewport.getWorkspaceHeight()+"px"),n.style.width=r.prototype.outerWidth(this.clone.wtTable.TABLE)+4+"px")};f.prototype.prepare=function(){};f.prototype.refresh=function(n){this.measureBefore=0;this.measureAfter=0;this.clone&&this.clone.draw(n)};f.prototype.getScrollPosition=function(){return this.scrollHandler===t?this.scrollHandler.scrollX:this.scrollHandler.scrollLeft};f.prototype.setScrollPosition=function(n){this.scrollHandler.scrollLeft=n};f.prototype.onScroll=function(){e.prototype.onScroll.apply(this,arguments);this.instance.getSetting("onScrollHorizontally")};f.prototype.getLastCell=function(){return this.instance.wtTable.getLastVisibleColumn()};f.prototype.applyToDOM=function(){this.fixedContainer.style.paddingLeft=this.measureBefore+"px";this.fixedContainer.style.paddingRight=this.measureAfter+"px"};f.prototype.scrollTo=function(n){this.$scrollHandler.scrollLeft(this.tableParentOffset+n*this.cellSize)};f.prototype.readWindowSize=function(){this.scrollHandler===t?(this.windowSize=document.documentElement.clientWidth,this.tableParentOffset=this.instance.wtTable.holderOffset.left):(this.windowSize=r.prototype.outerWidth(this.scrollHandler),this.tableParentOffset=0);this.windowScrollPosition=this.getScrollPosition()};f.prototype.readSettings=function(){this.offset=this.instance.getSetting("offsetColumn");this.total=this.instance.getSetting("totalColumns")};c.prototype=new e;c.prototype.resetFixedPosition=function(){var n,i,u,f;this.instance.wtTable.holder.parentNode&&(n=this.clone.wtTable.holder.parentNode,this.scrollHandler===t?(i=this.instance.wtTable.hider.getBoundingClientRect(),u=Math.ceil(i.top,10),f=Math.ceil(i.bottom,10),n.style.top=u<0&&f>0?"0":u+"px"):(i=this.instance.wtScrollbars.horizontal.scrollHandler.getBoundingClientRect(),n.style.top=Math.ceil(i.top,10)+"px",n.style.left=Math.ceil(i.left,10)+"px"),n.style.width=this.instance.wtScrollbars.horizontal.scrollHandler===t?this.instance.wtViewport.getWorkspaceActualWidth()+"px":r.prototype.outerWidth(this.instance.wtTable.holder.parentNode)+"px",n.style.height=r.prototype.outerHeight(this.clone.wtTable.TABLE)+4+"px")};c.prototype.react=function(){if(this.instance.wtTable.holder.parentNode&&this.instance.wtScrollbars.horizontal.scrollHandler!==t){var n=this.clone.wtTable.holder.parentNode;n.firstChild.style.left=-this.instance.wtScrollbars.horizontal.windowScrollPosition+"px"}};c.prototype.getScrollPosition=function(){return this.scrollHandler===t?this.scrollHandler.scrollY:this.scrollHandler.scrollTop};c.prototype.setScrollPosition=function(n){this.scrollHandler.scrollTop=n};c.prototype.onScroll=function(){var i,n,r,u,t;if(e.prototype.onScroll.apply(this,arguments),n=0,(!0||this.windowScrollPosition>this.tableParentOffset)&&(i=this.windowScrollPosition-this.tableParentOffset,gt=0,i>0)){for(r=0,t=0;t<this.total;t++)if(u=this.instance.getSetting("rowHeight",t),r+=u,r>i)break;this.offset>0&&(gt=r-i);n=t;n=Math.min(n,this.total)}this.curOuts=n>this.maxOuts?this.maxOuts:n;n-=this.curOuts;this.instance.update("offsetRow",n);this.readSettings();this.instance.draw();this.instance.getSetting("onScrollVertically")};c.prototype.getLastCell=function(){return this.instance.getSetting("offsetRow")+this.instance.wtTable.tbodyChildrenLength-1};gt=0;c.prototype.sumCellSizes=function(n,t){for(var i=0;n<t;)i+=this.instance.getSetting("rowHeight",n),n++;return i};c.prototype.applyToDOM=function(){var n=this.instance.wtViewport.getColumnHeaderHeight();this.fixedContainer.style.height=n+this.sumCellSizes(0,this.total)+4+"px";this.fixed.style.top=this.measureBefore+"px";this.fixed.style.bottom=""};c.prototype.scrollTo=function(n){var t=this.tableParentOffset+n*this.cellSize;this.$scrollHandler.scrollTop(t);this.onScroll(t)};c.prototype.readWindowSize=function(){this.scrollHandler===t?(this.windowSize=document.documentElement.clientHeight,this.tableParentOffset=this.instance.wtTable.holderOffset.top):(this.windowSize=this.scrollHandler.clientHeight,this.tableParentOffset=0);this.windowScrollPosition=this.getScrollPosition()};c.prototype.readSettings=function(){this.offset=this.instance.getSetting("offsetRow");this.total=this.instance.getSetting("totalRows")};pt.prototype.registerListeners=function(){function r(){if(!i.instance.wtTable.holder.parentNode){i.destroy();return}i.vertical.windowScrollPosition=i.vertical.getScrollPosition();i.horizontal.windowScrollPosition=i.horizontal.getScrollPosition();i.box=i.instance.wtTable.hider.getBoundingClientRect();(i.box.width!==h||i.box.height!==c)&&i.instance.rowHeightCache&&(h=i.box.width,c=i.box.height,i.instance.draw());(i.vertical.windowScrollPosition!==f||i.horizontal.windowScrollPosition!==e||i.box.top!==o||i.box.left!==s)&&(i.vertical.onScroll(),i.horizontal.onScroll(),i.vertical.react(),i.horizontal.react(),f=i.vertical.windowScrollPosition,e=i.horizontal.windowScrollPosition,o=i.box.top,s=i.box.left)}var i=this,f,e,o,s,h,c,u=n(t);this.vertical.$scrollHandler.on("scroll."+this.instance.guid,r);if(this.vertical.scrollHandler!==this.horizontal.scrollHandler)this.horizontal.$scrollHandler.on("scroll."+this.instance.guid,r);if(this.vertical.scrollHandler!==t&&this.horizontal.scrollHandler!==t)u.on("scroll."+this.instance.guid,r);u.on("load."+this.instance.guid,r);u.on("resize."+this.instance.guid,r);n(document).on("ready."+this.instance.guid,r);setInterval(r,100)};pt.prototype.destroy=function(){this.vertical&&this.vertical.destroy();this.horizontal&&this.horizontal.destroy()};pt.prototype.refresh=function(n){this.horizontal&&this.horizontal.readSettings();this.vertical&&this.vertical.readSettings();this.horizontal&&this.horizontal.prepare();this.vertical&&this.vertical.prepare();this.horizontal&&this.horizontal.refresh(n);this.vertical&&this.vertical.refresh(n);this.corner&&this.corner.refresh(n);this.debug&&this.debug.refresh(n)};ct.prototype.add=function(n){this.selected.push(n)};ct.prototype.clear=function(){this.selected.length=0};ct.prototype.getCorners=function(){var t,i,r,u,n,f=this.selected.length;if(f>0&&(t=r=this.selected[0][0],i=u=this.selected[0][1],f>1))for(n=1;n<f;n++)this.selected[n][0]<t?t=this.selected[n][0]:this.selected[n][0]>r&&(r=this.selected[n][0]),this.selected[n][1]<i?i=this.selected[n][1]:this.selected[n][1]>u&&(u=this.selected[n][1]);return[t,i,r,u]};ct.prototype.draw=function(){var n,t,i,r,u,f=this.instance.wtTable.rowStrategy.countVisible(),e=this.instance.wtTable.columnStrategy.countVisible();if(this.selected.length){for(n=this.getCorners(),t=0;t<f;t++)for(i=0;i<e;i++)r=this.instance.wtTable.rowFilter.visibleToSource(t),u=this.instance.wtTable.columnFilter.visibleToSource(i),r>=n[0]&&r<=n[2]&&u>=n[1]&&u<=n[3]?this.instance.wtTable.currentCellCache.add(t,i,this.settings.className):r>=n[0]&&r<=n[2]?this.instance.wtTable.currentCellCache.add(t,i,this.settings.highlightRowClassName):u>=n[1]&&u<=n[3]&&this.instance.wtTable.currentCellCache.add(t,i,this.settings.highlightColumnClassName);this.border&&this.border.appear(n)}else this.border&&this.border.disappear()};it.prototype.update=function(n,t){if(t===void 0)for(var i in n)n.hasOwnProperty(i)&&(this.settings[i]=n[i]);else this.settings[n]=t;return this.instance};it.prototype.getSetting=function(n,t,i,r){return this[n]?this[n](t,i,r):this._getSetting(n,t,i,r)};it.prototype._getSetting=function(n,t,i,r){return typeof this.settings[n]=="function"?this.settings[n](t,i,r):t!==void 0&&Object.prototype.toString.call(this.settings[n])==="[object Array]"?this.settings[n][t]:this.settings[n]};it.prototype.has=function(n){return!!this.settings[n]};it.prototype.rowHeight=function(n,t){if(this.instance.rowHeightCache||(this.instance.rowHeightCache=[]),this.instance.rowHeightCache[n]===void 0){var i=23;return t&&(i=this.instance.wtDom.outerHeight(t),this.instance.rowHeightCache[n]=i),i}return this.instance.rowHeightCache[n]};u.prototype.refreshHiderDimensions=function(){var t=this.instance.wtViewport.getWorkspaceHeight(),i=this.instance.wtViewport.getWorkspaceWidth(),n=this.spreader.style;t===Infinity&&i===Infinity||this.instance.getSetting("nativeScrollbars")?(n.position="relative",n.width="auto",n.height="auto"):(t===Infinity&&(t=this.instance.wtViewport.getWorkspaceActualHeight()),i===Infinity&&(i=this.instance.wtViewport.getWorkspaceActualWidth()),this.hiderStyle.overflow="hidden",n.position="absolute",n.top="0",n.left="0",this.instance.getSetting("nativeScrollbars")||(n.height="4000px",n.width="4000px"),t<0&&(t=0),this.hiderStyle.height=t+"px",this.hiderStyle.width=i+"px")};u.prototype.refreshStretching=function(){var r,u;if(!this.instance.cloneSource){var t=this.instance,i=t.getSetting("stretchH"),f=t.getSetting("totalRows"),e=t.getSetting("totalColumns"),o=t.getSetting("offsetColumn"),h=function(t){var i=n.instance.wtViewport.getViewportWidth(t);return i<t&&n.instance.getSetting("nativeScrollbars")?Infinity:i},n=this,c=function(i){var r=n.columnFilter.visibleToSource(i);if(r<e)return t.getSetting("columnWidth",r)};i==="hybrid"&&(i=o>0?"last":"none");r=function(t){return n.instance.getSetting("nativeScrollbars")?n.instance.cloneOverlay instanceof s?Infinity:2*n.instance.wtViewport.getViewportHeight(t):n.instance.wtViewport.getViewportHeight(t)};u=function(t,i){if(n.instance.getSetting("nativeScrollbars"))return 20;var r=n.rowFilter.visibleToSource(t);if(r<f)return n.verticalRenderReverse&&t===0?n.instance.getSetting("rowHeight",r,i)-1:n.instance.getSetting("rowHeight",r,i)};this.columnStrategy=new yt(t,h,c,i);this.rowStrategy=new st(t,r,u)}};u.prototype.adjustAvailableNodes=function(){for(var r,o=this.instance.getSetting("rowHeaders"),i=o.length,u=this.instance.getSetting("columnHeaders"),t,e,n;this.colgroupChildrenLength<i;)this.COLGROUP.appendChild(document.createElement("COL")),this.colgroupChildrenLength++;for(this.refreshStretching(),r=this.instance.cloneSource&&(this.instance.cloneOverlay instanceof f||this.instance.cloneOverlay instanceof h)?this.instance.getSetting("fixedColumnsLeft"):this.columnStrategy.cellCount;this.colgroupChildrenLength<r+i;)this.COLGROUP.appendChild(document.createElement("COL")),this.colgroupChildrenLength++;while(this.colgroupChildrenLength>r+i)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.colgroupChildrenLength--;if(t=this.THEAD.firstChild,u.length){for(t||(t=document.createElement("TR"),this.THEAD.appendChild(t)),this.theadChildrenLength=t.childNodes.length;this.theadChildrenLength<r+i;)t.appendChild(document.createElement("TH")),this.theadChildrenLength++;while(this.theadChildrenLength>r+i)t.removeChild(t.lastChild),this.theadChildrenLength--}else t&&this.wtDom.empty(t);for(n=0;n<this.colgroupChildrenLength;n++)n<i?this.wtDom.addClass(this.COLGROUP.childNodes[n],"rowHeader"):this.wtDom.removeClass(this.COLGROUP.childNodes[n],"rowHeader");if(u.length&&(t=this.THEAD.firstChild,i))for(e=t.firstChild,n=0;n<i;n++)o[n](-i+n,e),e=e.nextSibling;for(n=0;n<r;n++)u.length&&u[0](this.columnFilter.visibleToSource(n),t.childNodes[i+n])};u.prototype.adjustColumns=function(n,t){for(var i=n.childNodes.length,r;i<t;)r=document.createElement("TD"),n.appendChild(r),i++;while(i>t)n.removeChild(n.lastChild),i--};u.prototype.draw=function(n){return this.instance.getSetting("nativeScrollbars")&&(this.verticalRenderReverse=!1),this.rowFilter.readSettings(this.instance),this.columnFilter.readSettings(this.instance),n?this.instance.wtScrollbars&&this.instance.wtScrollbars.refresh(!0):(this.instance.getSetting("nativeScrollbars")?this.instance.cloneSource?this.tableOffset=this.instance.cloneSource.wtTable.tableOffset:(this.holderOffset=this.wtDom.offset(this.holder),this.tableOffset=this.wtDom.offset(this.TABLE),this.instance.wtScrollbars.vertical.readWindowSize(),this.instance.wtScrollbars.horizontal.readWindowSize(),this.instance.wtViewport.resetSettings()):(this.tableOffset=this.wtDom.offset(this.TABLE),this.instance.wtViewport.resetSettings()),this._doDraw()),this.refreshPositions(n),n||this.instance.getSetting("nativeScrollbars")&&(this.instance.cloneSource||(this.instance.wtScrollbars.vertical.resetFixedPosition(),this.instance.wtScrollbars.horizontal.resetFixedPosition(),this.instance.wtScrollbars.corner.resetFixedPosition(),this.instance.wtScrollbars.debug&&this.instance.wtScrollbars.debug.resetFixedPosition())),this.instance.drawn=!0,this};u.prototype._doDraw=function(){var r=0,e,n,p,o=this.instance.getSetting("offsetRow"),k=this.instance.getSetting("totalRows"),it=this.instance.getSetting("totalColumns"),a,d=this.instance.getSetting("rowHeaders"),l=d.length,t,i,u,g=!1,nt,w,v,b,tt,y;if(this.verticalRenderReverse&&(w=o),b=!1,this.verticalRenderReverse&&(o===k-this.rowFilter.fixedCount-1?b=!0:(this.instance.update("offsetRow",o+1),this.rowFilter.readSettings(this.instance))),this.instance.cloneSource&&(this.columnStrategy=this.instance.cloneSource.wtTable.columnStrategy,this.rowStrategy=this.instance.cloneSource.wtTable.rowStrategy),it>0){for(e=this.rowFilter.visibleToSource(r),tt=this.instance.getSetting("fixedRowsTop"),this.instance.cloneSource&&(this.instance.cloneOverlay instanceof c||this.instance.cloneOverlay instanceof h?y=tt:this.instance.cloneOverlay instanceof f&&(y=this.rowStrategy.countVisible())),this.adjustAvailableNodes(),g=!0,a=this.instance.cloneSource&&(this.instance.cloneOverlay instanceof f||this.instance.cloneOverlay instanceof h)?this.instance.getSetting("fixedColumnsLeft"):this.columnStrategy.cellCount,this.instance.cloneSource||(nt=this.instance.wtViewport.getWorkspaceWidth(),this.columnStrategy.stretch()),n=0;n<a;n++)this.COLGROUP.childNodes[n+l].style.width=this.columnStrategy.getSize(n)+"px";while(e<k&&e>=0){if(r>1e3)throw new Error("Security brake: Too much TRs. Please define height for your table, which will enforce scrollbars.");if(y!==void 0&&r===y)break;if(r>=this.tbodyChildrenLength||this.verticalRenderReverse&&r>=this.rowFilter.fixedCount){for(t=document.createElement("TR"),n=0;n<l;n++)t.appendChild(document.createElement("TH"));this.verticalRenderReverse&&r>=this.rowFilter.fixedCount?this.TBODY.insertBefore(t,this.TBODY.childNodes[this.rowFilter.fixedCount]||this.TBODY.firstChild):this.TBODY.appendChild(t);this.tbodyChildrenLength++}else t=r===0?this.TBODY.firstChild:t.nextSibling;for(u=t.firstChild,n=0;n<l;n++)u.nodeName=="TD"&&(i=u,u=document.createElement("TH"),t.insertBefore(u,i),t.removeChild(i)),d[n](e,u),u=u.nextSibling;for(this.adjustColumns(t,a+l),n=0;n<a;n++)p=this.columnFilter.visibleToSource(n),i=n===0?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(p)]:i.nextSibling,i.nodeName=="TH"&&(u=i,i=document.createElement("TD"),t.insertBefore(i,u),t.removeChild(u)),i.className="",i.removeAttribute("style"),this.instance.getSetting("cellRenderer",e,p,i);if(o=this.instance.getSetting("offsetRow"),this.verticalRenderReverse&&b)if(-this.wtDom.outerHeight(t.firstChild)<this.rowStrategy.remainingSize){this.TBODY.removeChild(t);this.instance.update("offsetRow",o+1);this.tbodyChildrenLength--;this.rowFilter.readSettings(this.instance);break}else this.instance.cloneSource||(v=this.rowStrategy.add(r,i,this.verticalRenderReverse),v===!1&&this.rowStrategy.removeOutstanding());else if(!this.instance.cloneSource&&(v=this.rowStrategy.add(r,i,this.verticalRenderReverse),v===!1&&(this.instance.getSetting("nativeScrollbars")||this.rowStrategy.removeOutstanding()),this.rowStrategy.isLastIncomplete())){if(this.verticalRenderReverse&&!this.isRowInViewport(w)){this.verticalRenderReverse=!1;this.instance.update("offsetRow",w);this.draw();return}break}if(this.instance.getSetting("nativeScrollbars")&&(this.instance.cloneSource?t.style.height=this.instance.getSetting("rowHeight",e)+"px":this.instance.getSetting("rowHeight",e,i)),this.verticalRenderReverse&&r>=this.rowFilter.fixedCount){if(o===0)break;this.instance.update("offsetRow",o-1);this.rowFilter.readSettings(this.instance)}else r++;e=this.rowFilter.visibleToSource(r)}}if(g||this.adjustAvailableNodes(),!(this.instance.cloneOverlay instanceof s))for(r=this.rowStrategy.countVisible();this.tbodyChildrenLength>r;)this.TBODY.removeChild(this.TBODY.lastChild),this.tbodyChildrenLength--;if(this.instance.wtScrollbars&&this.instance.wtScrollbars.refresh(!1),!this.instance.cloneSource&&nt!==this.instance.wtViewport.getWorkspaceWidth())for(this.columnStrategy.stretch(),n=0;n<this.columnStrategy.cellCount;n++)this.COLGROUP.childNodes[n+l].style.width=this.columnStrategy.getSize(n)+"px";this.verticalRenderReverse=!1};u.prototype.refreshPositions=function(n){this.refreshHiderDimensions();this.refreshSelections(n)};u.prototype.refreshSelections=function(n){var u,t,f,e,r,o,i=[],s=this.rowStrategy.countVisible(),h=this.columnStrategy.countVisible();if(this.oldCellCache=this.currentCellCache,this.currentCellCache=new ot,this.instance.selections)for(t in this.instance.selections)this.instance.selections.hasOwnProperty(t)&&(this.instance.selections[t].draw(),this.instance.selections[t].settings.className&&i.push(this.instance.selections[t].settings.className),this.instance.selections[t].settings.highlightRowClassName&&i.push(this.instance.selections[t].settings.highlightRowClassName),this.instance.selections[t].settings.highlightColumnClassName&&i.push(this.instance.selections[t].settings.highlightColumnClassName));for(o=i.length,u=0;u<s;u++)for(f=0;f<h;f++)for(t=this.rowFilter.visibleToSource(u),e=this.columnFilter.visibleToSource(f),r=0;r<o;r++)this.currentCellCache.test(u,f,i[r])?this.wtDom.addClass(this.getCell([t,e]),i[r]):n&&this.oldCellCache.test(u,f,i[r])&&this.wtDom.removeClass(this.getCell([t,e]),i[r])};u.prototype.getCell=function(n){return this.isRowBeforeViewport(n[0])?-1:this.isRowAfterViewport(n[0])?-2:this.isColumnBeforeViewport(n[1])?-3:this.isColumnAfterViewport(n[1])?-4:this.TBODY.childNodes[this.rowFilter.sourceToVisible(n[0])].childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n[1])]};u.prototype.getCoords=function(n){return[this.rowFilter.visibleToSource(this.wtDom.index(n.parentNode)),this.columnFilter.visibleRowHeadedColumnToSourceColumn(n.cellIndex)]};u.prototype.getLastVisibleRow=function(){return this.rowFilter.visibleToSource(this.rowStrategy.cellCount-1)};u.prototype.getLastVisibleColumn=function(){return this.columnFilter.visibleToSource(this.columnStrategy.cellCount-1)};u.prototype.isRowBeforeViewport=function(n){return this.rowFilter.sourceToVisible(n)<this.rowFilter.fixedCount&&n>=this.rowFilter.fixedCount};u.prototype.isRowAfterViewport=function(n){return n>this.getLastVisibleRow()};u.prototype.isColumnBeforeViewport=function(n){return this.columnFilter.sourceToVisible(n)<this.columnFilter.fixedCount&&n>=this.columnFilter.fixedCount};u.prototype.isColumnAfterViewport=function(n){return n>this.getLastVisibleColumn()};u.prototype.isRowInViewport=function(n){return!this.isRowBeforeViewport(n)&&!this.isRowAfterViewport(n)};u.prototype.isColumnInViewport=function(n){return!this.isColumnBeforeViewport(n)&&!this.isColumnAfterViewport(n)};u.prototype.isLastRowFullyVisible=function(){return this.getLastVisibleRow()===this.instance.getSetting("totalRows")-1&&!this.rowStrategy.isLastIncomplete()};u.prototype.isLastColumnFullyVisible=function(){return this.getLastVisibleColumn()===this.instance.getSetting("totalColumns")-1&&!this.columnStrategy.isLastIncomplete()};v.prototype.getWorkspaceHeight=function(n){if(this.instance.getSetting("nativeScrollbars"))return this.instance.wtScrollbars.vertical.windowSize;var t=this.instance.getSetting("height");return(t===Infinity||t===void 0||t===null||t<1)&&(t=this.instance.wtScrollbars.vertical instanceof e?this.instance.wtScrollbars.vertical.availableSize():Infinity),t!==Infinity&&(n>=t?t-=this.instance.getSetting("scrollbarHeight"):this.instance.wtScrollbars.horizontal.visible&&(t-=this.instance.getSetting("scrollbarHeight"))),t};v.prototype.getWorkspaceWidth=function(n){var t=this.instance.getSetting("width");return(t===Infinity||t===void 0||t===null||t<1)&&(t=this.instance.wtScrollbars.horizontal instanceof e?this.instance.wtScrollbars.horizontal.availableSize():Infinity),t!==Infinity&&(n>=t?t-=this.instance.getSetting("scrollbarWidth"):this.instance.wtScrollbars.vertical.visible&&(t-=this.instance.getSetting("scrollbarWidth"))),t};v.prototype.getWorkspaceActualHeight=function(){return this.instance.wtDom.outerHeight(this.instance.wtTable.TABLE)};v.prototype.getWorkspaceActualWidth=function(){return this.instance.wtDom.outerWidth(this.instance.wtTable.TABLE)||this.instance.wtDom.outerWidth(this.instance.wtTable.TBODY)||this.instance.wtDom.outerWidth(this.instance.wtTable.THEAD)};v.prototype.getColumnHeaderHeight=function(){if(isNaN(this.columnHeaderHeight)){var n=this.instance.wtDom.offset(this.instance.wtTable.TBODY),t=this.instance.wtTable.tableOffset;this.columnHeaderHeight=n.top-t.top}return this.columnHeaderHeight};v.prototype.getViewportHeight=function(n){var t=this.getWorkspaceHeight(n),i;return t===Infinity?t:(i=this.getColumnHeaderHeight(),i>0?t-i:t)};v.prototype.getRowHeaderWidth=function(){var t,n,i,r;if(this.instance.cloneSource)return this.instance.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth))if(t=this.instance.getSetting("rowHeaders"),t.length)for(n=this.instance.wtTable.TABLE.querySelector("TH"),this.rowHeaderWidth=0,i=0,r=t.length;i<r;i++)n?(this.rowHeaderWidth+=this.instance.wtDom.outerWidth(n),n=n.nextSibling):this.rowHeaderWidth+=50;else this.rowHeaderWidth=0;return this.rowHeaderWidth};v.prototype.getViewportWidth=function(n){var t=this.getWorkspaceWidth(n),i;return t===Infinity?t:(i=this.getRowHeaderWidth(),i>0?t-i:t)};v.prototype.resetSettings=function(){this.rowHeaderWidth=NaN;this.columnHeaderHeight=NaN};a={x:0,y:0,init:function(){this.setEvent("mouse");this.setEvent("touch")},setEvent:function(n){var t=document["on"+n+"move"]||function(){};document["on"+n+"move"]=function(n){t(n);a.refresh(n)}},refresh:function(n){n||(n=t.event);n.type=="mousemove"?this.set(n):n.touches&&this.set(n.touches[0])},set:function(n){n.pageX||n.pageY?(this.x=n.pageX,this.y=n.pageY):document.body&&(n.clientX||n.clientY)&&(this.x=n.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,this.y=n.clientY+document.body.scrollTop+document.documentElement.scrollTop)}};a.init();rt={get:function(n){var t=0,i=0;if(n.offsetParent)do i+=n.offsetLeft,t+=n.offsetTop;while(n=n.offsetParent);return[i,t]}};ni=function(n,t){if(typeof n=="string"&&(n=document.getElementById(n)),n){var i=n.getElementsByTagName("div")[0];i&&i.className.search(/(^|\s)handle(\s|$)/)!=-1&&(this.init(n,i,t||{}),this.setup())}};ni.prototype={init:function(n,t,i){this.wrapper=n;this.handle=t;this.options=i;this.disabled=this.getOption("disabled",!1);this.horizontal=this.getOption("horizontal",!0);this.vertical=this.getOption("vertical",!1);this.slide=this.getOption("slide",!0);this.steps=this.getOption("steps",0);this.snap=this.getOption("snap",!1);this.loose=this.getOption("loose",!1);this.speed=this.getOption("speed",10)/100;this.xPrecision=this.getOption("xPrecision",0);this.yPrecision=this.getOption("yPrecision",0);this.callback=i.callback||null;this.animationCallback=i.animationCallback||null;this.bounds={left:i.left||0,right:-(i.right||0),top:i.top||0,bottom:-(i.bottom||0),x0:0,x1:0,xRange:0,y0:0,y1:0,yRange:0};this.value={prev:[-1,-1],current:[i.x||0,i.y||0],target:[i.x||0,i.y||0]};this.offset={wrapper:[0,0],mouse:[0,0],prev:[-999999,-999999],current:[0,0],target:[0,0]};this.change=[0,0];this.activity=!1;this.dragging=!1;this.tapping=!1},getOption:function(n,t){return this.options[n]!==undefined?this.options[n]:t},setup:function(){this.setWrapperOffset();this.setBoundsPadding();this.setBounds();this.setSteps();this.addListeners()},setWrapperOffset:function(){this.offset.wrapper=rt.get(this.wrapper)},setBoundsPadding:function(){this.bounds.left||this.bounds.right||(this.bounds.left=rt.get(this.handle)[0]-this.offset.wrapper[0],this.bounds.right=-this.bounds.left);this.bounds.top||this.bounds.bottom||(this.bounds.top=rt.get(this.handle)[1]-this.offset.wrapper[1],this.bounds.bottom=-this.bounds.top)},setBounds:function(){this.bounds.x0=this.bounds.left;this.bounds.x1=this.wrapper.offsetWidth+this.bounds.right;this.bounds.xRange=this.bounds.x1-this.bounds.x0-this.handle.offsetWidth;this.bounds.y0=this.bounds.top;this.bounds.y1=this.wrapper.offsetHeight+this.bounds.bottom;this.bounds.yRange=this.bounds.y1-this.bounds.y0-this.handle.offsetHeight;this.bounds.xStep=1/(this.xPrecision||Math.max(this.wrapper.offsetWidth,this.handle.offsetWidth));this.bounds.yStep=1/(this.yPrecision||Math.max(this.wrapper.offsetHeight,this.handle.offsetHeight))},setSteps:function(){if(this.steps>1){this.stepRatios=[];for(var n=0;n<=this.steps-1;n++)this.stepRatios[n]=n/(this.steps-1)}},addListeners:function(){var n=this,i,r,u;this.wrapper.onselectstart=function(){return!1};this.handle.onmousedown=this.handle.ontouchstart=function(t){n.handleDownHandler(t)};this.wrapper.onmousedown=this.wrapper.ontouchstart=function(t){n.wrapperDownHandler(t)};i=document.onmouseup||function(){};document.onmouseup=function(t){i(t);n.documentUpHandler(t)};r=document.ontouchend||function(){};document.ontouchend=function(t){r(t);n.documentUpHandler(t)};u=t.onresize||function(){};t.onresize=function(t){u(t);n.documentResizeHandler(t)};this.wrapper.onmousemove=function(){n.activity=!0};this.wrapper.onclick=function(){return!n.activity};this.interval=setInterval(function(){n.animate()},25);n.animate(!1,!0)},handleDownHandler:function(n){this.activity=!1;a.refresh(n);this.preventDefaults(n,!0);this.startDrag()},wrapperDownHandler:function(n){a.refresh(n);this.preventDefaults(n,!0);this.startTap()},documentUpHandler:function(){this.stopDrag();this.stopTap()},documentResizeHandler:function(){this.setWrapperOffset();this.setBounds();this.update()},enable:function(){this.disabled=!1;this.handle.className=this.handle.className.replace(/\s?disabled/g,"")},disable:function(){this.disabled=!0;this.handle.className+=" disabled"},setStep:function(n,t,i){this.setValue(this.steps&&n>1?(n-1)/(this.steps-1):0,this.steps&&t>1?(t-1)/(this.steps-1):0,i)},setValue:function(n,t,i){this.setTargetValue([n,t||0]);i&&this.groupCopy(this.value.current,this.value.target)},startTap:function(n){this.disabled||(this.tapping=!0,this.setWrapperOffset(),this.setBounds(),n===undefined&&(n=[a.x-this.offset.wrapper[0]-this.handle.offsetWidth/2,a.y-this.offset.wrapper[1]-this.handle.offsetHeight/2]),this.setTargetOffset(n))},stopTap:function(){!this.disabled&&this.tapping&&(this.tapping=!1,this.setTargetValue(this.value.current),this.result())},startDrag:function(){this.disabled||(this.setWrapperOffset(),this.setBounds(),this.offset.mouse=[a.x-rt.get(this.handle)[0],a.y-rt.get(this.handle)[1]],this.dragging=!0)},stopDrag:function(){var n,t;!this.disabled&&this.dragging&&(this.dragging=!1,n=this.groupClone(this.value.current),this.slide&&(t=this.change,n[0]+=t[0]*4,n[1]+=t[1]*4),this.setTargetValue(n),this.result())},feedback:function(){var n=this.value.current;this.snap&&this.steps>1&&(n=this.getClosestSteps(n));this.groupCompare(n,this.value.prev)||(typeof this.animationCallback=="function"&&this.animationCallback(n[0],n[1]),this.groupCopy(this.value.prev,n))},result:function(){typeof this.callback=="function"&&this.callback(this.value.target[0],this.value.target[1])},animate:function(n,t){if(!n||this.dragging){if(this.dragging){var i=this.groupClone(this.value.target),r=[a.x-this.offset.wrapper[0]-this.offset.mouse[0],a.y-this.offset.wrapper[1]-this.offset.mouse[1]];this.setTargetOffset(r,this.loose);this.change=[this.value.target[0]-i[0],this.value.target[1]-i[1]]}(this.dragging||t)&&this.groupCopy(this.value.current,this.value.target);(this.dragging||this.glide()||t)&&(this.update(),this.feedback())}},glide:function(){var n=[this.value.target[0]-this.value.current[0],this.value.target[1]-this.value.current[1]];return!n[0]&&!n[1]?!1:(Math.abs(n[0])>this.bounds.xStep||Math.abs(n[1])>this.bounds.yStep?(this.value.current[0]+=n[0]*this.speed,this.value.current[1]+=n[1]*this.speed):this.groupCopy(this.value.current,this.value.target),!0)},update:function(){this.offset.current=this.snap?this.getOffsetsByRatios(this.getClosestSteps(this.value.current)):this.getOffsetsByRatios(this.value.current);this.show()},show:function(){this.groupCompare(this.offset.current,this.offset.prev)||(this.horizontal&&(this.handle.style.left=String(this.offset.current[0])+"px"),this.vertical&&(this.handle.style.top=String(this.offset.current[1])+"px"),this.groupCopy(this.offset.prev,this.offset.current))},setTargetValue:function(n,t){var i=t?this.getLooseValue(n):this.getProperValue(n);this.groupCopy(this.value.target,i);this.offset.target=this.getOffsetsByRatios(i)},setTargetOffset:function(n,t){var i=this.getRatiosByOffsets(n),r=t?this.getLooseValue(i):this.getProperValue(i);this.groupCopy(this.value.target,r);this.offset.target=this.getOffsetsByRatios(r)},getLooseValue:function(n){var t=this.getProperValue(n);return[t[0]+(n[0]-t[0])/4,t[1]+(n[1]-t[1])/4]},getProperValue:function(n){var t=this.groupClone(n);return t[0]=Math.max(t[0],0),t[1]=Math.max(t[1],0),t[0]=Math.min(t[0],1),t[1]=Math.min(t[1],1),(this.dragging||this.tapping)&&!this.snap||this.steps>1&&(t=this.getClosestSteps(t)),t},getRatiosByOffsets:function(n){return[this.getRatioByOffset(n[0],this.bounds.xRange,this.bounds.x0),this.getRatioByOffset(n[1],this.bounds.yRange,this.bounds.y0)]},getRatioByOffset:function(n,t,i){return t?(n-i)/t:0},getOffsetsByRatios:function(n){return[this.getOffsetByRatio(n[0],this.bounds.xRange,this.bounds.x0),this.getOffsetByRatio(n[1],this.bounds.yRange,this.bounds.y0)]},getOffsetByRatio:function(n,t,i){return Math.round(n*t)+i},getClosestSteps:function(n){return[this.getClosestStep(n[0]),this.getClosestStep(n[1])]},getClosestStep:function(n){for(var i=0,r=1,t=0;t<=this.steps-1;t++)Math.abs(this.stepRatios[t]-n)<r&&(r=Math.abs(this.stepRatios[t]-n),i=t);return this.stepRatios[i]},groupCompare:function(n,t){return n[0]==t[0]&&n[1]==t[1]},groupCopy:function(n,t){n[0]=t[0];n[1]=t[1]},groupClone:function(n){return[n[0],n[1]]},preventDefaults:function(n,i){n||(n=t.event);n.preventDefault&&n.preventDefault();n.returnValue=!1;i&&document.selection&&document.selection.empty()},cancelEvent:function(n){n||(n=t.event);n.stopPropagation&&n.stopPropagation();n.cancelBubble=!0}};
/*! Copyright (c) 2013 Brandon Aaron (http://brandonaaron.net)
     * Licensed under the MIT License (LICENSE.txt).
     *
     * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
     * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
     * Thanks to: Seamus Leahy for adding deltaX and deltaY
     *
     * Version: 3.1.3
     *
     * Requires: 1.2.2+
     */
(function(n){typeof define=="function"&&define.amd?define(["jquery"],n):typeof exports=="object"?module.exports=n:n(jQuery)})(function(n){function e(r){var f=r||t.event,a=[].slice.call(arguments,1),e=0,o=0,s=0,c=0,l=0,h;return r=n.event.fix(f),r.type="mousewheel",f.wheelDelta&&(e=f.wheelDelta),f.detail&&(e=f.detail*-1),f.deltaY&&(s=f.deltaY*-1,e=s),f.deltaX&&(o=f.deltaX,e=o*-1),f.wheelDeltaY!==undefined&&(s=f.wheelDeltaY),f.wheelDeltaX!==undefined&&(o=f.wheelDeltaX*-1),c=Math.abs(e),(!u||c<u)&&(u=c),l=Math.max(Math.abs(s),Math.abs(o)),(!i||l<i)&&(i=l),h=e>0?"floor":"ceil",e=Math[h](e/u),o=Math[h](o/i),s=Math[h](s/i),a.unshift(r,e,o,s),(n.event.dispatch||n.event.handle).apply(this,a)}var o=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],r="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],u,i,f;if(n.event.fixHooks)for(f=o.length;f;)n.event.fixHooks[o[--f]]=n.event.mouseHooks;n.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var n=r.length;n;)this.addEventListener(r[--n],e,!1);else this.onmousewheel=e},teardown:function(){if(this.removeEventListener)for(var n=r.length;n;)this.removeEventListener(r[--n],e,!1);else this.onmousewheel=null}};n.fn.extend({mousewheel:function(n){return n?this.bind("mousewheel",n):this.trigger("mousewheel")},unmousewheel:function(n){return this.unbind("mousewheel",n)}})})})(jQuery,window,Handsontable),function(){function u(n){this._n=n}function f(n,t,i){var u=Math.pow(10,t),r,f;return r=(Math.round(n*u)/u).toFixed(t),i&&(f=new RegExp("0{1,"+i+"}$"),r=r.replace(f,"")),r}function e(n,t){return t.indexOf("$")>-1?h(n,t):t.indexOf("%")>-1?c(n,t):t.indexOf(":")>-1?l(n,t):v(n,t)}function s(i,u){var f,o;if(u.indexOf(":")>-1)i._n=a(u);else if(u===r)i._n=0;else{f=u;n[t].delimiters.decimal!=="."&&(u=u.replace(/\./g,"").replace(n[t].delimiters.decimal,"."));var h=new RegExp(n[t].abbreviations.thousand+"(?:\\)|(\\"+n[t].currency.symbol+")?(?:\\))?)?$"),c=new RegExp(n[t].abbreviations.million+"(?:\\)|(\\"+n[t].currency.symbol+")?(?:\\))?)?$"),l=new RegExp(n[t].abbreviations.billion+"(?:\\)|(\\"+n[t].currency.symbol+")?(?:\\))?)?$"),v=new RegExp(n[t].abbreviations.trillion+"(?:\\)|(\\"+n[t].currency.symbol+")?(?:\\))?)?$"),s=["KB","MB","GB","TB","PB","EB","ZB","YB"],e=!1;for(o=0;o<=s.length;o++)if(e=u.indexOf(s[o])>-1?Math.pow(1024,o+1):!1,e)break;i._n=(e?e:1)*(f.match(h)?Math.pow(10,3):1)*(f.match(c)?Math.pow(10,6):1)*(f.match(l)?Math.pow(10,9):1)*(f.match(v)?Math.pow(10,12):1)*(u.indexOf("%")>-1?.01:1)*Number((u.indexOf("(")>-1?"-":"")+u.replace(/[^0-9\.-]+/g,""));i._n=e?Math.ceil(i._n):i._n}return i._n}function h(i,r){var o=r.indexOf("$")<=1?!0:!1,f="",u;return r.indexOf(" $")>-1?(f=" ",r=r.replace(" $","")):r.indexOf("$ ")>-1?(f=" ",r=r.replace("$ ","")):r=r.replace("$",""),u=e(i,r),o?u.indexOf("(")>-1||u.indexOf("-")>-1?(u=u.split(""),u.splice(1,0,n[t].currency.symbol+f),u=u.join("")):u=n[t].currency.symbol+f+u:u.indexOf(")")>-1?(u=u.split(""),u.splice(-1,0,f+n[t].currency.symbol),u=u.join("")):u=u+f+n[t].currency.symbol,u}function c(n,t){var r="",i;return t.indexOf(" %")>-1?(r=" ",t=t.replace(" %","")):t=t.replace("%",""),n._n=n._n*100,i=e(n,t),i.indexOf(")")>-1?(i=i.split(""),i.splice(-1,0,r+"%"),i=i.join("")):i=i+r+"%",i}function l(n){var i=Math.floor(n._n/3600),t=Math.floor((n._n-i*3600)/60),r=Math.round(n._n-i*3600-t*60);return i+":"+(t<10?"0"+t:t)+":"+(r<10?"0"+r:r)}function a(n){var i=n.split(":"),t=0;return i.length===3?(t=t+Number(i[0])*3600,t=t+Number(i[1])*60,t=t+Number(i[2])):i.lenght===2&&(t=t+Number(i[0])*60,t=t+Number(i[1])),Number(t)}function v(i,u){var y=!1,k=!1,e="",a="",v="",c=Math.abs(i._n),b,p,d,l;if(i._n===0&&r!==null)return r;if(u.indexOf("(")>-1&&(y=!0,u=u.slice(1,-1)),u.indexOf("a")>-1&&(u.indexOf(" a")>-1?(e=" ",u=u.replace(" a","")):u=u.replace("a",""),c>=Math.pow(10,12)?(e=e+n[t].abbreviations.trillion,i._n=i._n/Math.pow(10,12)):c<Math.pow(10,12)&&c>=Math.pow(10,9)?(e=e+n[t].abbreviations.billion,i._n=i._n/Math.pow(10,9)):c<Math.pow(10,9)&&c>=Math.pow(10,6)?(e=e+n[t].abbreviations.million,i._n=i._n/Math.pow(10,6)):c<Math.pow(10,6)&&c>=Math.pow(10,3)&&(e=e+n[t].abbreviations.thousand,i._n=i._n/Math.pow(10,3))),u.indexOf("b")>-1)for(u.indexOf(" b")>-1?(a=" ",u=u.replace(" b","")):u=u.replace("b",""),b=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],l=0;l<=b.length;l++)if(p=Math.pow(1024,l),d=Math.pow(1024,l+1),i._n>=p&&i._n<d){a=a+b[l];p>0&&(i._n=i._n/p);break}u.indexOf("o")>-1&&(u.indexOf(" o")>-1?(v=" ",u=u.replace(" o","")):u=u.replace("o",""),v=v+n[t].ordinal(i._n));u.indexOf("[.]")>-1&&(k=!0,u=u.replace("[.]","."));var s=i._n.toString().split(".")[0],o=u.split(".")[1],g=u.indexOf(","),h="",w=!1;return o?(o.indexOf("[")>-1?(o=o.replace("]",""),o=o.split("["),h=f(i._n,o[0].length+o[1].length,o[1].length)):h=f(i._n,o.length),s=h.split(".")[0],h=h.split(".")[1].length?n[t].delimiters.decimal+h.split(".")[1]:"",k&&Number(h)===0&&(h="")):s=f(i._n,null),s.indexOf("-")>-1&&(s=s.slice(1),w=!0),g>-1&&(s=s.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+n[t].delimiters.thousands)),u.indexOf(".")===0&&(s=""),(y&&w?"(":"")+(!y&&w?"-":"")+s+h+(v?v:"")+(e?e:"")+(a?a:"")+(y&&w?")":"")}function y(t,i){n[t]=i}var i,n={},t="en",r=null,o=typeof module!="undefined"&&module.exports;i=function(n){return i.isNumeral(n)?n=n.value():Number(n)||(n=0),new u(Number(n))};i.version="1.4.7";i.isNumeral=function(n){return n instanceof u};i.language=function(r,u){return r?(r&&!u&&(t=r),(u||!n[r])&&y(r,u),i):t};i.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(n){var t=n%10;return~~(n%100/10)==1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th"},currency:{symbol:"$"}});i.zeroFormat=function(n){r=typeof n=="string"?n:null};i.fn=u.prototype={clone:function(){return i(this)},format:function(n){return e(this,n?n:i.defaultFormat)},unformat:function(n){return s(this,n?n:i.defaultFormat)},value:function(){return this._n},valueOf:function(){return this._n},set:function(n){return this._n=Number(n),this},add:function(n){return this._n=this._n+Number(n),this},subtract:function(n){return this._n=this._n-Number(n),this},multiply:function(n){return this._n=this._n*Number(n),this},divide:function(n){return this._n=this._n/Number(n),this},difference:function(n){var t=this._n-Number(n);return t<0&&(t=-t),t}};o&&(module.exports=i);typeof ender=="undefined"&&(this.numeral=i);typeof define=="function"&&define.amd&&define([],function(){return i})}.call(this);
//# sourceMappingURL=handsontable.full.min.js.map
